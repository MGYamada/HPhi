<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>HΦ: include/makeHam.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('make_ham_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">makeHam.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_common_8h_source.html">Common.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for makeHam.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="make_ham_8h__incl.png" border="0" usemap="#include_2make_ham_8h" alt=""/></div>
<map name="include_2make_ham_8h" id="include_2make_ham_8h">
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="make_ham_8h__dep__incl.png" border="0" usemap="#include_2make_ham_8hdep" alt=""/></div>
<map name="include_2make_ham_8hdep" id="include_2make_ham_8hdep">
</map>
</div>
</div>
<p><a href="make_ham_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a460d5b90ee970a19d8b66c2b30c8cb0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="make_ham_8h.html#a460d5b90ee970a19d8b66c2b30c8cb0b">makeHam</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="separator:a460d5b90ee970a19d8b66c2b30c8cb0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a460d5b90ee970a19d8b66c2b30c8cb0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int makeHam </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>

<p>Definition at line <a class="el" href="make_ham_8c_source.html#l00030">30</a> of file <a class="el" href="make_ham_8c_source.html">makeHam.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                 {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght,ilft,ihfbit;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> isite1,isite2,isite3,isite4;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">int</span> sigma1,sigma2,sigma3,sigma4;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> isA_up, isB_up;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span> complex tmp_trans,tmp_V;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,Bsum,Adiff,Bdiff;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off,tmp_off_2;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  off=0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  tmp_off=0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  tmp_off_2=0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_max;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a78387adc1f4e171d3796235adfcbd87e">GetSplitBitByModel</a>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">Nsite</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">iCalcModel</a>, &amp;irght, &amp;ilft, &amp;ihfbit)!=0){</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>    = i_max;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>    = irght;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>     = ilft;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>   = ihfbit;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">prdct</a>=0.0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>=<a class="code" href="mltply_8h.html#a5c8dd0d097bacc500eddcc7970047d3f">M_Ham</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;=i_max;i++){</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span>(j=0;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[i][j]=0;  </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">  #pragma omp parallel for default(none) firstprivate(i_max) private(j) shared(Ham, list_Diagonal,v0,v1)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){  </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[j][j]+=<a class="code" href="global_8h.html#ac14b3c4e0a92adbe3322b8546a9af48b">list_Diagonal</a>[j];  </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>[j]     = 1.0;      </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>[j]     = 1.0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">switch</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">iCalcModel</a>){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a5e2c64674c783f9e961ac5f05f653e2a">HubbardGC</a>:</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//Transfer</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ab7cc31a29378e87e6b0d12b37e4c78a9">EDNTransfer</a>; i++){</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      isite1     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0]+1;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      isite2     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2]+1;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      sigma1     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][1];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      sigma2     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][3];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="mltply_8h.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a>(X,isite1,isite2,sigma1,sigma2)!=0){</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      tmp_trans      = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">EDParaGeneralTransfer</a>[i];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    dmv=tmp_trans*<a class="code" href="mltply_8h.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>,X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>, tmp_trans, &amp;tmp_off);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j]  += dmv;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">//InterAll</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a5dba4f4758aab71c22f77d7800230624">NInterAll_OffDiagonal</a>; i++){    </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][0]+1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][2]+1;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][4]+1;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][6]+1;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][1];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][3];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][5];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][7];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      tmp_V  = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[i];    </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="mltply_8h.html#ad8750d6b426c68d0e931849d094b11ce">child_general_int_GetInfo</a>(</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       i, </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       X,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;       isite1,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       isite2,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       isite3,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;       isite4,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;       sigma1,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;       sigma2,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       sigma3,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       sigma4,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       tmp_V</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      );</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      i_max  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      Asum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      Adiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      Bsum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      Bdiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      tmp_V  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac4c27b0a6605ddec02a985904f2b1639">tmp_V</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      dmv =<a class="code" href="mltply_8h.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);  </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[j][j]   += dmv;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      dmv = <a class="code" href="mltply_8h.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j] += dmv;  </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      dmv = <a class="code" href="mltply_8h.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j] += dmv;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      dmv = <a class="code" href="mltply_8h.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a>(j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off_2);   </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off_2+1][j] += dmv;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    } </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">//Pair hopping</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a67c551a2089d10aec680afbd58fc708f">NPairHopping</a>; i++){</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="mltply_8h.html#ada83696e48d6a9496eca54980a2fd2a4">child_pairhopp_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    dmv            = <a class="code" href="mltply_8h.html#a47af1fdf91258fccc366f8e96f600bfb">GC_child_pairhopp_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j] += dmv;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//Exchange</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a69b11c597654eef65720291daffbbd4b">NExchangeCoupling</a>; i++){</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="mltply_8h.html#ace0e2c1c928c924f7efd3bf106c9122e">child_exchange_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    dmv            = <a class="code" href="mltply_8h.html#a17e4b4cfa71b3d34cdc969cb22b79ba9">GC_child_exchange_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j] += dmv;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }    </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a84a2a0896f6c0300a068925d7b299515">KondoGC</a>:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a1518a9996ad08009b6ea9a6de5198b65">Hubbard</a>:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a531ba444bc15b6711c05fd95874f205d">Kondo</a>:</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;transfer\n&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//Transfer</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ab7cc31a29378e87e6b0d12b37e4c78a9">EDNTransfer</a>; i++){</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      isite1     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0]+1;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      isite2     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2]+1;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      sigma1     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][1];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      sigma2     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][3];</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="mltply_8h.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a>( X,isite1,isite2,sigma1,sigma2)!=0){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      tmp_trans      = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">EDParaGeneralTransfer</a>[i];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    dmv               = tmp_trans*<a class="code" href="mltply_8h.html#a7a06ee438e6410e395f2d2142529bb34">X_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X,X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>,X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>,X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>,X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>,&amp;iexchg, &amp;tmp_off);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j]  += dmv;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;interall:%d\n&quot;</span>,X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a5dba4f4758aab71c22f77d7800230624">NInterAll_OffDiagonal</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//InterAll</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a5dba4f4758aab71c22f77d7800230624">NInterAll_OffDiagonal</a>; i++){    </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][0]+1;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][2]+1;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][4]+1;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][6]+1;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][1];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][3];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][5];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][7];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      tmp_V  = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[i];    </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="mltply_8h.html#ad8750d6b426c68d0e931849d094b11ce">child_general_int_GetInfo</a>(</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;       i, </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;       X,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;       isite1,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       isite2,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;       isite3,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;       isite4,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;       sigma1,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;       sigma2,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;       sigma3,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;       sigma4,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;       tmp_V</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      i_max  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      Asum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      Adiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      Bsum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      Bdiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      tmp_V  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac4c27b0a6605ddec02a985904f2b1639">tmp_V</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      dmv = <a class="code" href="mltply_8h.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[j][j]   += dmv;  </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      dmv =<a class="code" href="mltply_8h.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j] += dmv; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }  </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      dmv=<a class="code" href="mltply_8h.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j] += dmv; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      dmv=<a class="code" href="mltply_8h.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a>(j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off_2);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off_2][j] += dmv;  </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    } </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;pairhopp\n&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">//Pair hopping</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a67c551a2089d10aec680afbd58fc708f">NPairHopping</a>; i++){</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="mltply_8h.html#ada83696e48d6a9496eca54980a2fd2a4">child_pairhopp_GetInfo</a>(i, X);        </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    dmv          = <a class="code" href="mltply_8h.html#a72af6200bdc7e6474def42f634cfff65">child_pairhopp_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j] += dmv;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;exchange\n&quot;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">//Exchange</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a69b11c597654eef65720291daffbbd4b">NExchangeCoupling</a>; i++){</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="mltply_8h.html#ace0e2c1c928c924f7efd3bf106c9122e">child_exchange_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    dmv          = <a class="code" href="mltply_8h.html#a54c462e324115ab5c298e497fa8fba74">child_exchange_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j] += dmv;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#aa7314d1157770374b63f2a07076e1cdb">SpinGC</a>:</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//Transfer</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ab7cc31a29378e87e6b0d12b37e4c78a9">EDNTransfer</a>;i++){</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      isite1     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][0]+1;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      isite2     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][2]+1;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      sigma1     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][1];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      sigma2     = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">EDGeneralTransfer</a>[i][3];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="mltply_8h.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a>( X,isite1,isite2,sigma1,sigma2)!=0){</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      tmp_trans  = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">EDParaGeneralTransfer</a>[i];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">if</span>(isite1 == isite2){ </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        is1_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[isite1-1];</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span>(sigma1==sigma2){  </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          <span class="comment">// longitudinal magnetic field</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[j][j]+=tmp_trans*<a class="code" href="mltply_8h.html#a93558eb8cb0c4df2ce01e0611b771f66">X_Spin_CisAis</a>(j,X,is1_spin, sigma1); </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      } </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          <span class="comment">// transverse magnetic field</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          is1_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[isite1-1];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[off+1][j] +=  <a class="code" href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a>(j,X, is1_spin, sigma2, &amp;off); </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      } </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// hopping is not allowed in localized spin system</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; <span class="comment">//InterAll</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a5dba4f4758aab71c22f77d7800230624">NInterAll_OffDiagonal</a>; i++){    </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][0]+1;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][4]+1;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][1];</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][3];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][5];</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][7];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      tmp_V  = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[i];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="mltply_8h.html#a4f2cb8d2efe39da7c0b1b6d975758c40">child_general_int_spin_GetInfo</a>( X, isite1, isite2, sigma1, sigma2, sigma3, sigma4, tmp_V);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[isite1-1];</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[isite2-1];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">if</span>(sigma1==sigma2 &amp;&amp; sigma3==sigma4 ){ <span class="comment">//diagonal </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      dmv =<a class="code" href="mltply_8h.html#aa25730bebedaef0567be1d1d3a2aa9f7">GC_child_CisAisCisAis_spin_element</a>(j, isA_up, isB_up, sigma2, sigma4, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[j][j]      += dmv;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">else</span>  <span class="keywordflow">if</span>(sigma1 == sigma2 &amp;&amp; sigma3 != sigma4){   </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      dmv = <a class="code" href="mltply_8h.html#af675fc77ae3b652589d52ff3fa667b77">GC_child_CisAisCitAiu_spin_element</a>(j, sigma2, sigma4, isA_up, isB_up, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j]    += dmv;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(sigma1 != sigma2 &amp;&amp; sigma3 == sigma4){ </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      dmv = <a class="code" href="mltply_8h.html#a220085102d48735b8111fe704e5d5993">GC_child_CisAitCiuAiu_spin_element</a>(j, sigma2, sigma4, isA_up, isB_up, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j]    += dmv;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    } </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(sigma1 != sigma2 &amp;&amp; sigma3 != sigma4){ </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      dmv = <a class="code" href="mltply_8h.html#a1b6c6239f632e04606cf340f024d2ed3">GC_child_CisAitCiuAiv_spin_element</a>(j, sigma2, sigma4, isA_up, isB_up, tmp_V, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X, &amp;tmp_off_2);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off_2+1][j]    += dmv;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      } </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//Exchange</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a69b11c597654eef65720291daffbbd4b">NExchangeCoupling</a>; i++){</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="mltply_8h.html#a70512a3c407e79dd6c912a63f9afe4ae">child_exchange_spin_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    dmv =<a class="code" href="mltply_8h.html#a3a389097c7f00b48f89ad12bff352a61">GC_child_exchange_spin_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j] +=dmv;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">//PairLift</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8f3cd1249eca9bfca289d96a4fce40a4">NPairLiftCoupling</a>; i++){</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="mltply_8h.html#a2ccdc49853b6d944a5274784015ff774">child_pairlift_spin_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    dmv =<a class="code" href="mltply_8h.html#a1eb1279a95e116ee2de32bbdd6b23efb">child_pairlift_spin_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off+1][j] +=dmv;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#ad2bf5a74a6b8ccd9b93ff923d904d3e6">Spin</a>:</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">//Transfer is abosrbed in diagonal term.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">//InterAll</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a5dba4f4758aab71c22f77d7800230624">NInterAll_OffDiagonal</a>; i++){    </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][0]+1;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][4]+1;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      sigma1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][1];</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      sigma2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][3];</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      sigma3 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][5];</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      sigma4 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">InterAll_OffDiagonal</a>[i][7];</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      tmp_V  = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">ParaInterAll_OffDiagonal</a>[i];</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="mltply_8h.html#a4f2cb8d2efe39da7c0b1b6d975758c40">child_general_int_spin_GetInfo</a>( X, isite1, isite2, sigma1, sigma2, sigma3, sigma4, tmp_V);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    tmp_sgn    =  <a class="code" href="mltply_8h.html#a40a1adaf57adca8173be6dbcf260aabf">X_child_exchange_spin_element</a>(j,X, isA_up, isB_up, sigma2, sigma4,&amp;tmp_off);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    dmv        = tmp_sgn*tmp_V;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j]     += dmv;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">//Exchange</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a69b11c597654eef65720291daffbbd4b">NExchangeCoupling</a>; i++){</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="mltply_8h.html#a70512a3c407e79dd6c912a63f9afe4ae">child_exchange_spin_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    dmv          = <a class="code" href="mltply_8h.html#ac49bf59f1c574be383b76e2e315e902a">child_exchange_spin_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j] += dmv;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//PairLift</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">for</span>(i = 0;i&lt; X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8f3cd1249eca9bfca289d96a4fce40a4">NPairLiftCoupling</a>; i++){</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <a class="code" href="mltply_8h.html#a2ccdc49853b6d944a5274784015ff774">child_pairlift_spin_GetInfo</a>(i, X);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;j++){</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    dmv =<a class="code" href="mltply_8h.html#a1eb1279a95e116ee2de32bbdd6b23efb">child_pairlift_spin_element</a>(j, <a class="code" href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a>, <a class="code" href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a>, X,&amp;tmp_off);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a>[tmp_off][j] +=dmv;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div>
<div class="ttc" id="mltply_8h_html_a985bdb0d96a952fc6c447e12ea2b906a"><div class="ttname"><a href="mltply_8h.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02091">mltply.c:2091</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00210">struct.h:210</a></div></div>
<div class="ttc" id="mltply_8h_html_ad8750d6b426c68d0e931849d094b11ce"><div class="ttname"><a href="mltply_8h.html#ad8750d6b426c68d0e931849d094b11ce">child_general_int_GetInfo</a></div><div class="ttdeci">int child_general_int_GetInfo(const int iInterAll, struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l00913">mltply.c:913</a></div></div>
<div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00173">struct.h:173</a></div></div>
<div class="ttc" id="mltply_8h_html_a8575bdd2f35cf049753b0617d2693edb"><div class="ttname"><a href="mltply_8h.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02143">mltply.c:2143</a></div></div>
<div class="ttc" id="mltply_8h_html_a40a1adaf57adca8173be6dbcf260aabf"><div class="ttname"><a href="mltply_8h.html#a40a1adaf57adca8173be6dbcf260aabf">X_child_exchange_spin_element</a></div><div class="ttdeci">int X_child_exchange_spin_element(const long unsigned int j, struct BindStruct *X, const long unsigned int isA_up, const long unsigned int isB_up, const long unsigned int sigmaA, const long unsigned int sigmaB, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01623">mltply.c:1623</a></div></div>
<div class="ttc" id="struct_large_list_html_a855e8bc4876c7e6da5249d8ae2b46b9c"><div class="ttname"><a href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">LargeList::ihfbit</a></div><div class="ttdeci">long unsigned int ihfbit</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00176">struct.h:176</a></div></div>
<div class="ttc" id="struct_check_list_html_a5d8a1e6a9e9064ae7dab52310d2cce11"><div class="ttname"><a href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">CheckList::idim_max</a></div><div class="ttdeci">unsigned long int idim_max</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00141">struct.h:141</a></div></div>
<div class="ttc" id="mltply_8h_html_a2ccdc49853b6d944a5274784015ff774"><div class="ttname"><a href="mltply_8h.html#a2ccdc49853b6d944a5274784015ff774">child_pairlift_spin_GetInfo</a></div><div class="ttdeci">int child_pairlift_spin_GetInfo(const int iPairLift, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01077">mltply.c:1077</a></div></div>
<div class="ttc" id="struct_define_list_html_a8f3cd1249eca9bfca289d96a4fce40a4"><div class="ttname"><a href="struct_define_list.html#a8f3cd1249eca9bfca289d96a4fce40a4">DefineList::NPairLiftCoupling</a></div><div class="ttdeci">int NPairLiftCoupling</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00110">struct.h:110</a></div></div>
<div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00157">struct.h:157</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00166">struct.h:166</a></div></div>
<div class="ttc" id="mltply_8h_html_a11e78b661246513350ad6ee2e3985d9f"><div class="ttname"><a href="mltply_8h.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02047">mltply.c:2047</a></div></div>
<div class="ttc" id="struct_define_list_html_a8a54486217df163bb7d30f0134ef0474"><div class="ttname"><a href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">DefineList::Nsite</a></div><div class="ttdeci">int Nsite</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00038">struct.h:38</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00178">struct.h:178</a></div></div>
<div class="ttc" id="mltply_8h_html_aa25730bebedaef0567be1d1d3a2aa9f7"><div class="ttname"><a href="mltply_8h.html#aa25730bebedaef0567be1d1d3a2aa9f7">GC_child_CisAisCisAis_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_spin_element(long unsigned int j, long unsigned int isA_up, long unsigned int isB_up, long unsigned int org_sigma2, long unsigned int org_sigma4, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02354">mltply.c:2354</a></div></div>
<div class="ttc" id="global_8h_html_a9fbff38d5659324379db905b39b7625e"><div class="ttname"><a href="global_8h.html#a9fbff38d5659324379db905b39b7625e">v1</a></div><div class="ttdeci">double complex * v1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="mltply_8h_html_a93558eb8cb0c4df2ce01e0611b771f66"><div class="ttname"><a href="mltply_8h.html#a93558eb8cb0c4df2ce01e0611b771f66">X_Spin_CisAis</a></div><div class="ttdeci">int X_Spin_CisAis(long unsigned int j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int sigma1)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01411">mltply.c:1411</a></div></div>
<div class="ttc" id="mltply_8h_html_a47af1fdf91258fccc366f8e96f600bfb"><div class="ttname"><a href="mltply_8h.html#a47af1fdf91258fccc366f8e96f600bfb">GC_child_pairhopp_element</a></div><div class="ttdeci">double complex GC_child_pairhopp_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01985">mltply.c:1985</a></div></div>
<div class="ttc" id="mltply_8h_html_ad2c9c4176ec4f0f7d5087a890467a264"><div class="ttname"><a href="mltply_8h.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a></div><div class="ttdeci">int child_general_hopp_GetInfo(struct BindStruct *X, unsigned long int isite1, unsigned long int isite2, unsigned long int sigma1, unsigned long int sigma2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l00865">mltply.c:865</a></div></div>
<div class="ttc" id="struct_large_list_html_ac0e932f82f716485a2bb012dc05bc7c1"><div class="ttname"><a href="struct_large_list.html#ac0e932f82f716485a2bb012dc05bc7c1">LargeList::prdct</a></div><div class="ttdeci">double complex prdct</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00148">struct.h:148</a></div></div>
<div class="ttc" id="_def_common_8h_html_a1518a9996ad08009b6ea9a6de5198b65"><div class="ttname"><a href="_def_common_8h.html#a1518a9996ad08009b6ea9a6de5198b65">Hubbard</a></div><div class="ttdeci">#define Hubbard</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00030">DefCommon.h:30</a></div></div>
<div class="ttc" id="mltply_8h_html_a5c8dd0d097bacc500eddcc7970047d3f"><div class="ttname"><a href="mltply_8h.html#a5c8dd0d097bacc500eddcc7970047d3f">M_Ham</a></div><div class="ttdeci">#define M_Ham</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8h_source.html#l00025">mltply.h:25</a></div></div>
<div class="ttc" id="_def_common_8h_html_a531ba444bc15b6711c05fd95874f205d"><div class="ttname"><a href="_def_common_8h.html#a531ba444bc15b6711c05fd95874f205d">Kondo</a></div><div class="ttdeci">#define Kondo</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00032">DefCommon.h:32</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00212">struct.h:212</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00163">struct.h:163</a></div></div>
<div class="ttc" id="struct_define_list_html_ad3139436290b45f996399b9d139c2dd4"><div class="ttname"><a href="struct_define_list.html#ad3139436290b45f996399b9d139c2dd4">DefineList::EDGeneralTransfer</a></div><div class="ttdeci">int ** EDGeneralTransfer</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00075">struct.h:75</a></div></div>
<div class="ttc" id="mltply_8h_html_a17e4b4cfa71b3d34cdc969cb22b79ba9"><div class="ttname"><a href="mltply_8h.html#a17e4b4cfa71b3d34cdc969cb22b79ba9">GC_child_exchange_element</a></div><div class="ttdeci">double complex GC_child_exchange_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01917">mltply.c:1917</a></div></div>
<div class="ttc" id="_def_common_8h_html_ad2bf5a74a6b8ccd9b93ff923d904d3e6"><div class="ttname"><a href="_def_common_8h.html#ad2bf5a74a6b8ccd9b93ff923d904d3e6">Spin</a></div><div class="ttdeci">#define Spin</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00031">DefCommon.h:31</a></div></div>
<div class="ttc" id="mltply_8h_html_a7a06ee438e6410e395f2d2142529bb34"><div class="ttname"><a href="mltply_8h.html#a7a06ee438e6410e395f2d2142529bb34">X_CisAjt</a></div><div class="ttdeci">int X_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *iexchg, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01367">mltply.c:1367</a></div></div>
<div class="ttc" id="struct_define_list_html_a3265979ab4d2cc9c37463ae4642c6358"><div class="ttname"><a href="struct_define_list.html#a3265979ab4d2cc9c37463ae4642c6358">DefineList::ParaInterAll_OffDiagonal</a></div><div class="ttdeci">double complex * ParaInterAll_OffDiagonal</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00123">struct.h:123</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00161">struct.h:161</a></div></div>
<div class="ttc" id="mltply_8h_html_a4f2cb8d2efe39da7c0b1b6d975758c40"><div class="ttname"><a href="mltply_8h.html#a4f2cb8d2efe39da7c0b1b6d975758c40">child_general_int_spin_GetInfo</a></div><div class="ttdeci">int child_general_int_spin_GetInfo(struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01108">mltply.c:1108</a></div></div>
<div class="ttc" id="mltply_8h_html_a220085102d48735b8111fe704e5d5993"><div class="ttname"><a href="mltply_8h.html#a220085102d48735b8111fe704e5d5993">GC_child_CisAitCiuAiu_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAitCiuAiu_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02451">mltply.c:2451</a></div></div>
<div class="ttc" id="mltply_8h_html_a54c462e324115ab5c298e497fa8fba74"><div class="ttname"><a href="mltply_8h.html#a54c462e324115ab5c298e497fa8fba74">child_exchange_element</a></div><div class="ttdeci">double complex child_exchange_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01552">mltply.c:1552</a></div></div>
<div class="ttc" id="mltply_8h_html_a3a389097c7f00b48f89ad12bff352a61"><div class="ttname"><a href="mltply_8h.html#a3a389097c7f00b48f89ad12bff352a61">GC_child_exchange_spin_element</a></div><div class="ttdeci">double complex GC_child_exchange_spin_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01718">mltply.c:1718</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00165">struct.h:165</a></div></div>
<div class="ttc" id="xfreemem__large_8c_html_a5c1bb0da45eec945c4cc3233c7d8427e"><div class="ttname"><a href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a></div><div class="ttdeci">fprintf(stdoutMPI,&quot;LARGE Free FINISH !\n&quot;)</div></div>
<div class="ttc" id="mltply_8h_html_af675fc77ae3b652589d52ff3fa667b77"><div class="ttname"><a href="mltply_8h.html#af675fc77ae3b652589d52ff3fa667b77">GC_child_CisAisCitAiu_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAisCitAiu_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02402">mltply.c:2402</a></div></div>
<div class="ttc" id="struct_define_list_html_acf2546cf5a91658ba830d3c9246ee13f"><div class="ttname"><a href="struct_define_list.html#acf2546cf5a91658ba830d3c9246ee13f">DefineList::InterAll_OffDiagonal</a></div><div class="ttdeci">int ** InterAll_OffDiagonal</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00116">struct.h:116</a></div></div>
<div class="ttc" id="mltply_8h_html_a707ac2de8043df3be28fcf3c81c44362"><div class="ttname"><a href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a></div><div class="ttdeci">int X_SpinGC_CisAit(long unsigned int j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int sigma2, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01509">mltply.c:1509</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00172">struct.h:172</a></div></div>
<div class="ttc" id="struct_define_list_html_ab7cc31a29378e87e6b0d12b37e4c78a9"><div class="ttname"><a href="struct_define_list.html#ab7cc31a29378e87e6b0d12b37e4c78a9">DefineList::EDNTransfer</a></div><div class="ttdeci">int EDNTransfer</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00064">struct.h:64</a></div></div>
<div class="ttc" id="mltply_8h_html_a2e64839292192a5851d4be60a4f3561a"><div class="ttname"><a href="mltply_8h.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02199">mltply.c:2199</a></div></div>
<div class="ttc" id="global_8h_html_aade638705bab07f8514708b0422133f0"><div class="ttname"><a href="global_8h.html#aade638705bab07f8514708b0422133f0">Ham</a></div><div class="ttdeci">double complex ** Ham</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00056">global.h:56</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00155">struct.h:155</a></div></div>
<div class="ttc" id="struct_define_list_html_a7759e4fbd1140e455dfec8fb7d126627"><div class="ttname"><a href="struct_define_list.html#a7759e4fbd1140e455dfec8fb7d126627">DefineList::EDParaGeneralTransfer</a></div><div class="ttdeci">double complex * EDParaGeneralTransfer</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00083">struct.h:83</a></div></div>
<div class="ttc" id="mltply_8h_html_ac49bf59f1c574be383b76e2e315e902a"><div class="ttname"><a href="mltply_8h.html#ac49bf59f1c574be383b76e2e315e902a">child_exchange_spin_element</a></div><div class="ttdeci">double complex child_exchange_spin_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01667">mltply.c:1667</a></div></div>
<div class="ttc" id="mltply_8h_html_a6d06655a28258eea84191579396219e1"><div class="ttname"><a href="mltply_8h.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02703">mltply.c:2703</a></div></div>
<div class="ttc" id="struct_large_list_html_a8e610d200c449d87882eccdc479b8cab"><div class="ttname"><a href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">LargeList::ilft</a></div><div class="ttdeci">long unsigned int ilft</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00175">struct.h:175</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a78387adc1f4e171d3796235adfcbd87e"><div class="ttname"><a href="bitcalc_8c.html#a78387adc1f4e171d3796235adfcbd87e">GetSplitBitByModel</a></div><div class="ttdeci">int GetSplitBitByModel(const int Nsite, const int iCalcModel, long unsigned int *irght, long unsigned int *ilft, long unsigned int *ihfbit)</div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00061">bitcalc.c:61</a></div></div>
<div class="ttc" id="_def_common_8h_html_a5e2c64674c783f9e961ac5f05f653e2a"><div class="ttname"><a href="_def_common_8h.html#a5e2c64674c783f9e961ac5f05f653e2a">HubbardGC</a></div><div class="ttdeci">#define HubbardGC</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00033">DefCommon.h:33</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00151">struct.h:151</a></div></div>
<div class="ttc" id="struct_define_list_html_a69b11c597654eef65720291daffbbd4b"><div class="ttname"><a href="struct_define_list.html#a69b11c597654eef65720291daffbbd4b">DefineList::NExchangeCoupling</a></div><div class="ttdeci">int NExchangeCoupling</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00104">struct.h:104</a></div></div>
<div class="ttc" id="struct_large_list_html_ac4c27b0a6605ddec02a985904f2b1639"><div class="ttname"><a href="struct_large_list.html#ac4c27b0a6605ddec02a985904f2b1639">LargeList::tmp_V</a></div><div class="ttdeci">double tmp_V</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00179">struct.h:179</a></div></div>
<div class="ttc" id="mltply_8h_html_a70512a3c407e79dd6c912a63f9afe4ae"><div class="ttname"><a href="mltply_8h.html#a70512a3c407e79dd6c912a63f9afe4ae">child_exchange_spin_GetInfo</a></div><div class="ttdeci">int child_exchange_spin_GetInfo(const int iExchange, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01052">mltply.c:1052</a></div></div>
<div class="ttc" id="mltply_8h_html_a1b6c6239f632e04606cf340f024d2ed3"><div class="ttname"><a href="mltply_8h.html#a1b6c6239f632e04606cf340f024d2ed3">GC_child_CisAitCiuAiv_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAitCiuAiv_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02500">mltply.c:2500</a></div></div>
<div class="ttc" id="mltply_8h_html_a5a389f0d9543e02b5d2e19df0198bafc"><div class="ttname"><a href="mltply_8h.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex GC_child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02596">mltply.c:2596</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00033">global.h:33</a></div></div>
<div class="ttc" id="struct_define_list_html_a5dba4f4758aab71c22f77d7800230624"><div class="ttname"><a href="struct_define_list.html#a5dba4f4758aab71c22f77d7800230624">DefineList::NInterAll_OffDiagonal</a></div><div class="ttdeci">int NInterAll_OffDiagonal</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00120">struct.h:120</a></div></div>
<div class="ttc" id="mltply_8h_html_a72af6200bdc7e6474def42f634cfff65"><div class="ttname"><a href="mltply_8h.html#a72af6200bdc7e6474def42f634cfff65">child_pairhopp_element</a></div><div class="ttdeci">double complex child_pairhopp_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01861">mltply.c:1861</a></div></div>
<div class="ttc" id="_def_common_8h_html_a84a2a0896f6c0300a068925d7b299515"><div class="ttname"><a href="_def_common_8h.html#a84a2a0896f6c0300a068925d7b299515">KondoGC</a></div><div class="ttdeci">#define KondoGC</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00035">DefCommon.h:35</a></div></div>
<div class="ttc" id="mltply_8h_html_ada83696e48d6a9496eca54980a2fd2a4"><div class="ttname"><a href="mltply_8h.html#ada83696e48d6a9496eca54980a2fd2a4">child_pairhopp_GetInfo</a></div><div class="ttdeci">int child_pairhopp_GetInfo(const int iPairHopp, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l00996">mltply.c:996</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00164">struct.h:164</a></div></div>
<div class="ttc" id="mltply_8h_html_ab7d585bf30bbcee8449b8c54d0bb128e"><div class="ttname"><a href="mltply_8h.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02648">mltply.c:2648</a></div></div>
<div class="ttc" id="struct_define_list_html_a16f8adaa4fca771cb01a28b482224b70"><div class="ttname"><a href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">DefineList::Tpow</a></div><div class="ttdeci">long int * Tpow</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00054">struct.h:54</a></div></div>
<div class="ttc" id="mltply_8h_html_a257628b6ed79f7a93d3d2a9a957bc936"><div class="ttname"><a href="mltply_8h.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a></div><div class="ttdeci">double complex GC_CisAjt(long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01311">mltply.c:1311</a></div></div>
<div class="ttc" id="mltply_8h_html_a6e5c6a3af522a385b4ee60f66efb2557"><div class="ttname"><a href="mltply_8h.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02550">mltply.c:2550</a></div></div>
<div class="ttc" id="mltply_8h_html_ace0e2c1c928c924f7efd3bf106c9122e"><div class="ttname"><a href="mltply_8h.html#ace0e2c1c928c924f7efd3bf106c9122e">child_exchange_GetInfo</a></div><div class="ttdeci">int child_exchange_GetInfo(const int iExchange, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01024">mltply.c:1024</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00177">struct.h:177</a></div></div>
<div class="ttc" id="struct_define_list_html_a67c551a2089d10aec680afbd58fc708f"><div class="ttname"><a href="struct_define_list.html#a67c551a2089d10aec680afbd58fc708f">DefineList::NPairHopping</a></div><div class="ttdeci">int NPairHopping</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00100">struct.h:100</a></div></div>
<div class="ttc" id="mltply_8h_html_a1eb1279a95e116ee2de32bbdd6b23efb"><div class="ttname"><a href="mltply_8h.html#a1eb1279a95e116ee2de32bbdd6b23efb">child_pairlift_spin_element</a></div><div class="ttdeci">double complex child_pairlift_spin_element(const long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01765">mltply.c:1765</a></div></div>
<div class="ttc" id="struct_large_list_html_ae434b7a485083dd5e96f24a24bc3e9b8"><div class="ttname"><a href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">LargeList::irght</a></div><div class="ttdeci">long unsigned int irght</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00174">struct.h:174</a></div></div>
<div class="ttc" id="global_8h_html_ac14b3c4e0a92adbe3322b8546a9af48b"><div class="ttname"><a href="global_8h.html#ac14b3c4e0a92adbe3322b8546a9af48b">list_Diagonal</a></div><div class="ttdeci">double * list_Diagonal</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00031">global.h:31</a></div></div>
<div class="ttc" id="struct_define_list_html_acc55ef9e68605fbaba4697e0e4e90b95"><div class="ttname"><a href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">DefineList::iCalcModel</a></div><div class="ttdeci">int iCalcModel</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00136">struct.h:136</a></div></div>
<div class="ttc" id="global_8h_html_a7f64d09e17650bdbda576fd7235b8600"><div class="ttname"><a href="global_8h.html#a7f64d09e17650bdbda576fd7235b8600">v0</a></div><div class="ttdeci">double complex * v0</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00024">global.h:24</a></div></div>
<div class="ttc" id="_def_common_8h_html_aa7314d1157770374b63f2a07076e1cdb"><div class="ttname"><a href="_def_common_8h.html#aa7314d1157770374b63f2a07076e1cdb">SpinGC</a></div><div class="ttdeci">#define SpinGC</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00034">DefCommon.h:34</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a95fc4908040330c6556954b46972e35f"><div class="ttname"><a href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">BindStruct::Check</a></div><div class="ttdeci">struct CheckList Check</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00211">struct.h:211</a></div></div>
<div class="ttc" id="wrapper_m_p_i_8h_html_abacbc82cf67663cd6f3708f1274ac207"><div class="ttname"><a href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a></div><div class="ttdeci">FILE * stdoutMPI</div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8h_source.html#l00022">wrapperMPI.h:22</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_cgraph.png" border="0" usemap="#make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_cgraph" alt=""/></div>
<map name="make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_cgraph" id="make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_cgraph">
</map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_icgraph.png" border="0" usemap="#make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_icgraph" alt=""/></div>
<map name="make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_icgraph" id="make_ham_8h_a460d5b90ee970a19d8b66c2b30c8cb0b_icgraph">
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="make_ham_8h.html">makeHam.h</a></li>
    <li class="footer">Generated on Fri Oct 30 2015 15:02:45 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
