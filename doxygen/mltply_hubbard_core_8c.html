<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HΦ: mltplyHubbardCore.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   &#160;<span id="projectnumber">2.0.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mltply_hubbard_core_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mltplyHubbardCore.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for Hubbard hamiltonian (Core)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;bitcalc.h&gt;</code><br />
<code>#include &quot;mfmemory.h&quot;</code><br />
<code>#include &quot;xsetmem.h&quot;</code><br />
<code>#include &quot;<a class="el" href="wrapper_m_p_i_8h_source.html">wrapperMPI.h</a>&quot;</code><br />
<code>#include &quot;mltplyCommon.h&quot;</code><br />
<code>#include &quot;mltplyHubbardCore.h&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for mltplyHubbardCore.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c__incl.png" border="0" usemap="#mltply_hubbard_core_8c" alt=""/></div>
<map name="mltply_hubbard_core_8c" id="mltply_hubbard_core_8c">
<area shape="rect" id="node5" href="wrapper_m_p_i_8h.html" title="Global variables related to MPI and OpenMP. " alt="" coords="329,80,432,107"/>
</map>
</div>
</div>
<p><a href="mltply_hubbard_core_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad2c9c4176ec4f0f7d5087a890467a264"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#ad2c9c4176ec4f0f7d5087a890467a264">child_general_hopp_GetInfo</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, unsigned long int isite1, unsigned long int isite2, unsigned long int sigma1, unsigned long int sigma2)</td></tr>
<tr class="memdesc:ad2c9c4176ec4f0f7d5087a890467a264"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mask for bit operation of hopping term.  <a href="#ad2c9c4176ec4f0f7d5087a890467a264">More...</a><br /></td></tr>
<tr class="separator:ad2c9c4176ec4f0f7d5087a890467a264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a913be849115ac81f093256931b45bba2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a913be849115ac81f093256931b45bba2">child_general_int_GetInfo</a> (int iInterAll, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</td></tr>
<tr class="memdesc:a913be849115ac81f093256931b45bba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mask for bit operation of general interaction term.  <a href="#a913be849115ac81f093256931b45bba2">More...</a><br /></td></tr>
<tr class="separator:a913be849115ac81f093256931b45bba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fbaf32cf6b714a4304e20db480b5404"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a7fbaf32cf6b714a4304e20db480b5404">child_pairhopp_GetInfo</a> (int iPairHopp, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:a7fbaf32cf6b714a4304e20db480b5404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mask for bit operation of pairhop term.  <a href="#a7fbaf32cf6b714a4304e20db480b5404">More...</a><br /></td></tr>
<tr class="separator:a7fbaf32cf6b714a4304e20db480b5404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4765a56a883cd352b3f08546fc3bff08"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a4765a56a883cd352b3f08546fc3bff08">child_exchange_GetInfo</a> (int iExchange, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>)</td></tr>
<tr class="memdesc:a4765a56a883cd352b3f08546fc3bff08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mask for bit operation of exchange term.  <a href="#a4765a56a883cd352b3f08546fc3bff08">More...</a><br /></td></tr>
<tr class="separator:a4765a56a883cd352b3f08546fc3bff08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf3b726a0fbe639a2b7169210c3a24c4"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#acf3b726a0fbe639a2b7169210c3a24c4">GC_CisAis</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin, double complex tmp_trans)</td></tr>
<tr class="memdesc:acf3b726a0fbe639a2b7169210c3a24c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Operation of \(t c_{i\sigma}^\dagger c_{i\sigma}\) (Grandcanonical)  <a href="#acf3b726a0fbe639a2b7169210c3a24c4">More...</a><br /></td></tr>
<tr class="separator:acf3b726a0fbe639a2b7169210c3a24c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29e620c3f3ae1fe39112a747bc1b05d"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#af29e620c3f3ae1fe39112a747bc1b05d">GC_AisCis</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin, double complex tmp_trans)</td></tr>
<tr class="memdesc:af29e620c3f3ae1fe39112a747bc1b05d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Operation of \(t c_{i\sigma} c_{i\sigma}^\dagger\) (Grandcanonical)  <a href="#af29e620c3f3ae1fe39112a747bc1b05d">More...</a><br /></td></tr>
<tr class="separator:af29e620c3f3ae1fe39112a747bc1b05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81e90673aeb377803302428fe3c7b64"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a> (long unsigned int list_1_j, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin)</td></tr>
<tr class="memdesc:aa81e90673aeb377803302428fe3c7b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(c_{is}\\dagger c_{is}\) term in Hubbard (canonical)  <a href="#aa81e90673aeb377803302428fe3c7b64">More...</a><br /></td></tr>
<tr class="separator:aa81e90673aeb377803302428fe3c7b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf0a9a1a4862be39ce011d0acf118928"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#aaf0a9a1a4862be39ce011d0acf118928">CisAjt</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V)</td></tr>
<tr class="memdesc:aaf0a9a1a4862be39ce011d0acf118928"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(c_{is}^\dagger c_{jt}\) term for canonical Hubbard  <a href="#aaf0a9a1a4862be39ce011d0acf118928">More...</a><br /></td></tr>
<tr class="separator:aaf0a9a1a4862be39ce011d0acf118928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a257628b6ed79f7a93d3d2a9a957bc936"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a257628b6ed79f7a93d3d2a9a957bc936">GC_CisAjt</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, double complex tmp_V, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a257628b6ed79f7a93d3d2a9a957bc936"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(c_{is}^\dagger c_{jt}\) term for grandcanonical Hubbard  <a href="#a257628b6ed79f7a93d3d2a9a957bc936">More...</a><br /></td></tr>
<tr class="separator:a257628b6ed79f7a93d3d2a9a957bc936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576edff50809bed2a8ac5016b54027a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a> (long unsigned int list_1_j, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a576edff50809bed2a8ac5016b54027a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute index of wavefunction of final state.  <a href="#a576edff50809bed2a8ac5016b54027a4">More...</a><br /></td></tr>
<tr class="separator:a576edff50809bed2a8ac5016b54027a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af550e9f9e1443323aba1b18cc35be0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a> (long unsigned int list_1_j, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a0af550e9f9e1443323aba1b18cc35be0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute index of wavefunction of final state.  <a href="#a0af550e9f9e1443323aba1b18cc35be0">More...</a><br /></td></tr>
<tr class="separator:a0af550e9f9e1443323aba1b18cc35be0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc7b0c2967b4cd90703907383169df59"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#acc7b0c2967b4cd90703907383169df59">child_exchange_element</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:acc7b0c2967b4cd90703907383169df59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute exchange term of canonical-Hubbard.  <a href="#acc7b0c2967b4cd90703907383169df59">More...</a><br /></td></tr>
<tr class="separator:acc7b0c2967b4cd90703907383169df59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf4f9287c995be7868555e50bbf898f"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#addf4f9287c995be7868555e50bbf898f">child_pairhopp_element</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:addf4f9287c995be7868555e50bbf898f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute pairhopp term of canonical Hubbard system.  <a href="#addf4f9287c995be7868555e50bbf898f">More...</a><br /></td></tr>
<tr class="separator:addf4f9287c995be7868555e50bbf898f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a5f403eb683e5ebee4ab40a8a390e5"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a85a5f403eb683e5ebee4ab40a8a390e5">GC_child_exchange_element</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a85a5f403eb683e5ebee4ab40a8a390e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute exchange term of grandcanonical Hubbard system.  <a href="#a85a5f403eb683e5ebee4ab40a8a390e5">More...</a><br /></td></tr>
<tr class="separator:a85a5f403eb683e5ebee4ab40a8a390e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab45a0a7e963c4c9d2d4bfa86ca5c44b8"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">GC_child_pairhopp_element</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:ab45a0a7e963c4c9d2d4bfa86ca5c44b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute pairhopp term of grandcanonical Hubbard system.  <a href="#ab45a0a7e963c4c9d2d4bfa86ca5c44b8">More...</a><br /></td></tr>
<tr class="separator:ab45a0a7e963c4c9d2d4bfa86ca5c44b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e78b661246513350ad6ee2e3985d9f"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a11e78b661246513350ad6ee2e3985d9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{is} c_{is}^\dagger c_{is}\) term of canonical Hubbard system.  <a href="#a11e78b661246513350ad6ee2e3985d9f">More...</a><br /></td></tr>
<tr class="separator:a11e78b661246513350ad6ee2e3985d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985bdb0d96a952fc6c447e12ea2b906a"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a985bdb0d96a952fc6c447e12ea2b906a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{is} c_{jt}^\dagger c_{ku}\) term of canonical Hubbard system.  <a href="#a985bdb0d96a952fc6c447e12ea2b906a">More...</a><br /></td></tr>
<tr class="separator:a985bdb0d96a952fc6c447e12ea2b906a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8575bdd2f35cf049753b0617d2693edb"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a8575bdd2f35cf049753b0617d2693edb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{ku}\) term of canonical Hubbard system.  <a href="#a8575bdd2f35cf049753b0617d2693edb">More...</a><br /></td></tr>
<tr class="separator:a8575bdd2f35cf049753b0617d2693edb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e64839292192a5851d4be60a4f3561a"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off_2)</td></tr>
<tr class="memdesc:a2e64839292192a5851d4be60a4f3561a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{lv}\) term of canonical Hubbard system.  <a href="#a2e64839292192a5851d4be60a4f3561a">More...</a><br /></td></tr>
<tr class="separator:a2e64839292192a5851d4be60a4f3561a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e5c6a3af522a385b4ee60f66efb2557"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a6e5c6a3af522a385b4ee60f66efb2557"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{is} c_{is}^\dagger c_{is}\) term of grandcanonical Hubbard system.  <a href="#a6e5c6a3af522a385b4ee60f66efb2557">More...</a><br /></td></tr>
<tr class="separator:a6e5c6a3af522a385b4ee60f66efb2557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a389f0d9543e02b5d2e19df0198bafc"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a5a389f0d9543e02b5d2e19df0198bafc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{is} c_{jt}^\dagger c_{ku}\) term of grandcanonical Hubbard system.  <a href="#a5a389f0d9543e02b5d2e19df0198bafc">More...</a><br /></td></tr>
<tr class="separator:a5a389f0d9543e02b5d2e19df0198bafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d585bf30bbcee8449b8c54d0bb128e"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:ab7d585bf30bbcee8449b8c54d0bb128e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{ku}\) term of grandcanonical Hubbard system.  <a href="#ab7d585bf30bbcee8449b8c54d0bb128e">More...</a><br /></td></tr>
<tr class="separator:ab7d585bf30bbcee8449b8c54d0bb128e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d06655a28258eea84191579396219e1"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a> (long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, long unsigned int *tmp_off_2)</td></tr>
<tr class="memdesc:a6d06655a28258eea84191579396219e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{lv}\) term of grandcanonical Hubbard system.  <a href="#a6d06655a28258eea84191579396219e1">More...</a><br /></td></tr>
<tr class="separator:a6d06655a28258eea84191579396219e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82057cd7316bca01585868207301cf39"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a82057cd7316bca01585868207301cf39">GC_Cis</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, long unsigned int is1_spin, double complex tmp_V, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a82057cd7316bca01585868207301cf39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{is}^\dagger\) term of grandcanonical Hubbard system.  <a href="#a82057cd7316bca01585868207301cf39">More...</a><br /></td></tr>
<tr class="separator:a82057cd7316bca01585868207301cf39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a414245ea3f4742224f9d99a0da15a228"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a414245ea3f4742224f9d99a0da15a228">GC_Ajt</a> (long unsigned int j, double complex *tmp_v0, double complex *tmp_v1, long unsigned int is1_spin, double complex tmp_V, long unsigned int *tmp_off)</td></tr>
<tr class="memdesc:a414245ea3f4742224f9d99a0da15a228"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute \(c_{jt}\) term of grandcanonical Hubbard system.  <a href="#a414245ea3f4742224f9d99a0da15a228">More...</a><br /></td></tr>
<tr class="separator:a414245ea3f4742224f9d99a0da15a228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f49b75c63d21a51d25b3d414a759be7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#a3f49b75c63d21a51d25b3d414a759be7">X_Cis</a> (long unsigned int j, long unsigned int is1_spin, long unsigned int *tmp_off, long unsigned int *<a class="el" href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a>, long unsigned int *list_2_1_target, long unsigned int *list_2_2_target, long unsigned int _irght, long unsigned int _ilft, long unsigned int _ihfbit)</td></tr>
<tr class="memdesc:a3f49b75c63d21a51d25b3d414a759be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute index of final wavefunction associatesd to \(c_{is}^\dagger\) term of canonical Hubbard system.  <a href="#a3f49b75c63d21a51d25b3d414a759be7">More...</a><br /></td></tr>
<tr class="separator:a3f49b75c63d21a51d25b3d414a759be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae302b1f2124063034b348974c361f966"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mltply_hubbard_core_8c.html#ae302b1f2124063034b348974c361f966">X_Ajt</a> (long unsigned int j, long unsigned int is1_spin, long unsigned int *tmp_off, long unsigned int *<a class="el" href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a>, long unsigned int *list_2_1_target, long unsigned int *list_2_2_target, long unsigned int _irght, long unsigned int _ilft, long unsigned int _ihfbit)</td></tr>
<tr class="memdesc:ae302b1f2124063034b348974c361f966"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute index of final wavefunction associatesd to \(c_{jt}\) term of canonical Hubbard system.  <a href="#ae302b1f2124063034b348974c361f966">More...</a><br /></td></tr>
<tr class="separator:ae302b1f2124063034b348974c361f966"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for Hubbard hamiltonian (Core) </p>

<p>Definition in file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a11e78b661246513350ad6ee2e3985d9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_CisAisCisAis_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{is} c_{is}^\dagger c_{is}\) term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00690">690</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">X_CisAis()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00645">child_general_int()</a>, <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00458">expec_cisajscktalt_Hubbard()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite1);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    tmp_v0[j] += dmv;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  dam_pr = conj(tmp_v1[j]) * dmv;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}<span class="comment">/*double complex child_CisAisCisAis_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00289">mltplyHubbardCore.c:289</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_cgraph" id="mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="188,13,265,39"/>
</map>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_icgraph" id="mltply_hubbard_core_8c_a11e78b661246513350ad6ee2e3985d9f_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="194,275,313,301"/>
<area shape="rect" id="node23" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="188,362,319,403"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="685,5,767,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="367,275,473,301"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="521,275,579,301"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="882,56,1035,83"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="666,275,786,301"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="662,427,790,453"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="679,528,773,555"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="654,325,798,352"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="651,376,801,403"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="627,107,825,149"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="903,292,1015,319"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="672,173,780,200"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1099,107,1205,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1260,376,1311,403"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="901,376,1016,403"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="913,477,1005,504"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="933,427,984,453"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1095,325,1209,352"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1092,427,1212,453"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="873,107,1044,133"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="885,208,1033,235"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="654,477,798,504"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="874,5,1043,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a985bdb0d96a952fc6c447e12ea2b906a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_CisAisCjtAku_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bsum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{is} c_{jt}^\dagger c_{ku}\) term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite4</td><td>Site 4 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bsum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bdiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00719">719</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">X_CisAis()</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00400">X_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00645">child_general_int()</a>, <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00458">expec_cisajscktalt_Hubbard()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3, isite4, Bsum, Bdiff, tmp_off);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[*tmp_off], X, isite1);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        tmp_v0[*tmp_off] += dmv;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off]) * dmv;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;}<span class="comment">/*double complex child_CisAisCjtAku_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00289">mltplyHubbardCore.c:289</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a576edff50809bed2a8ac5016b54027a4"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a></div><div class="ttdeci">int X_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00400">mltplyHubbardCore.c:400</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_cgraph" id="mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="188,5,265,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. " alt="" coords="189,56,264,83"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="313,31,415,57"/>
<area shape="rect" id="node6" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="316,81,412,108"/>
<area shape="rect" id="node5" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="464,31,525,57"/>
<area shape="rect" id="node7" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="463,81,527,108"/>
</map>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_icgraph" id="mltply_hubbard_core_8c_a985bdb0d96a952fc6c447e12ea2b906a_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="194,275,313,301"/>
<area shape="rect" id="node23" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="188,362,319,403"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="685,5,767,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="367,275,473,301"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="521,275,579,301"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="882,56,1035,83"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="666,275,786,301"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="662,427,790,453"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="679,528,773,555"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="654,325,798,352"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="651,376,801,403"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="627,107,825,149"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="903,292,1015,319"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="672,173,780,200"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1099,107,1205,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1260,376,1311,403"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="901,376,1016,403"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="913,477,1005,504"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="933,427,984,453"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1095,325,1209,352"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1092,427,1212,453"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="873,107,1044,133"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="885,208,1033,235"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="654,477,798,504"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="874,5,1043,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8575bdd2f35cf049753b0617d2693edb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_CisAjtCkuAku_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Asum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Adiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{ku}\) term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite2</td><td>Site 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Adiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00755">755</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">X_CisAis()</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00400">X_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00645">child_general_int()</a>, <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00458">expec_cisajscktalt_Hubbard()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  dam_pr = 0;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite1, isite2, Asum, Adiff, tmp_off);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        tmp_v0[*tmp_off] += dmv;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off]) * dmv;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}<span class="comment">/*double complex child_CisAjtCkuAku_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00289">mltplyHubbardCore.c:289</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a576edff50809bed2a8ac5016b54027a4"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a></div><div class="ttdeci">int X_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00400">mltplyHubbardCore.c:400</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_cgraph" id="mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="192,5,269,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. " alt="" coords="193,56,268,83"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="317,31,419,57"/>
<area shape="rect" id="node6" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="320,81,416,108"/>
<area shape="rect" id="node5" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="468,31,529,57"/>
<area shape="rect" id="node7" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="467,81,531,108"/>
</map>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_icgraph" id="mltply_hubbard_core_8c_a8575bdd2f35cf049753b0617d2693edb_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="198,275,317,301"/>
<area shape="rect" id="node23" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="192,362,323,403"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="689,5,771,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="371,275,477,301"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="525,275,583,301"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="886,56,1039,83"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="670,275,790,301"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="666,427,794,453"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="683,528,777,555"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="658,325,802,352"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="655,376,805,403"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="631,107,829,149"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="907,292,1019,319"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="676,173,784,200"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1103,107,1209,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1264,376,1315,403"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="905,376,1020,403"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="917,477,1009,504"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="937,427,988,453"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1099,325,1213,352"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1096,427,1216,453"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="877,107,1048,133"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="889,208,1037,235"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="658,477,802,504"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="878,5,1047,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2e64839292192a5851d4be60a4f3561a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_CisAjtCkuAlv_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Asum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Adiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bsum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off_2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{lv}\) term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite2</td><td>Site 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite4</td><td>Site 4 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Adiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bsum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bdiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off_2</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00792">792</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00400">X_CisAjt()</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00432">X_GC_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00645">child_general_int()</a>, <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00458">expec_cisajscktalt_Hubbard()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_1;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j], X, isite3, isite4, Bsum, Bdiff, &amp;tmp_off_1);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a>(tmp_off_1, X, isite1, isite2, Asum, Adiff, tmp_off_2);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        tmp_v0[*tmp_off_2] += dmv;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off_2]) * dmv;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;}<span class="comment">/*double complex child_CisAjtCkuAlv_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_a576edff50809bed2a8ac5016b54027a4"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4">X_CisAjt</a></div><div class="ttdeci">int X_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00400">mltplyHubbardCore.c:400</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a0af550e9f9e1443323aba1b18cc35be0"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a></div><div class="ttdeci">int X_GC_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00432">mltplyHubbardCore.c:432</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_cgraph" id="mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. " alt="" coords="188,56,263,83"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="311,5,412,32"/>
<area shape="rect" id="node5" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="313,56,409,83"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="461,5,523,32"/>
<area shape="rect" id="node6" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="460,56,524,83"/>
</map>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_icgraph" id="mltply_hubbard_core_8c_a2e64839292192a5851d4be60a4f3561a_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="194,275,313,301"/>
<area shape="rect" id="node23" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="188,362,319,403"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="685,5,767,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="367,275,473,301"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="521,275,579,301"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="882,56,1035,83"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="666,275,786,301"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="662,427,790,453"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="679,528,773,555"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="654,325,798,352"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="651,376,801,403"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="627,107,825,149"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="903,292,1015,319"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="672,173,780,200"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1099,107,1205,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1260,376,1311,403"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="901,376,1016,403"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="913,477,1005,504"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="933,427,984,453"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1095,325,1209,352"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1092,427,1212,453"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="873,107,1044,133"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="885,208,1033,235"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="654,477,798,504"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="874,5,1043,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acc7b0c2967b4cd90703907383169df59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_exchange_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute exchange term of canonical-Hubbard. </p>
<dl class="section return"><dt>Returns</dt><dd></dd>
<dd>
\(\langle v_1|{\hat H}_{\rm this}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>\(v_0 = H v_1\) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Vector to be producted </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tmp_off</td><td>[off] Index of wavefunction of final state </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00473">473</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="bitcalc_8c_source.html#l00195">GetOffComp()</a>, <a class="el" href="struct_8h_source.html#l00267">LargeList::ihfbit</a>, <a class="el" href="struct_8h_source.html#l00266">LargeList::ilft</a>, <a class="el" href="struct_8h_source.html#l00265">LargeList::irght</a>, <a class="el" href="struct_8h_source.html#l00248">LargeList::is1_down</a>, <a class="el" href="struct_8h_source.html#l00247">LargeList::is1_up</a>, <a class="el" href="struct_8h_source.html#l00250">LargeList::is2_down</a>, <a class="el" href="struct_8h_source.html#l00249">LargeList::is2_up</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="global_8h_source.html#l00050">list_2_1</a>, <a class="el" href="global_8h_source.html#l00051">list_2_2</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="struct_8h_source.html#l00245">LargeList::tmp_J</a>, and <a class="el" href="global_8h_source.html#l00025">TRUE</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00561">child_exchange()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ilft = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihfbit = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  ibit1_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_up;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  ibit2_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_up;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  ibit1_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_down;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  ibit2_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_down;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down != 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down == 0) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] - (is1_down + is2_up);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    iexchg += (is1_up + is2_down);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, irght, ilft, ihfbit, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      tmp_v0[off] += dmv;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    dam_pr += dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibit1_up != 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up == 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] - (is1_up + is2_down);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    iexchg += (is1_down + is2_up);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, irght, ilft, ihfbit, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      tmp_v0[off] += dmv;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    dam_pr += dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}<span class="comment">/*double complex child_exchange_element*/</span></div><div class="ttc" id="struct_large_list_html_a855e8bc4876c7e6da5249d8ae2b46b9c"><div class="ttname"><a href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">LargeList::ihfbit</a></div><div class="ttdeci">long unsigned int ihfbit</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00267">struct.h:267</a></div></div>
<div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00249">struct.h:249</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00245">struct.h:245</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00250">struct.h:250</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00247">struct.h:247</a></div></div>
<div class="ttc" id="struct_large_list_html_a8e610d200c449d87882eccdc479b8cab"><div class="ttname"><a href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">LargeList::ilft</a></div><div class="ttdeci">long unsigned int ilft</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00266">struct.h:266</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00248">struct.h:248</a></div></div>
<div class="ttc" id="global_8h_html_a59e163bd798ad16a8c9d47e545e2e42f"><div class="ttname"><a href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a></div><div class="ttdeci">long unsigned int * list_2_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00050">global.h:50</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
<div class="ttc" id="global_8h_html_aac1d1cc6d1099e228cb1f505ef0c86c6"><div class="ttname"><a href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a></div><div class="ttdeci">long unsigned int * list_2_2</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00051">global.h:51</a></div></div>
<div class="ttc" id="struct_large_list_html_ae434b7a485083dd5e96f24a24bc3e9b8"><div class="ttname"><a href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">LargeList::irght</a></div><div class="ttdeci">long unsigned int irght</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00265">struct.h:265</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_cgraph" id="mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="219,5,315,32"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="363,5,427,32"/>
</map>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_icgraph" id="mltply_hubbard_core_8c_acc7b0c2967b4cd90703907383169df59_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a5821f04d36f42ce53a1d522dcb5548c5" title="Compute Exchange term (canonical) in single process. " alt="" coords="219,215,331,241"/>
<area shape="rect" id="node23" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="697,107,779,133"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="379,253,485,280"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="533,291,591,317"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="894,157,1047,184"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="678,512,798,539"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="674,259,802,285"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="691,208,785,235"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="666,461,810,488"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="663,411,813,437"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="639,41,837,82"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="915,360,1027,387"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="684,309,792,336"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1111,107,1217,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1272,259,1323,285"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="913,411,1028,437"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="925,259,1017,285"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="945,309,996,336"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1107,208,1221,235"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1104,309,1224,336"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="885,56,1056,83"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="897,5,1045,32"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="886,107,1055,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4765a56a883cd352b3f08546fc3bff08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int child_exchange_GetInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iExchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute mask for bit operation of exchange term. </p>
<dl class="section return"><dt>Returns</dt><dd>Error-code, always return 0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<p>Copy coupling constant (<a class="el" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f" title="Coupling constant. ">LargeList::tmp_J</a>)</p>
<p>Compute mask for checking occupations of \((i_1,\uparrow)\) (<a class="el" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76" title="Mask used in the bit oeration. ">LargeList::is1_up</a>), \((i_1,\downarrow)\) (<a class="el" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf" title="Mask used in the bit oeration. ">LargeList::is1_down</a>) \((i_2,\uparrow)\) (<a class="el" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4" title="Mask used in the bit oeration. ">LargeList::is2_up</a>), \((i_2,\downarrow)\) (<a class="el" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d" title="Mask used in the bit oeration. ">LargeList::is2_down</a>)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iExchange</td><td>Index of exchange interaction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00198">198</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00332">BindStruct::Def</a>, <a class="el" href="struct_8h_source.html#l00138">DefineList::ExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00248">LargeList::is1_down</a>, <a class="el" href="struct_8h_source.html#l00247">LargeList::is1_up</a>, <a class="el" href="struct_8h_source.html#l00250">LargeList::is2_down</a>, <a class="el" href="struct_8h_source.html#l00249">LargeList::is2_up</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00140">DefineList::ParaExchangeCoupling</a>, <a class="el" href="struct_8h_source.html#l00245">LargeList::tmp_J</a>, and <a class="el" href="struct_8h_source.html#l00082">DefineList::Tpow</a>.</p>

<p>Referenced by <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>, and <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">int</span> isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[iExchange][0] + 1;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">int</span> isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">ExchangeCoupling</a>[iExchange][1] + 1;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a> = -X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">ParaExchangeCoupling</a>[iExchange];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2];</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1];</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}<span class="comment">/*int child_exchange_GetInfo*/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="struct_define_list_html_aca15af1bddc7adf084cf01542a25f4c2"><div class="ttname"><a href="struct_define_list.html#aca15af1bddc7adf084cf01542a25f4c2">DefineList::ExchangeCoupling</a></div><div class="ttdeci">int ** ExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling][2] Index of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00138">struct.h:138</a></div></div>
<div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00249">struct.h:249</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00245">struct.h:245</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00250">struct.h:250</a></div></div>
<div class="ttc" id="struct_define_list_html_a854ba3669106f1f557d0c021c44430b6"><div class="ttname"><a href="struct_define_list.html#a854ba3669106f1f557d0c021c44430b6">DefineList::ParaExchangeCoupling</a></div><div class="ttdeci">double * ParaExchangeCoupling</div><div class="ttdoc">[DefineList::NExchangeCoupling] Coupling constant of exchange term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00140">struct.h:140</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00247">struct.h:247</a></div></div>
<div class="ttc" id="struct_define_list_html_add52f995b8c9ac337a079d0bbf8ae095"><div class="ttname"><a href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">DefineList::Tpow</a></div><div class="ttdeci">long unsigned int * Tpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00082">struct.h:82</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00248">struct.h:248</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a4765a56a883cd352b3f08546fc3bff08_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a4765a56a883cd352b3f08546fc3bff08_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a4765a56a883cd352b3f08546fc3bff08_icgraph" id="mltply_hubbard_core_8c_a4765a56a883cd352b3f08546fc3bff08_icgraph">
<area shape="rect" id="node2" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="554,107,637,133"/>
<area shape="rect" id="node7" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="226,284,333,311"/>
<area shape="rect" id="node24" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="216,233,343,260"/>
<area shape="rect" id="node3" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="965,208,1078,235"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="743,107,913,133"/>
<area shape="rect" id="node4" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1129,259,1180,285"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="969,107,1074,133"/>
<area shape="rect" id="node8" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="391,284,448,311"/>
<area shape="rect" id="node9" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="751,157,905,184"/>
<area shape="rect" id="node10" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="535,512,655,539"/>
<area shape="rect" id="node12" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="531,309,659,336"/>
<area shape="rect" id="node16" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="549,208,642,235"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="523,461,667,488"/>
<area shape="rect" id="node18" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="521,411,670,437"/>
<area shape="rect" id="node19" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="496,41,695,82"/>
<area shape="rect" id="node22" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="772,360,884,387"/>
<area shape="rect" id="node23" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="541,259,649,285"/>
<area shape="rect" id="node11" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="771,411,885,437"/>
<area shape="rect" id="node13" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="782,259,874,285"/>
<area shape="rect" id="node14" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="803,309,853,336"/>
<area shape="rect" id="node15" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="961,309,1081,336"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="743,56,913,83"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="754,5,902,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad2c9c4176ec4f0f7d5087a890467a264"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int child_general_hopp_GetInfo </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long int&#160;</td>
          <td class="paramname"><em>isite2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long int&#160;</td>
          <td class="paramname"><em>sigma1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long int&#160;</td>
          <td class="paramname"><em>sigma2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute mask for bit operation of hopping term. </p>
<dl class="section return"><dt>Returns</dt><dd>Error-code, always return 0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<p>Compute mask for checking occupations of \((i_1,\sigma_1)\) (<a class="el" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2" title="Mask used in the bit oeration. ">LargeList::is1_spin</a>) and \((i_2,\sigma_2)\) (<a class="el" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440" title="Mask used in the bit oeration. ">LargeList::is2_spin</a>)</p>
<p>Compute mask for Fermion sign (<a class="el" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07" title="Mask used in the bit oeration. ">LargeList::A_spin</a>)</p>
<p>Compute mask for hopping (<a class="el" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f" title="Mask used in the bit oeration. ">LargeList::isA_spin</a>)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite2</td><td>Site index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma1</td><td>Spin index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma2</td><td>Spin index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00035">35</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00263">LargeList::A_spin</a>, <a class="el" href="struct_8h_source.html#l00332">BindStruct::Def</a>, <a class="el" href="struct_8h_source.html#l00254">LargeList::is1_spin</a>, <a class="el" href="struct_8h_source.html#l00255">LargeList::is2_spin</a>, <a class="el" href="struct_8h_source.html#l00268">LargeList::isA_spin</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, and <a class="el" href="struct_8h_source.html#l00082">DefineList::Tpow</a>.</p>

<p>Referenced by <a class="el" href="expec__cisajs_8c_source.html#l00230">expec_cisajs_Hubbard()</a>, <a class="el" href="expec__cisajs_8c_source.html#l00170">expec_cisajs_HubbardGC()</a>, <a class="el" href="_pair_ex_hubbard_8c_source.html#l00121">GetPairExcitedStateHubbard()</a>, <a class="el" href="_pair_ex_hubbard_8c_source.html#l00021">GetPairExcitedStateHubbardGC()</a>, <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>, <a class="el" href="mltply_spin_8c_source.html#l00416">mltplyHalfSpinGC()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>, and <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1];</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2];</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">if</span> (isite1 &gt; isite2) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite1 &lt; isite2) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (sigma1 &gt; sigma2) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a> + X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}<span class="comment">/*int child_general_hopp_GetInfo*/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00254">struct.h:254</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00263">struct.h:263</a></div></div>
<div class="ttc" id="struct_define_list_html_add52f995b8c9ac337a079d0bbf8ae095"><div class="ttname"><a href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">DefineList::Tpow</a></div><div class="ttdeci">long unsigned int * Tpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00082">struct.h:82</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00255">struct.h:255</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00268">struct.h:268</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_ad2c9c4176ec4f0f7d5087a890467a264_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_ad2c9c4176ec4f0f7d5087a890467a264_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_ad2c9c4176ec4f0f7d5087a890467a264_icgraph" id="mltply_hubbard_core_8c_ad2c9c4176ec4f0f7d5087a890467a264_icgraph">
<area shape="rect" id="node2" href="expec__cisajs_8c.html#a7b526b4cb5619bc0908c98c04428ffab" title="expec_cisajs_Hubbard" alt="" coords="445,510,600,536"/>
<area shape="rect" id="node10" href="expec__cisajs_8c.html#a0d30174954dc8ad83ceeba5932ece811" title="expec_cisajs_HubbardGC" alt="" coords="648,452,823,479"/>
<area shape="rect" id="node11" href="_pair_ex_hubbard_8c.html#ad6ea48aa669d72fd8cc85162bae8b834" title="GetPairExcitedStateHubbard" alt="" coords="197,123,387,150"/>
<area shape="rect" id="node15" href="_pair_ex_hubbard_8c.html#aab52ec15363468b5cc7dd30215d889fe" title="GetPairExcitedStateHubbardGC" alt="" coords="187,174,397,200"/>
<area shape="rect" id="node16" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="929,56,1011,83"/>
<area shape="rect" id="node18" href="mltply_spin_8c.html#aaacfb2aca0416786e4c48f0d5361152e" title="Driver function for Spin 1/2 Hamiltonian (grandcanonical) " alt="" coords="229,275,355,302"/>
<area shape="rect" id="node32" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="469,326,576,352"/>
<area shape="rect" id="node33" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="229,376,355,403"/>
<area shape="rect" id="node3" href="expec__cisajs_8c.html#aaaa7c9da11d8ae60fe21f1d046358a6c" title="function of calculation for one body green&#39;s function " alt="" coords="921,528,1019,555"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1145,474,1260,500"/>
<area shape="rect" id="node6" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1157,360,1249,387"/>
<area shape="rect" id="node7" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1177,411,1228,438"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1504,360,1555,387"/>
<area shape="rect" id="node8" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1339,360,1453,387"/>
<area shape="rect" id="node9" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1336,411,1456,438"/>
<area shape="rect" id="node12" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="452,123,593,150"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="676,64,795,91"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1343,158,1449,184"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="1118,56,1287,83"/>
<area shape="rect" id="node19" href="mltply_spin_8c.html#a367fcb99b257491d4370cdef55e496de" title="Driver function for Spin hamiltonian. " alt="" coords="471,275,574,302"/>
<area shape="rect" id="node20" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="707,326,764,352"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1126,107,1279,134"/>
<area shape="rect" id="node22" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="910,427,1030,454"/>
<area shape="rect" id="node23" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="906,376,1034,403"/>
<area shape="rect" id="node24" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="923,275,1017,302"/>
<area shape="rect" id="node25" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="898,478,1042,504"/>
<area shape="rect" id="node26" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="895,579,1045,606"/>
<area shape="rect" id="node27" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="871,158,1069,200"/>
<area shape="rect" id="node30" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1147,310,1259,336"/>
<area shape="rect" id="node31" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="916,326,1024,352"/>
<area shape="rect" id="node28" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1117,208,1288,235"/>
<area shape="rect" id="node29" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1129,259,1277,286"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a913be849115ac81f093256931b45bba2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int child_general_int_GetInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iInterAll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sigma1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sigma2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sigma3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sigma4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute mask for bit operation of general interaction term. </p>
<dl class="section return"><dt>Returns</dt><dd>Error-code, always return 0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<p>Compute mask for checking occupations of \((i_1,\sigma_1)\) (<a class="el" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2" title="Mask used in the bit oeration. ">LargeList::is1_spin</a>) and \((i_2,\sigma_2)\) (<a class="el" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440" title="Mask used in the bit oeration. ">LargeList::is2_spin</a>)</p>
<p>Compute mask for Fermion sign (<a class="el" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07" title="Mask used in the bit oeration. ">LargeList::A_spin</a>)</p>
<p>Compute mask for checking occupations of \((i_3,\sigma_3)\) (<a class="el" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435" title="Mask used in the bit oeration. ">LargeList::is3_spin</a>) and \((i_4,\sigma_4)\) (<a class="el" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60" title="Mask used in the bit oeration. ">LargeList::is4_spin</a>)</p>
<p>Compute mask for Fermion sign (<a class="el" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282" title="Mask used in the bit oeration. ">LargeList::B_spin</a>)</p>
<p>Compute mask for hopping (<a class="el" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f" title="Mask used in the bit oeration. ">LargeList::isA_spin</a>, <a class="el" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476" title="Mask used in the bit oeration. ">LargeList::isB_spin</a>)</p>
<p>Copy coupling constant (<a class="el" href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9" title="Coupling constant. ">LargeList::tmp_V</a>)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iInterAll</td><td>It is not used </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite2</td><td>Site index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite4</td><td>Site index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma1</td><td>Spin index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma2</td><td>Spin index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma3</td><td>Spin index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma4</td><td>Spin index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00077">77</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00263">LargeList::A_spin</a>, <a class="el" href="struct_8h_source.html#l00264">LargeList::B_spin</a>, <a class="el" href="struct_8h_source.html#l00332">BindStruct::Def</a>, <a class="el" href="struct_8h_source.html#l00254">LargeList::is1_spin</a>, <a class="el" href="struct_8h_source.html#l00255">LargeList::is2_spin</a>, <a class="el" href="struct_8h_source.html#l00256">LargeList::is3_spin</a>, <a class="el" href="struct_8h_source.html#l00257">LargeList::is4_spin</a>, <a class="el" href="struct_8h_source.html#l00268">LargeList::isA_spin</a>, <a class="el" href="struct_8h_source.html#l00269">LargeList::isB_spin</a>, <a class="el" href="struct_8h_source.html#l00258">LargeList::isite1</a>, <a class="el" href="struct_8h_source.html#l00259">LargeList::isite2</a>, <a class="el" href="struct_8h_source.html#l00260">LargeList::isite3</a>, <a class="el" href="struct_8h_source.html#l00261">LargeList::isite4</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00270">LargeList::tmp_V</a>, and <a class="el" href="struct_8h_source.html#l00082">DefineList::Tpow</a>.</p>

<p>Referenced by <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00458">expec_cisajscktalt_Hubbard()</a>, <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00350">expec_cisajscktalt_HubbardGC()</a>, <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>, and <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_spin, is2_spin, is3_spin, is4_spin;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> A_spin, B_spin;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isA_spin, isB_spin;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  is1_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  is2_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (isite1 &gt; isite2) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite2 &gt; isite1) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">else</span> {<span class="comment">//isite1=isite2</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (sigma1 &gt; sigma2) {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2 + sigma1] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1 + sigma2]);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      A_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2 + sigma2] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1 + sigma1]);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  is3_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 2 + sigma3];</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  is4_spin = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 2 + sigma4];</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> (isite3 &gt; isite4) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 2 + sigma3] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 1 + sigma4]);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isite3 &lt; isite4) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 2 + sigma4] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 1 + sigma3]);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">else</span> {<span class="comment">//isite3=isite4</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (sigma3 &gt; sigma4) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 2 + sigma3] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 1 + sigma4]);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      B_spin = (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite4 - 2 + sigma4] - X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite3 - 1 + sigma3]);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  isA_spin = is1_spin + is2_spin;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  isB_spin = is3_spin + is4_spin;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a> = is1_spin;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a> = is2_spin;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a> = is3_spin;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a> = is4_spin;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a> = isA_spin;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a> = isB_spin;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a> = A_spin;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a> = B_spin;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">tmp_V</a> = tmp_V;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae17d138429da3b0e55e106e9599c499b">isite1</a> = isite1;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a523438b712f4d79554b6331505e70e14">isite2</a> = isite2;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a9bfe297ac2953656469df4531a9bdd0b">isite3</a> = isite3;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a29034b413fdc5c9ff20e38ba94f72bc7">isite4</a> = isite4;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}<span class="comment">/*int child_general_int_GetInfo*/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00264">struct.h:264</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00257">struct.h:257</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00269">struct.h:269</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00254">struct.h:254</a></div></div>
<div class="ttc" id="struct_large_list_html_a523438b712f4d79554b6331505e70e14"><div class="ttname"><a href="struct_large_list.html#a523438b712f4d79554b6331505e70e14">LargeList::isite2</a></div><div class="ttdeci">int isite2</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00259">struct.h:259</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00256">struct.h:256</a></div></div>
<div class="ttc" id="struct_large_list_html_a9bfe297ac2953656469df4531a9bdd0b"><div class="ttname"><a href="struct_large_list.html#a9bfe297ac2953656469df4531a9bdd0b">LargeList::isite3</a></div><div class="ttdeci">int isite3</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00260">struct.h:260</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00263">struct.h:263</a></div></div>
<div class="ttc" id="struct_define_list_html_add52f995b8c9ac337a079d0bbf8ae095"><div class="ttname"><a href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">DefineList::Tpow</a></div><div class="ttdeci">long unsigned int * Tpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00082">struct.h:82</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00255">struct.h:255</a></div></div>
<div class="ttc" id="struct_large_list_html_a29034b413fdc5c9ff20e38ba94f72bc7"><div class="ttname"><a href="struct_large_list.html#a29034b413fdc5c9ff20e38ba94f72bc7">LargeList::isite4</a></div><div class="ttdeci">int isite4</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00261">struct.h:261</a></div></div>
<div class="ttc" id="struct_large_list_html_ad706dd1a7ccaaa6f4e50cdcde74382a9"><div class="ttname"><a href="struct_large_list.html#ad706dd1a7ccaaa6f4e50cdcde74382a9">LargeList::tmp_V</a></div><div class="ttdeci">double complex tmp_V</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00270">struct.h:270</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00268">struct.h:268</a></div></div>
<div class="ttc" id="struct_large_list_html_ae17d138429da3b0e55e106e9599c499b"><div class="ttname"><a href="struct_large_list.html#ae17d138429da3b0e55e106e9599c499b">LargeList::isite1</a></div><div class="ttdeci">int isite1</div><div class="ttdoc">Is it realy used ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00258">struct.h:258</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a913be849115ac81f093256931b45bba2_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a913be849115ac81f093256931b45bba2_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a913be849115ac81f093256931b45bba2_icgraph" id="mltply_hubbard_core_8c_a913be849115ac81f093256931b45bba2_icgraph">
<area shape="rect" id="node2" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="223,485,353,526"/>
<area shape="rect" id="node10" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="401,434,532,475"/>
<area shape="rect" id="node11" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="638,5,721,32"/>
<area shape="rect" id="node14" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="235,351,341,377"/>
<area shape="rect" id="node27" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="225,300,351,327"/>
<area shape="rect" id="node3" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="607,528,751,555"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="855,275,969,301"/>
<area shape="rect" id="node6" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="866,471,958,497"/>
<area shape="rect" id="node7" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="887,351,937,377"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1213,325,1264,352"/>
<area shape="rect" id="node8" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1049,325,1162,352"/>
<area shape="rect" id="node9" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1045,376,1165,403"/>
<area shape="rect" id="node12" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="827,5,997,32"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1053,157,1158,184"/>
<area shape="rect" id="node15" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="438,300,495,327"/>
<area shape="rect" id="node16" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="835,208,989,235"/>
<area shape="rect" id="node17" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="619,275,739,301"/>
<area shape="rect" id="node18" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="615,325,743,352"/>
<area shape="rect" id="node19" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="633,477,726,504"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="607,173,751,200"/>
<area shape="rect" id="node21" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="605,224,754,251"/>
<area shape="rect" id="node22" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="580,57,779,98"/>
<area shape="rect" id="node25" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="856,413,968,440"/>
<area shape="rect" id="node26" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="625,376,733,403"/>
<area shape="rect" id="node23" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="827,157,997,184"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="838,56,986,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="addf4f9287c995be7868555e50bbf898f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_pairhopp_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute pairhopp term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00534">534</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="bitcalc_8c_source.html#l00195">GetOffComp()</a>, <a class="el" href="struct_8h_source.html#l00267">LargeList::ihfbit</a>, <a class="el" href="struct_8h_source.html#l00266">LargeList::ilft</a>, <a class="el" href="struct_8h_source.html#l00265">LargeList::irght</a>, <a class="el" href="struct_8h_source.html#l00248">LargeList::is1_down</a>, <a class="el" href="struct_8h_source.html#l00247">LargeList::is1_up</a>, <a class="el" href="struct_8h_source.html#l00250">LargeList::is2_down</a>, <a class="el" href="struct_8h_source.html#l00249">LargeList::is2_up</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="global_8h_source.html#l00050">list_2_1</a>, <a class="el" href="global_8h_source.html#l00051">list_2_2</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="struct_8h_source.html#l00245">LargeList::tmp_J</a>, and <a class="el" href="global_8h_source.html#l00025">TRUE</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00540">child_pairhopp()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ilft = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihfbit = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  ibit1_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_up;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  ibit2_up = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_up;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  ibit1_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_down;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  ibit2_down = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_down;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] - (is2_up + is2_down);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    iexchg += (is1_up + is1_down);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, irght, ilft, ihfbit, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      tmp_v0[off] += dmv;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    dam_pr += dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}<span class="comment">/*double complex child_pairhopp_element*/</span></div><div class="ttc" id="struct_large_list_html_a855e8bc4876c7e6da5249d8ae2b46b9c"><div class="ttname"><a href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">LargeList::ihfbit</a></div><div class="ttdeci">long unsigned int ihfbit</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00267">struct.h:267</a></div></div>
<div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00249">struct.h:249</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00245">struct.h:245</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00250">struct.h:250</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00247">struct.h:247</a></div></div>
<div class="ttc" id="struct_large_list_html_a8e610d200c449d87882eccdc479b8cab"><div class="ttname"><a href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">LargeList::ilft</a></div><div class="ttdeci">long unsigned int ilft</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00266">struct.h:266</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00248">struct.h:248</a></div></div>
<div class="ttc" id="global_8h_html_a59e163bd798ad16a8c9d47e545e2e42f"><div class="ttname"><a href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a></div><div class="ttdeci">long unsigned int * list_2_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00050">global.h:50</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
<div class="ttc" id="global_8h_html_aac1d1cc6d1099e228cb1f505ef0c86c6"><div class="ttname"><a href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a></div><div class="ttdeci">long unsigned int * list_2_2</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00051">global.h:51</a></div></div>
<div class="ttc" id="struct_large_list_html_ae434b7a485083dd5e96f24a24bc3e9b8"><div class="ttname"><a href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">LargeList::irght</a></div><div class="ttdeci">long unsigned int irght</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00265">struct.h:265</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_cgraph" id="mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="212,5,308,32"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="356,5,420,32"/>
</map>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_icgraph" id="mltply_hubbard_core_8c_addf4f9287c995be7868555e50bbf898f_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a4d178b47dde9c5e387a87d482463575d" title="Compute pairhopp term (canonical) " alt="" coords="212,215,317,241"/>
<area shape="rect" id="node23" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="683,107,766,133"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="365,253,472,280"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="520,291,577,317"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="881,157,1034,184"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="665,512,785,539"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="661,259,789,285"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="678,208,771,235"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="653,461,797,488"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="650,411,799,437"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="625,41,824,82"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="901,360,1013,387"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="671,309,779,336"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1098,107,1203,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1259,259,1309,285"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="900,411,1015,437"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="911,259,1003,285"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="932,309,983,336"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1094,208,1207,235"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1091,309,1211,336"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="872,56,1043,83"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="883,5,1031,32"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="873,107,1042,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7fbaf32cf6b714a4304e20db480b5404"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int child_pairhopp_GetInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iPairHopp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute mask for bit operation of pairhop term. </p>
<dl class="section return"><dt>Returns</dt><dd>Error-code, always return 0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<p>Copy coupling constant (<a class="el" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f" title="Coupling constant. ">LargeList::tmp_J</a>)</p>
<p>Compute mask for checking occupations of \((i_1,\uparrow)\) (<a class="el" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76" title="Mask used in the bit oeration. ">LargeList::is1_up</a>), \((i_1,\downarrow)\) (<a class="el" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf" title="Mask used in the bit oeration. ">LargeList::is1_down</a>) \((i_2,\uparrow)\) (<a class="el" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4" title="Mask used in the bit oeration. ">LargeList::is2_up</a>), \((i_2,\downarrow)\) (<a class="el" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d" title="Mask used in the bit oeration. ">LargeList::is2_down</a>)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iPairHopp</td><td>Index of pairhopp interaction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00170">170</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00332">BindStruct::Def</a>, <a class="el" href="struct_8h_source.html#l00248">LargeList::is1_down</a>, <a class="el" href="struct_8h_source.html#l00247">LargeList::is1_up</a>, <a class="el" href="struct_8h_source.html#l00250">LargeList::is2_down</a>, <a class="el" href="struct_8h_source.html#l00249">LargeList::is2_up</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00132">DefineList::PairHopping</a>, <a class="el" href="struct_8h_source.html#l00134">DefineList::ParaPairHopping</a>, <a class="el" href="struct_8h_source.html#l00245">LargeList::tmp_J</a>, and <a class="el" href="struct_8h_source.html#l00082">DefineList::Tpow</a>.</p>

<p>Referenced by <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00150">mltplyHubbard()</a>, and <a class="el" href="mltply_hubbard_8c_source.html#l00347">mltplyHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[iPairHopp][0] + 1;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">int</span> isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">PairHopping</a>[iPairHopp][1] + 1;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">ParaPairHopping</a>[iPairHopp];</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 2];</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite1 - 1];</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 2];</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a> = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">Tpow</a>[2 * isite2 - 1];</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}<span class="comment">/*int child_pairhopp_GetInfo*/</span></div><div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdoc">Definision of system (Hamiltonian) etc. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00332">struct.h:332</a></div></div>
<div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00249">struct.h:249</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_define_list_html_ad60b3e75def64fc7dbdcd484236419eb"><div class="ttname"><a href="struct_define_list.html#ad60b3e75def64fc7dbdcd484236419eb">DefineList::PairHopping</a></div><div class="ttdeci">int ** PairHopping</div><div class="ttdoc">[DefineList::NPairHopping][2] Index of pair-hopping. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00132">struct.h:132</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00245">struct.h:245</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00250">struct.h:250</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00247">struct.h:247</a></div></div>
<div class="ttc" id="struct_define_list_html_add52f995b8c9ac337a079d0bbf8ae095"><div class="ttname"><a href="struct_define_list.html#add52f995b8c9ac337a079d0bbf8ae095">DefineList::Tpow</a></div><div class="ttdeci">long unsigned int * Tpow</div><div class="ttdoc">[2 * DefineList::NsiteMPI]  malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00082">struct.h:82</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00248">struct.h:248</a></div></div>
<div class="ttc" id="struct_define_list_html_ad5e8872cb5fff4eebf3e8b8f1c42ec8e"><div class="ttname"><a href="struct_define_list.html#ad5e8872cb5fff4eebf3e8b8f1c42ec8e">DefineList::ParaPairHopping</a></div><div class="ttdeci">double * ParaPairHopping</div><div class="ttdoc">[DefineList::NPairHopping] Coupling constant of pair-hopping term. malloc in setmem_def(). </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00134">struct.h:134</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a7fbaf32cf6b714a4304e20db480b5404_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a7fbaf32cf6b714a4304e20db480b5404_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a7fbaf32cf6b714a4304e20db480b5404_icgraph" id="mltply_hubbard_core_8c_a7fbaf32cf6b714a4304e20db480b5404_icgraph">
<area shape="rect" id="node2" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="546,107,629,133"/>
<area shape="rect" id="node7" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="218,284,325,311"/>
<area shape="rect" id="node24" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="208,233,335,260"/>
<area shape="rect" id="node3" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="957,208,1070,235"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="735,107,905,133"/>
<area shape="rect" id="node4" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1121,259,1172,285"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="961,107,1066,133"/>
<area shape="rect" id="node8" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="383,284,440,311"/>
<area shape="rect" id="node9" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="743,157,897,184"/>
<area shape="rect" id="node10" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="527,512,647,539"/>
<area shape="rect" id="node12" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="523,309,651,336"/>
<area shape="rect" id="node16" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="541,208,634,235"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="515,461,659,488"/>
<area shape="rect" id="node18" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="513,411,662,437"/>
<area shape="rect" id="node19" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="488,41,687,82"/>
<area shape="rect" id="node22" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="764,360,876,387"/>
<area shape="rect" id="node23" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="533,259,641,285"/>
<area shape="rect" id="node11" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="763,411,877,437"/>
<area shape="rect" id="node13" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="774,259,866,285"/>
<area shape="rect" id="node14" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="795,309,845,336"/>
<area shape="rect" id="node15" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="953,309,1073,336"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="735,56,905,83"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="746,5,894,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf0a9a1a4862be39ce011d0acf118928"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex CisAjt </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is2_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sum_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>diff_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\(c_{is}^\dagger c_{jt}\) term for canonical Hubbard </p>
<dl class="section return"><dt>Returns</dt><dd>\(\langle v_1|{\hat H}_{\rm this}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>\(v_0 = H v_1\) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Vector to be producted </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Mask for occupation of (is) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is2_spin</td><td>Mask for occupation of (jt) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sum_spin</td><td>Mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diff_spin</td><td>Mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Hopping integral </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00306">306</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00024">FALSE</a>, <a class="el" href="bitcalc_8c_source.html#l00195">GetOffComp()</a>, <a class="el" href="struct_8h_source.html#l00267">LargeList::ihfbit</a>, <a class="el" href="struct_8h_source.html#l00266">LargeList::ilft</a>, <a class="el" href="struct_8h_source.html#l00265">LargeList::irght</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00048">list_1</a>, <a class="el" href="global_8h_source.html#l00050">list_2_1</a>, <a class="el" href="global_8h_source.html#l00051">list_2_2</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00582">child_general_hopp()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l01105">X_child_CisAjtCkuAku_Hubbard_MPI()</a>, and <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00893">X_child_CisAjtCkuAlv_Hubbard_MPI()</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1, ibit_tmp_2;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit, iexchg, off;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">int</span> sgn;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  ibit_tmp_1 = (<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is1_spin);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  ibit_tmp_2 = (<a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; is2_spin);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0 &amp;&amp; ibit_tmp_2 != 0) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    bit = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] &amp; diff_spin;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    iexchg = <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j] ^ sum_spin;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>, &amp;off)==<a class="code" href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">    if(X-&gt;Large.mode==M_CORR){</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">      fprintf(stdout, &quot;DEBUG-1: myrank=%d, org=%d, bit=%d, iexchg=%d, list_1[%d]=%d\n&quot;,</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">              myrank, list_1[j], bit, iexchg, off, list_1[off]);</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    dmv = sgn * tmp_v1[j];</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      tmp_v0[off] += tmp_V * dmv;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    dam_pr = dmv * conj(tmp_v1[off]);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="ttc" id="struct_large_list_html_a855e8bc4876c7e6da5249d8ae2b46b9c"><div class="ttname"><a href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">LargeList::ihfbit</a></div><div class="ttdeci">long unsigned int ihfbit</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00267">struct.h:267</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="struct_large_list_html_a8e610d200c449d87882eccdc479b8cab"><div class="ttname"><a href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">LargeList::ilft</a></div><div class="ttdeci">long unsigned int ilft</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00266">struct.h:266</a></div></div>
<div class="ttc" id="global_8h_html_a59e163bd798ad16a8c9d47e545e2e42f"><div class="ttname"><a href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a></div><div class="ttdeci">long unsigned int * list_2_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00050">global.h:50</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="global_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="global_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00024">global.h:24</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00048">global.h:48</a></div></div>
<div class="ttc" id="global_8h_html_aac1d1cc6d1099e228cb1f505ef0c86c6"><div class="ttname"><a href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a></div><div class="ttdeci">long unsigned int * list_2_2</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00051">global.h:51</a></div></div>
<div class="ttc" id="struct_large_list_html_ae434b7a485083dd5e96f24a24bc3e9b8"><div class="ttname"><a href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">LargeList::irght</a></div><div class="ttdeci">long unsigned int irght</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00265">struct.h:265</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_cgraph" id="mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="112,5,208,32"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="129,56,191,83"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="256,5,320,32"/>
</map>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_icgraph" id="mltply_hubbard_core_8c_aaf0a9a1a4862be39ce011d0acf118928_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#ac6de5fa85bba8abb6001cea5f4eae19e" title="Compute hopping (canonical) " alt="" coords="522,280,655,307"/>
<area shape="rect" id="node28" href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="112,454,267,495"/>
<area shape="rect" id="node31" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="513,483,664,525"/>
<area shape="rect" id="node3" href="expec__cisajs_8c.html#a7b526b4cb5619bc0908c98c04428ffab" title="expec_cisajs_Hubbard" alt="" coords="730,280,885,307"/>
<area shape="rect" id="node11" href="_pair_ex_hubbard_8c.html#ad6ea48aa669d72fd8cc85162bae8b834" title="GetPairExcitedStateHubbard" alt="" coords="712,109,903,136"/>
<area shape="rect" id="node15" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="754,331,861,357"/>
<area shape="rect" id="node4" href="expec__cisajs_8c.html#aaaa7c9da11d8ae60fe21f1d046358a6c" title="function of calculation for one body green&#39;s function " alt="" coords="1190,477,1289,504"/>
<area shape="rect" id="node5" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1415,275,1529,301"/>
<area shape="rect" id="node7" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1426,477,1518,504"/>
<area shape="rect" id="node8" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1447,376,1497,403"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1773,325,1824,352"/>
<area shape="rect" id="node9" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1609,376,1722,403"/>
<area shape="rect" id="node10" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1605,325,1725,352"/>
<area shape="rect" id="node12" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="951,57,1092,84"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="1413,5,1531,32"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1613,107,1718,133"/>
<area shape="rect" id="node16" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="993,300,1050,327"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1395,56,1549,83"/>
<area shape="rect" id="node18" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="1179,173,1299,200"/>
<area shape="rect" id="node19" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="1175,376,1303,403"/>
<area shape="rect" id="node20" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="1193,579,1286,605"/>
<area shape="rect" id="node21" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="1167,224,1311,251"/>
<area shape="rect" id="node22" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="1165,275,1314,301"/>
<area shape="rect" id="node23" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="1140,107,1339,149"/>
<area shape="rect" id="node26" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1416,325,1528,352"/>
<area shape="rect" id="node27" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="1185,427,1293,453"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1387,107,1557,133"/>
<area shape="rect" id="node25" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1398,157,1546,184"/>
<area shape="rect" id="node29" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="742,494,873,535"/>
<area shape="rect" id="node32" href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="315,425,465,466"/>
<area shape="rect" id="node30" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="1167,528,1311,555"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af29e620c3f3ae1fe39112a747bc1b05d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_AisCis </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Operation of \(t c_{i\sigma} c_{i\sigma}^\dagger\) (Grandcanonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of element of wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Mask for occupation of \((i \sigma)\) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_trans</td><td>Transfer integral </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00261">261</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, and <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>.</p>

<p>Referenced by <a class="el" href="_pair_ex_hubbard_8c_source.html#l00021">GetPairExcitedStateHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> A_ibit_tmp;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  A_ibit_tmp = (list_1_j &amp; is1_spin) / is1_spin;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  dmv = tmp_v1[j] * (1 - A_ibit_tmp);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    tmp_v0[j] += dmv * tmp_trans;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }<span class="comment">/*if (X-&gt;Large.mode == M_MLTPLY || X-&gt;Large.mode == M_CALCSPEC)*/</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  dam_pr = dmv * conj(tmp_v1[j]);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}<span class="comment">/*double complex GC_AisCis*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_af29e620c3f3ae1fe39112a747bc1b05d_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_af29e620c3f3ae1fe39112a747bc1b05d_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_af29e620c3f3ae1fe39112a747bc1b05d_icgraph" id="mltply_hubbard_core_8c_af29e620c3f3ae1fe39112a747bc1b05d_icgraph">
<area shape="rect" id="node2" href="_pair_ex_hubbard_8c.html#aab52ec15363468b5cc7dd30215d889fe" title="GetPairExcitedStateHubbardGC" alt="" coords="141,5,352,32"/>
<area shape="rect" id="node3" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="400,5,541,32"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="589,5,708,32"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="756,5,861,32"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="909,5,960,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a414245ea3f4742224f9d99a0da15a228"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_Ajt </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{jt}\) term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd>
<dd>
Youhei Yamaji (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Bit mask </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l01032">1032</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="wrapper_m_p_i_8h_source.html#l00026">myrank</a>, and <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>.</p>

<p>Referenced by <a class="el" href="_single_ex_hubbard_8c_source.html#l00094">GetSingleExcitedStateHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == is1_spin) {</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// able to create an electron at the is1_spin state</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    list_1_off = list_1_j ^ is1_spin;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    dmv = ipsgn * sgn * tmp_v1[j];</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">//if (X-&gt;Large.mode == M_MLTPLY) { // for multply</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    tmp_v0[list_1_off + 1] += dmv * tmp_V;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    dam_pr = dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}<span class="comment">/*double complex GC_Ajt*/</span></div><div class="ttc" id="wrapper_m_p_i_8h_html_aa8a2431e50f9fc7d8c78af300d5f3bee"><div class="ttname"><a href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdoc">Process ID, defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8h_source.html#l00026">wrapperMPI.h:26</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_cgraph" id="mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="119,5,180,32"/>
</map>
</div>
</p>

<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_icgraph" id="mltply_hubbard_core_8c_a414245ea3f4742224f9d99a0da15a228_icgraph">
<area shape="rect" id="node2" href="_single_ex_hubbard_8c.html#a1402ad7c646461af3781c428888db645" title="GetSingleExcitedStateHubbardGC" alt="" coords="119,5,341,32"/>
<area shape="rect" id="node3" href="_single_ex_8c.html#a43797ff504ab9bf349fdf9f7561d2038" title="GetSingleExcitedState" alt="" coords="640,5,795,32"/>
<area shape="rect" id="node7" href="_single_ex_hubbard_8c.html#a5c47554603676d2da6345b76e562cd4f" title="GetSingleExcitedStateHubbard" alt="" coords="389,31,592,57"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="843,5,961,32"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1009,5,1115,32"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1163,5,1213,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6e5c6a3af522a385b4ee60f66efb2557"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_CisAisCisAis_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{is} c_{is}^\dagger c_{is}\) term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00835">835</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">X_CisAis()</a>.</p>

<p>Referenced by <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00350">expec_cisajscktalt_HubbardGC()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00708">GC_child_general_int()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(j - 1, X, isite3);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(j - 1, X, isite1);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      tmp_v0[j] += dmv;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    dam_pr = conj(tmp_v1[j]) * dmv;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}<span class="comment">/*double complex GC_child_CisAisCisAis_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00289">mltplyHubbardCore.c:289</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_cgraph" id="mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="215,13,292,39"/>
</map>
</div>
</p>

<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_icgraph" id="mltply_hubbard_core_8c_a6e5c6a3af522a385b4ee60f66efb2557_icgraph">
<area shape="rect" id="node2" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="223,362,353,403"/>
<area shape="rect" id="node10" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="215,275,361,301"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="747,5,830,32"/>
<area shape="rect" id="node3" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="717,477,861,504"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="964,325,1079,352"/>
<area shape="rect" id="node6" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="975,465,1067,492"/>
<area shape="rect" id="node7" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="996,401,1047,428"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1323,325,1373,352"/>
<area shape="rect" id="node8" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1158,275,1271,301"/>
<area shape="rect" id="node9" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1155,376,1275,403"/>
<area shape="rect" id="node11" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="409,275,536,301"/>
<area shape="rect" id="node12" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="584,275,641,301"/>
<area shape="rect" id="node13" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="945,56,1098,83"/>
<area shape="rect" id="node15" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="729,224,849,251"/>
<area shape="rect" id="node16" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="725,427,853,453"/>
<area shape="rect" id="node17" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="742,528,835,555"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="717,275,861,301"/>
<area shape="rect" id="node19" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="714,325,863,352"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="689,107,888,149"/>
<area shape="rect" id="node23" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="965,267,1077,293"/>
<area shape="rect" id="node24" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="735,376,843,403"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1162,107,1267,133"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="936,208,1107,235"/>
<area shape="rect" id="node22" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="947,107,1095,133"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="937,5,1106,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a389f0d9543e02b5d2e19df0198bafc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_CisAisCjtAku_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bsum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{is} c_{jt}^\dagger c_{ku}\) term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite4</td><td>Site 4 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bsum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bdiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00866">866</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">X_CisAis()</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00432">X_GC_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00350">expec_cisajscktalt_HubbardGC()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00708">GC_child_general_int()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>((j - 1), X, isite3, isite4, Bsum, Bdiff, tmp_off);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>(*tmp_off, X, isite1);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        tmp_v0[*tmp_off + 1] += dmv;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off + 1]) * dmv;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}<span class="comment">/*double complex GC_child_CisAisCjtAku_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00289">mltplyHubbardCore.c:289</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a0af550e9f9e1443323aba1b18cc35be0"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a></div><div class="ttdeci">int X_GC_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00432">mltplyHubbardCore.c:432</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_cgraph" id="mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="228,5,305,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="216,56,317,83"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="365,56,427,83"/>
</map>
</div>
</p>

<p><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_icgraph" id="mltply_hubbard_core_8c_a5a389f0d9543e02b5d2e19df0198bafc_icgraph">
<area shape="rect" id="node2" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="224,362,355,403"/>
<area shape="rect" id="node10" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="216,275,363,301"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="749,5,831,32"/>
<area shape="rect" id="node3" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="718,477,862,504"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="965,325,1080,352"/>
<area shape="rect" id="node6" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="977,465,1069,492"/>
<area shape="rect" id="node7" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="997,401,1048,428"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1324,325,1375,352"/>
<area shape="rect" id="node8" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1159,275,1273,301"/>
<area shape="rect" id="node9" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1156,376,1276,403"/>
<area shape="rect" id="node11" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="411,275,537,301"/>
<area shape="rect" id="node12" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="585,275,643,301"/>
<area shape="rect" id="node13" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="946,56,1099,83"/>
<area shape="rect" id="node15" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="730,224,850,251"/>
<area shape="rect" id="node16" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="726,427,854,453"/>
<area shape="rect" id="node17" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="743,528,837,555"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="718,275,862,301"/>
<area shape="rect" id="node19" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="715,325,865,352"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="691,107,889,149"/>
<area shape="rect" id="node23" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="967,267,1079,293"/>
<area shape="rect" id="node24" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="736,376,844,403"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1163,107,1269,133"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="937,208,1108,235"/>
<area shape="rect" id="node22" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="949,107,1097,133"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="938,5,1107,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab7d585bf30bbcee8449b8c54d0bb128e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_CisAjtCkuAku_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Asum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Adiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{ku}\) term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite2</td><td>Site 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Adiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00902">902</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">X_CisAis()</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00432">X_GC_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00350">expec_cisajscktalt_HubbardGC()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00708">GC_child_general_int()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a>((j - 1), X, isite3);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>((j - 1), X, isite1, isite2, Asum, Adiff, tmp_off);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        tmp_v0[*tmp_off + 1] += dmv;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off + 1]) * dmv;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }<span class="comment">/*if (tmp_sgn != 0)*/</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  }<span class="comment">/*if (tmp_sgn != 0)*/</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}<span class="comment">/*double complex GC_child_CisAjtCkuAku_element*/</span></div><div class="ttc" id="mltply_hubbard_core_8c_html_aa81e90673aeb377803302428fe3c7b64"><div class="ttname"><a href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64">X_CisAis</a></div><div class="ttdeci">int X_CisAis(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin)</div><div class="ttdoc"> term in Hubbard (canonical) </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00289">mltplyHubbardCore.c:289</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a0af550e9f9e1443323aba1b18cc35be0"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a></div><div class="ttdeci">int X_GC_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00432">mltplyHubbardCore.c:432</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_cgraph" id="mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#aa81e90673aeb377803302428fe3c7b64" title=" term in Hubbard (canonical) " alt="" coords="232,5,309,32"/>
<area shape="rect" id="node3" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="220,56,321,83"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="369,56,431,83"/>
</map>
</div>
</p>

<p><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_icgraph" id="mltply_hubbard_core_8c_ab7d585bf30bbcee8449b8c54d0bb128e_icgraph">
<area shape="rect" id="node2" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="228,362,359,403"/>
<area shape="rect" id="node10" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="220,275,367,301"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="753,5,835,32"/>
<area shape="rect" id="node3" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="722,477,866,504"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="969,325,1084,352"/>
<area shape="rect" id="node6" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="981,465,1073,492"/>
<area shape="rect" id="node7" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1001,401,1052,428"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1328,325,1379,352"/>
<area shape="rect" id="node8" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1163,275,1277,301"/>
<area shape="rect" id="node9" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1160,376,1280,403"/>
<area shape="rect" id="node11" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="415,275,541,301"/>
<area shape="rect" id="node12" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="589,275,647,301"/>
<area shape="rect" id="node13" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="950,56,1103,83"/>
<area shape="rect" id="node15" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="734,224,854,251"/>
<area shape="rect" id="node16" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="730,427,858,453"/>
<area shape="rect" id="node17" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="747,528,841,555"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="722,275,866,301"/>
<area shape="rect" id="node19" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="719,325,869,352"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="695,107,893,149"/>
<area shape="rect" id="node23" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="971,267,1083,293"/>
<area shape="rect" id="node24" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="740,376,848,403"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1167,107,1273,133"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="941,208,1112,235"/>
<area shape="rect" id="node22" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="953,107,1101,133"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="942,5,1111,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6d06655a28258eea84191579396219e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_CisAjtCkuAlv_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>isite4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Asum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Adiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bsum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>Bdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off_2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger c_{jt} c_{ku}^\dagger c_{lv}\) term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite1</td><td>Site 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite2</td><td>Site 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite3</td><td>Site 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isite4</td><td>Site 4 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Adiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bsum</td><td>Bit mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Bdiff</td><td>Bit mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off_2</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00938">938</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00432">X_GC_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00350">expec_cisajscktalt_HubbardGC()</a>, <a class="el" href="mltply_hubbard_8c_source.html#l00708">GC_child_general_int()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_1;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  tmp_sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>((j - 1), X, isite3, isite4, Bsum, Bdiff, &amp;tmp_off_1);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    tmp_sgn *= <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(tmp_off_1, X, isite1, isite2, Asum, Adiff, tmp_off_2);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> (tmp_sgn != 0) {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      dmv = tmp_V * tmp_v1[j] * tmp_sgn;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        tmp_v0[*tmp_off_2 + 1] += dmv;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      dam_pr = conj(tmp_v1[*tmp_off_2 + 1]) * dmv;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;}<span class="comment">/*double complex GC_child_CisAjtCkuAlv_element*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a0af550e9f9e1443323aba1b18cc35be0"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a></div><div class="ttdeci">int X_GC_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00432">mltplyHubbardCore.c:432</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_cgraph" id="mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_cgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="216,13,317,39"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="365,13,427,39"/>
</map>
</div>
</p>

<p><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_icgraph" id="mltply_hubbard_core_8c_a6d06655a28258eea84191579396219e1_icgraph">
<area shape="rect" id="node2" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="224,362,355,403"/>
<area shape="rect" id="node10" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="216,275,363,301"/>
<area shape="rect" id="node25" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="749,5,831,32"/>
<area shape="rect" id="node3" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="718,477,862,504"/>
<area shape="rect" id="node4" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="965,325,1080,352"/>
<area shape="rect" id="node6" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="977,465,1069,492"/>
<area shape="rect" id="node7" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="997,401,1048,428"/>
<area shape="rect" id="node5" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1324,325,1375,352"/>
<area shape="rect" id="node8" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1159,275,1273,301"/>
<area shape="rect" id="node9" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1156,376,1276,403"/>
<area shape="rect" id="node11" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="411,275,537,301"/>
<area shape="rect" id="node12" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="585,275,643,301"/>
<area shape="rect" id="node13" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="946,56,1099,83"/>
<area shape="rect" id="node15" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="730,224,850,251"/>
<area shape="rect" id="node16" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="726,427,854,453"/>
<area shape="rect" id="node17" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="743,528,837,555"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="718,275,862,301"/>
<area shape="rect" id="node19" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="715,325,865,352"/>
<area shape="rect" id="node20" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="691,107,889,149"/>
<area shape="rect" id="node23" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="967,267,1079,293"/>
<area shape="rect" id="node24" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="736,376,844,403"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1163,107,1269,133"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="937,208,1108,235"/>
<area shape="rect" id="node22" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="949,107,1097,133"/>
<area shape="rect" id="node26" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="938,5,1107,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85a5f403eb683e5ebee4ab40a8a390e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_exchange_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute exchange term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00583">583</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00248">LargeList::is1_down</a>, <a class="el" href="struct_8h_source.html#l00247">LargeList::is1_up</a>, <a class="el" href="struct_8h_source.html#l00250">LargeList::is2_down</a>, <a class="el" href="struct_8h_source.html#l00249">LargeList::is2_up</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="struct_8h_source.html#l00245">LargeList::tmp_J</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00791">GC_child_exchange()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  ibit1_up = list_1_j &amp; is1_up;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  ibit2_up = list_1_j &amp; is2_up;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  ibit1_down = list_1_j &amp; is1_down;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  ibit2_down = list_1_j &amp; is2_down;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down != 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down == 0) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    iexchg = list_1_j - (is1_down + is2_up);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    iexchg += (is1_up + is2_down);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    list_1_off = iexchg;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      tmp_v0[list_1_off + 1] += dmv;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    dam_pr += dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ibit1_up != 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up == 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    iexchg = list_1_j - (is1_up + is2_down);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    iexchg += (is1_down + is2_up);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    list_1_off = iexchg;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      tmp_v0[list_1_off + 1] += dmv;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    dam_pr += dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}<span class="comment">/*double complex GC_child_exchange_element*/</span></div><div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00249">struct.h:249</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00245">struct.h:245</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00250">struct.h:250</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00247">struct.h:247</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00248">struct.h:248</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a85a5f403eb683e5ebee4ab40a8a390e5_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a85a5f403eb683e5ebee4ab40a8a390e5_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a85a5f403eb683e5ebee4ab40a8a390e5_icgraph" id="mltply_hubbard_core_8c_a85a5f403eb683e5ebee4ab40a8a390e5_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a23af00b3160b075156e1c842bb3a879d" title="Compute Exchange term (grandcanonical) in single process. " alt="" coords="245,215,384,241"/>
<area shape="rect" id="node23" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="770,107,853,133"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="432,253,559,280"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="607,291,664,317"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="967,157,1121,184"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="751,512,871,539"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="747,259,875,285"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="765,208,858,235"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="739,461,883,488"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="737,411,886,437"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="712,41,911,82"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="988,360,1100,387"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="757,309,865,336"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1185,107,1290,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1345,259,1396,285"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="987,411,1101,437"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="998,259,1090,285"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1019,309,1069,336"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1181,208,1294,235"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1177,309,1297,336"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="959,56,1129,83"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="970,5,1118,32"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="959,107,1129,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab45a0a7e963c4c9d2d4bfa86ca5c44b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_child_pairhopp_element </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute pairhopp term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00641">641</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00248">LargeList::is1_down</a>, <a class="el" href="struct_8h_source.html#l00247">LargeList::is1_up</a>, <a class="el" href="struct_8h_source.html#l00250">LargeList::is2_down</a>, <a class="el" href="struct_8h_source.html#l00249">LargeList::is2_up</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="struct_8h_source.html#l00245">LargeList::tmp_J</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00769">GC_child_pairhopp()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up, ibit2_up, ibit1_down, ibit2_down;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">is1_up</a>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_up = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">is2_up</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">is1_down</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is2_down = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">is2_down</a>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordtype">double</span> complex tmp_J = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">tmp_J</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordtype">int</span> mode = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordtype">double</span> complex dam_pr = 0 + 0 * I;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  ibit1_up = list_1_j &amp; is1_up;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  ibit2_up = list_1_j &amp; is2_up;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  ibit1_down = list_1_j &amp; is1_down;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  ibit2_down = list_1_j &amp; is2_down;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">if</span> (ibit1_up == 0 &amp;&amp; ibit1_down == 0 &amp;&amp; ibit2_up != 0 &amp;&amp; ibit2_down != 0) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    iexchg = list_1_j - (is2_up + is2_down);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    iexchg += (is1_up + is1_down);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    list_1_off = iexchg;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    dmv = tmp_J * tmp_v1[j];</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (mode == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      tmp_v0[list_1_off + 1] += dmv;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    dam_pr += dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div><div class="ttc" id="struct_large_list_html_a652c1dca60b7624974f649e0dcec75c4"><div class="ttname"><a href="struct_large_list.html#a652c1dca60b7624974f649e0dcec75c4">LargeList::is2_up</a></div><div class="ttdeci">long unsigned int is2_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00249">struct.h:249</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="struct_large_list_html_ac7c192a654ea52b3b7d84c211f2b7f4f"><div class="ttname"><a href="struct_large_list.html#ac7c192a654ea52b3b7d84c211f2b7f4f">LargeList::tmp_J</a></div><div class="ttdeci">double complex tmp_J</div><div class="ttdoc">Coupling constant. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00245">struct.h:245</a></div></div>
<div class="ttc" id="struct_large_list_html_a1dd7945c1bba2b24d6b5a7eafcbd563d"><div class="ttname"><a href="struct_large_list.html#a1dd7945c1bba2b24d6b5a7eafcbd563d">LargeList::is2_down</a></div><div class="ttdeci">long unsigned int is2_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00250">struct.h:250</a></div></div>
<div class="ttc" id="struct_large_list_html_a16e7cecab631ea06d5cbb8cf89981a76"><div class="ttname"><a href="struct_large_list.html#a16e7cecab631ea06d5cbb8cf89981a76">LargeList::is1_up</a></div><div class="ttdeci">long unsigned int is1_up</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00247">struct.h:247</a></div></div>
<div class="ttc" id="struct_large_list_html_a3383562f01be9dad6983b25c206439cf"><div class="ttname"><a href="struct_large_list.html#a3383562f01be9dad6983b25c206439cf">LargeList::is1_down</a></div><div class="ttdeci">long unsigned int is1_down</div><div class="ttdoc">Mask used in the bit oeration. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00248">struct.h:248</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_ab45a0a7e963c4c9d2d4bfa86ca5c44b8_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_ab45a0a7e963c4c9d2d4bfa86ca5c44b8_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_ab45a0a7e963c4c9d2d4bfa86ca5c44b8_icgraph" id="mltply_hubbard_core_8c_ab45a0a7e963c4c9d2d4bfa86ca5c44b8_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#ad16f7b63b9768957a720004697a7a774" title="Compute pairhopp term (grandcanonical) " alt="" coords="239,215,371,241"/>
<area shape="rect" id="node23" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="757,107,839,133"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="419,253,545,280"/>
<area shape="rect" id="node4" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="593,291,651,317"/>
<area shape="rect" id="node5" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="954,157,1107,184"/>
<area shape="rect" id="node8" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="738,512,858,539"/>
<area shape="rect" id="node10" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="734,259,862,285"/>
<area shape="rect" id="node15" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="751,208,845,235"/>
<area shape="rect" id="node16" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="726,461,870,488"/>
<area shape="rect" id="node17" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="723,411,873,437"/>
<area shape="rect" id="node18" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="699,41,897,82"/>
<area shape="rect" id="node21" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="975,360,1087,387"/>
<area shape="rect" id="node22" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="744,309,852,336"/>
<area shape="rect" id="node6" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1171,107,1277,133"/>
<area shape="rect" id="node7" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1332,259,1383,285"/>
<area shape="rect" id="node9" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="973,411,1088,437"/>
<area shape="rect" id="node11" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="985,259,1077,285"/>
<area shape="rect" id="node12" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1005,309,1056,336"/>
<area shape="rect" id="node13" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1167,208,1281,235"/>
<area shape="rect" id="node14" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1164,309,1284,336"/>
<area shape="rect" id="node19" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="945,56,1116,83"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="957,5,1105,32"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="946,107,1115,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a82057cd7316bca01585868207301cf39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_Cis </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute \(c_{is}^\dagger\) term of grandcanonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1 | H_{\rm this} | v_1 \rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd>
<dd>
Youhei Yamaji (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v0</td><td>Resulting wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Wavefunction to be multiplied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Bit mask </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Coupling constant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00981">981</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="wrapper_m_p_i_8h_source.html#l00026">myrank</a>, and <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>.</p>

<p>Referenced by <a class="el" href="_single_ex_hubbard_8c_source.html#l00094">GetSingleExcitedStateHubbardGC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// is1_spin = Tpow[2*isite + ispin]</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">// able to create an electron at the is1_spin state</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    list_1_off = list_1_j | is1_spin; <span class="comment">// OR</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    dmv = ipsgn * sgn * tmp_v1[j];</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">//if (X-&gt;Large.mode == M_MLTPLY) { // for multply</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    tmp_v0[list_1_off + 1] += dmv * tmp_V;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    dam_pr = dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}<span class="comment">/*double complex GC_Cis*/</span></div><div class="ttc" id="wrapper_m_p_i_8h_html_aa8a2431e50f9fc7d8c78af300d5f3bee"><div class="ttname"><a href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdoc">Process ID, defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8h_source.html#l00026">wrapperMPI.h:26</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_cgraph" id="mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="123,5,184,32"/>
</map>
</div>
</p>

<p><div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_icgraph" id="mltply_hubbard_core_8c_a82057cd7316bca01585868207301cf39_icgraph">
<area shape="rect" id="node2" href="_single_ex_hubbard_8c.html#a1402ad7c646461af3781c428888db645" title="GetSingleExcitedStateHubbardGC" alt="" coords="123,5,345,32"/>
<area shape="rect" id="node3" href="_single_ex_8c.html#a43797ff504ab9bf349fdf9f7561d2038" title="GetSingleExcitedState" alt="" coords="644,5,799,32"/>
<area shape="rect" id="node7" href="_single_ex_hubbard_8c.html#a5c47554603676d2da6345b76e562cd4f" title="GetSingleExcitedStateHubbard" alt="" coords="393,31,596,57"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="847,5,965,32"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1013,5,1119,32"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1167,5,1217,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf3b726a0fbe639a2b7169210c3a24c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_CisAis </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Operation of \(t c_{i\sigma}^\dagger c_{i\sigma}\) (Grandcanonical) </p>
<dl class="section return"><dt>Returns</dt><dd>Fragment of \(\langle v_1|{\hat H}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of element of wavefunction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmp_v0</td><td>Result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Input producted vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Mask for occupation of \((i \sigma)\) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_trans</td><td>Transfer integral </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00234">234</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, and <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00609">GC_child_general_hopp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> A_ibit_tmp;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  A_ibit_tmp = (list_1_j &amp; is1_spin) / is1_spin;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  dmv = tmp_v1[j] * A_ibit_tmp;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    tmp_v0[j] += dmv * tmp_trans;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }<span class="comment">/*if (X-&gt;Large.mode == M_MLTPLY || X-&gt;Large.mode == M_CALCSPEC)*/</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  dam_pr = dmv * conj(tmp_v1[j]);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}<span class="comment">/*double complex GC_CisAis*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_acf3b726a0fbe639a2b7169210c3a24c4_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_acf3b726a0fbe639a2b7169210c3a24c4_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_acf3b726a0fbe639a2b7169210c3a24c4_icgraph" id="mltply_hubbard_core_8c_acf3b726a0fbe639a2b7169210c3a24c4_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70" title="Commpute hopping term (grandcanonical) " alt="" coords="141,261,301,288"/>
<area shape="rect" id="node3" href="expec__cisajs_8c.html#a0d30174954dc8ad83ceeba5932ece811" title="expec_cisajs_HubbardGC" alt="" coords="367,135,542,161"/>
<area shape="rect" id="node11" href="_pair_ex_hubbard_8c.html#aab52ec15363468b5cc7dd30215d889fe" title="GetPairExcitedStateHubbardGC" alt="" coords="349,367,560,393"/>
<area shape="rect" id="node15" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="391,261,518,288"/>
<area shape="rect" id="node4" href="expec__cisajs_8c.html#aaaa7c9da11d8ae60fe21f1d046358a6c" title="function of calculation for one body green&#39;s function " alt="" coords="847,59,946,85"/>
<area shape="rect" id="node5" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1072,249,1187,276"/>
<area shape="rect" id="node7" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1083,173,1175,200"/>
<area shape="rect" id="node8" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1104,92,1155,119"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1431,184,1481,211"/>
<area shape="rect" id="node9" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1266,133,1379,160"/>
<area shape="rect" id="node10" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1263,83,1383,109"/>
<area shape="rect" id="node12" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="608,421,749,448"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="1070,531,1189,557"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1270,429,1375,456"/>
<area shape="rect" id="node16" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="650,261,707,288"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1053,480,1206,507"/>
<area shape="rect" id="node18" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="837,261,957,288"/>
<area shape="rect" id="node19" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="833,109,961,136"/>
<area shape="rect" id="node20" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="850,211,943,237"/>
<area shape="rect" id="node21" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="825,312,969,339"/>
<area shape="rect" id="node22" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="822,363,971,389"/>
<area shape="rect" id="node23" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="797,414,996,455"/>
<area shape="rect" id="node26" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1073,16,1185,43"/>
<area shape="rect" id="node27" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="843,160,951,187"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1044,379,1215,405"/>
<area shape="rect" id="node25" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1055,429,1203,456"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a257628b6ed79f7a93d3d2a9a957bc936"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex GC_CisAjt </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>tmp_v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is2_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sum_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>diff_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex&#160;</td>
          <td class="paramname"><em>tmp_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\(c_{is}^\dagger c_{jt}\) term for grandcanonical Hubbard </p>
<dl class="section return"><dt>Returns</dt><dd>\(\langle v_1|{\hat H}_{\rm this}|v_1\rangle\) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v0</td><td>\(v_0 = H v_1\) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_v1</td><td>Vector to be producted </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Mask for occupation of (is) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is2_spin</td><td>Mask for occupation of (jt) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sum_spin</td><td>Mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diff_spin</td><td>Mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_V</td><td>Hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_off</td><td>Index of wavefunction of final state </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00355">355</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="struct_8h_source.html#l00252">LargeList::mode</a>, and <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_8c_source.html#l00609">GC_child_general_hopp()</a>, <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00341">X_GC_child_CisAjtCkuAku_Hubbard_MPI()</a>, and <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00535">X_GC_child_CisAjtCkuAlv_Hubbard_MPI()</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1, ibit_tmp_2;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordtype">int</span> sgn;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">double</span> complex dmv, dam_pr;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  list_1_j = j - 1;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  ibit_tmp_2 = (list_1_j &amp; is2_spin);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0 &amp;&amp; ibit_tmp_2 != 0) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    bit = list_1_j &amp; diff_spin;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    list_1_off = list_1_j ^ sum_spin;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    *tmp_off = list_1_off;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    dmv = sgn * tmp_v1[j];</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_MLTPLY || X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a> == M_CALCSPEC) { <span class="comment">// for multply</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      tmp_v0[list_1_off + 1] += dmv * tmp_V;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    dam_pr = dmv * conj(tmp_v1[list_1_off + 1]);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> dam_pr;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}<span class="comment">/*double complex GC_CisAjt*/</span></div><div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">multiply or expectation value. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00252">struct.h:252</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-35" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_cgraph" id="mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="139,5,200,32"/>
</map>
</div>
</p>

<p><div id="dynsection-36" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_icgraph" id="mltply_hubbard_core_8c_a257628b6ed79f7a93d3d2a9a957bc936_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_8c.html#a59f11fc0359c4543168c6a6f61a1ec70" title="Commpute hopping term (grandcanonical) " alt="" coords="605,383,765,410"/>
<area shape="rect" id="node28" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="1329,576,1411,603"/>
<area shape="rect" id="node30" href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="139,224,321,265"/>
<area shape="rect" id="node34" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="596,165,775,206"/>
<area shape="rect" id="node3" href="expec__cisajs_8c.html#a0d30174954dc8ad83ceeba5932ece811" title="expec_cisajs_HubbardGC" alt="" coords="841,371,1015,398"/>
<area shape="rect" id="node11" href="_pair_ex_hubbard_8c.html#aab52ec15363468b5cc7dd30215d889fe" title="GetPairExcitedStateHubbardGC" alt="" coords="823,584,1033,611"/>
<area shape="rect" id="node15" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="865,307,991,334"/>
<area shape="rect" id="node4" href="expec__cisajs_8c.html#aaaa7c9da11d8ae60fe21f1d046358a6c" title="function of calculation for one body green&#39;s function " alt="" coords="1321,155,1419,182"/>
<area shape="rect" id="node5" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1545,231,1660,258"/>
<area shape="rect" id="node7" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1557,130,1649,156"/>
<area shape="rect" id="node8" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1577,180,1628,207"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1904,231,1955,258"/>
<area shape="rect" id="node9" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1739,282,1853,308"/>
<area shape="rect" id="node10" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1736,180,1856,207"/>
<area shape="rect" id="node12" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="1081,606,1223,632"/>
<area shape="rect" id="node13" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="1543,627,1662,654"/>
<area shape="rect" id="node14" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1743,475,1849,502"/>
<area shape="rect" id="node16" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="1123,307,1181,334"/>
<area shape="rect" id="node17" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1526,526,1679,552"/>
<area shape="rect" id="node18" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="1310,307,1430,334"/>
<area shape="rect" id="node19" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="1306,206,1434,232"/>
<area shape="rect" id="node20" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="1323,54,1417,80"/>
<area shape="rect" id="node21" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="1298,358,1442,384"/>
<area shape="rect" id="node22" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="1295,408,1445,435"/>
<area shape="rect" id="node23" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="1271,460,1469,501"/>
<area shape="rect" id="node26" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1547,28,1659,55"/>
<area shape="rect" id="node27" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="1316,256,1424,283"/>
<area shape="rect" id="node24" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1517,424,1688,451"/>
<area shape="rect" id="node25" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1529,374,1677,400"/>
<area shape="rect" id="node29" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="1518,576,1687,603"/>
<area shape="rect" id="node31" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="863,136,993,177"/>
<area shape="rect" id="node33" href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="369,224,548,265"/>
<area shape="rect" id="node32" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="1298,104,1442,131"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae302b1f2124063034b348974c361f966"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex X_Ajt </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>list_1_org</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>list_2_1_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>list_2_2_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>_irght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>_ilft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>_ihfbit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute index of final wavefunction associatesd to \(c_{jt}\) term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>1 if electron (jt) exist, 0 if not. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd>
<dd>
Youhei Yamaji (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Bit mask </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list_1_org</td><td>Similar to <a class="el" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list_2_1_target</td><td>Similar to <a class="el" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list_2_2_target</td><td>Similar to <a class="el" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">_irght</td><td>Similar to <a class="el" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8" title="Used for Ogata-Lin ??? ">LargeList::irght</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">_ilft</td><td>Similar to <a class="el" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab" title="Used for Ogata-Lin ??? ">LargeList::ilft</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">_ihfbit</td><td>Similar to <a class="el" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c" title="Used for Ogata-Lin ??? ">LargeList::ihfbit</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l01136">1136</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="bitcalc_8c_source.html#l00195">GetOffComp()</a>, <a class="el" href="wrapper_m_p_i_8h_source.html#l00026">myrank</a>, <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>, and <a class="el" href="global_8h_source.html#l00025">TRUE</a>.</p>

<p>Referenced by <a class="el" href="_single_ex_hubbard_8c_source.html#l00019">GetSingleExcitedStateHubbard()</a>.</p>
<div class="fragment"><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  list_1_j = <a class="code" href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a>[j];</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">// is1_spin = Tpow[2*isite + ispin]</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 != 0) {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// able to delete an electron at the is1_spin state</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    list_1_off = list_1_j ^ is1_spin;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(list_2_1_target, list_2_2_target, list_1_off, _irght, _ilft, _ihfbit, tmp_off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      *tmp_off=0;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    }</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    sgn *= ipsgn;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">return</span>(sgn);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  }</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;}<span class="comment">/*double complex X_Ajt*/</span></div><div class="ttc" id="wrapper_m_p_i_8h_html_aa8a2431e50f9fc7d8c78af300d5f3bee"><div class="ttname"><a href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdoc">Process ID, defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8h_source.html#l00026">wrapperMPI.h:26</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="global_8h_html_a1e2e45bf7e1194670acdd42d8616ccac"><div class="ttname"><a href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a></div><div class="ttdeci">long unsigned int * list_1_org</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00058">global.h:58</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-37" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_cgraph" id="mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="108,5,204,32"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="125,56,187,83"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="252,5,316,32"/>
</map>
</div>
</p>

<p><div id="dynsection-38" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_icgraph" id="mltply_hubbard_core_8c_ae302b1f2124063034b348974c361f966_icgraph">
<area shape="rect" id="node2" href="_single_ex_hubbard_8c.html#a5c47554603676d2da6345b76e562cd4f" title="GetSingleExcitedStateHubbard" alt="" coords="108,5,311,32"/>
<area shape="rect" id="node3" href="_single_ex_8c.html#a43797ff504ab9bf349fdf9f7561d2038" title="GetSingleExcitedState" alt="" coords="359,5,513,32"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="561,5,680,32"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="728,5,833,32"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="881,5,932,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f49b75c63d21a51d25b3d414a759be7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X_Cis </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>list_1_org</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>list_2_1_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>list_2_2_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>_irght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>_ilft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>_ihfbit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute index of final wavefunction associatesd to \(c_{is}^\dagger\) term of canonical Hubbard system. </p>
<dl class="section return"><dt>Returns</dt><dd>1 if electron (is) absent, 0 if not. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd>
<dd>
Youhei Yamaji (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Index of initial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Bit mask </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of final wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list_1_org</td><td>Similar to <a class="el" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list_2_1_target</td><td>Similar to <a class="el" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list_2_2_target</td><td>Similar to <a class="el" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">_irght</td><td>Similar to <a class="el" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8" title="Used for Ogata-Lin ??? ">LargeList::irght</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">_ilft</td><td>Similar to <a class="el" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab" title="Used for Ogata-Lin ??? ">LargeList::ilft</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">_ihfbit</td><td>Similar to <a class="el" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c" title="Used for Ogata-Lin ??? ">LargeList::ihfbit</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l01082">1082</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="bitcalc_8c_source.html#l00195">GetOffComp()</a>, <a class="el" href="wrapper_m_p_i_8h_source.html#l00026">myrank</a>, <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>, and <a class="el" href="global_8h_source.html#l00025">TRUE</a>.</p>

<p>Referenced by <a class="el" href="_single_ex_hubbard_8c_source.html#l00019">GetSingleExcitedStateHubbard()</a>.</p>
<div class="fragment"><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  {</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> list_1_j, list_1_off;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordtype">int</span> sgn, ipsgn;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  list_1_j = <a class="code" href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a>[j];</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// is1_spin &gt;= 1</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// is1_spin = Tpow[2*isite + ispin]</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  *tmp_off = 0;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// able to create an electron at the is1_spin state</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    bit = list_1_j - (list_1_j &amp; (2 * is1_spin - 1));</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    ipsgn = 1;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="preprocessor">#ifdef MPI</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(<a class="code" href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a>, &amp;ipsgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    list_1_off = list_1_j | is1_spin; <span class="comment">// OR</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(list_2_1_target, list_2_2_target, list_1_off, _irght, _ilft, _ihfbit, tmp_off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      *tmp_off=0;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    sgn *= ipsgn;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">return</span> (sgn);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  }</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  }</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;}<span class="comment">/*int X_Cis*/</span></div><div class="ttc" id="wrapper_m_p_i_8h_html_aa8a2431e50f9fc7d8c78af300d5f3bee"><div class="ttname"><a href="wrapper_m_p_i_8h.html#aa8a2431e50f9fc7d8c78af300d5f3bee">myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdoc">Process ID, defined in InitializeMPI() </div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8h_source.html#l00026">wrapperMPI.h:26</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="global_8h_html_a1e2e45bf7e1194670acdd42d8616ccac"><div class="ttname"><a href="global_8h.html#a1e2e45bf7e1194670acdd42d8616ccac">list_1_org</a></div><div class="ttdeci">long unsigned int * list_1_org</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00058">global.h:58</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-39" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_cgraph" id="mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="112,5,208,32"/>
<area shape="rect" id="node4" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="129,56,191,83"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="256,5,320,32"/>
</map>
</div>
</p>

<p><div id="dynsection-40" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_icgraph" id="mltply_hubbard_core_8c_a3f49b75c63d21a51d25b3d414a759be7_icgraph">
<area shape="rect" id="node2" href="_single_ex_hubbard_8c.html#a5c47554603676d2da6345b76e562cd4f" title="GetSingleExcitedStateHubbard" alt="" coords="112,5,315,32"/>
<area shape="rect" id="node3" href="_single_ex_8c.html#a43797ff504ab9bf349fdf9f7561d2038" title="GetSingleExcitedState" alt="" coords="363,5,517,32"/>
<area shape="rect" id="node4" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="565,5,684,32"/>
<area shape="rect" id="node5" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="732,5,837,32"/>
<area shape="rect" id="node6" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="885,5,936,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa81e90673aeb377803302428fe3c7b64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X_CisAis </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>list_1_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\(c_{is}\\dagger c_{is}\) term in Hubbard (canonical) </p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00289">289</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_core_8c_source.html#l00690">child_CisAisCisAis_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00719">child_CisAisCjtAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00755">child_CisAjtCkuAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00835">GC_child_CisAisCisAis_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00866">GC_child_CisAisCjtAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00902">GC_child_CisAjtCkuAku_element()</a>, and <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l01315">X_child_CisAis_Hubbard_MPI()</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordtype">int</span> A_ibit_tmp;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// off = j</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  A_ibit_tmp = (list_1_j &amp; is1_spin) / is1_spin;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">return</span> A_ibit_tmp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div></div><!-- fragment -->
<p><div id="dynsection-41" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_aa81e90673aeb377803302428fe3c7b64_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_aa81e90673aeb377803302428fe3c7b64_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_aa81e90673aeb377803302428fe3c7b64_icgraph" id="mltply_hubbard_core_8c_aa81e90673aeb377803302428fe3c7b64_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a11e78b661246513350ad6ee2e3985d9f" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="163,576,297,617"/>
<area shape="rect" id="node28" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="163,641,297,682"/>
<area shape="rect" id="node29" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="161,706,299,748"/>
<area shape="rect" id="node30" href="mltply_hubbard_core_8c.html#a6e5c6a3af522a385b4ee60f66efb2557" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="149,445,311,486"/>
<area shape="rect" id="node34" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="149,510,311,552"/>
<area shape="rect" id="node35" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="147,380,313,421"/>
<area shape="rect" id="node36" href="mltply_m_p_i_hubbard_core_8c.html#ac2399f2f6269841904d827a67af2c2f5" title="X_child_CisAis_Hubbard_MPI" alt="" coords="131,776,329,803"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="393,670,512,696"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="576,636,707,677"/>
<area shape="rect" id="node26" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="411,518,494,544"/>
<area shape="rect" id="node4" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="588,702,695,728"/>
<area shape="rect" id="node5" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="811,331,868,358"/>
<area shape="rect" id="node6" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1227,163,1381,190"/>
<area shape="rect" id="node9" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="1011,280,1131,307"/>
<area shape="rect" id="node11" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="1007,432,1135,459"/>
<area shape="rect" id="node16" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="1025,483,1118,510"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="999,179,1143,206"/>
<area shape="rect" id="node18" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="997,230,1146,256"/>
<area shape="rect" id="node19" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="972,62,1171,104"/>
<area shape="rect" id="node22" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1248,331,1360,358"/>
<area shape="rect" id="node23" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="1017,382,1125,408"/>
<area shape="rect" id="node7" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1445,112,1550,139"/>
<area shape="rect" id="node8" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1605,331,1656,358"/>
<area shape="rect" id="node10" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1247,280,1361,307"/>
<area shape="rect" id="node12" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1258,483,1350,510"/>
<area shape="rect" id="node13" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1279,432,1329,459"/>
<area shape="rect" id="node14" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1441,432,1554,459"/>
<area shape="rect" id="node15" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1437,331,1557,358"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1219,62,1389,88"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1230,112,1378,139"/>
<area shape="rect" id="node25" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="999,534,1143,560"/>
<area shape="rect" id="node27" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="755,146,924,172"/>
<area shape="rect" id="node31" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="387,449,518,490"/>
<area shape="rect" id="node32" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="379,392,526,419"/>
<area shape="rect" id="node33" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="578,350,705,376"/>
<area shape="rect" id="node37" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="377,772,528,813"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a576edff50809bed2a8ac5016b54027a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X_CisAjt </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>list_1_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is2_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sum_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>diff_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute index of wavefunction of final state. </p>
<dl class="section return"><dt>Returns</dt><dd>Fermion sign </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">list_1_j</td><td>Similer to <a class="el" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a> ? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Mask for occupation of (is) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is2_spin</td><td>Mask for occupation of (jt) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sum_spin</td><td>Mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diff_spin</td><td>Mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmp_off</td><td>Index of wavefunction of final state </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00400">400</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="bitcalc_8c_source.html#l00195">GetOffComp()</a>, <a class="el" href="struct_8h_source.html#l00267">LargeList::ihfbit</a>, <a class="el" href="struct_8h_source.html#l00266">LargeList::ilft</a>, <a class="el" href="struct_8h_source.html#l00265">LargeList::irght</a>, <a class="el" href="struct_8h_source.html#l00334">BindStruct::Large</a>, <a class="el" href="global_8h_source.html#l00050">list_2_1</a>, <a class="el" href="global_8h_source.html#l00051">list_2_2</a>, <a class="el" href="global_8h_source.html#l00025">TRUE</a>, and <a class="el" href="mltply_hubbard_core_8c_source.html#l00432">X_GC_CisAjt()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_core_8c_source.html#l00719">child_CisAisCjtAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00755">child_CisAjtCkuAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00792">child_CisAjtCkuAlv_element()</a>, <a class="el" href="_pair_ex_hubbard_8c_source.html#l00121">GetPairExcitedStateHubbard()</a>, and <a class="el" href="make_ham_8c_source.html#l00054">makeHam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> off;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">int</span> sgn = 1;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  sgn = <a class="code" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a>(list_1_j, X, is1_spin, is2_spin, sum_spin, diff_spin, tmp_off);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (sgn != 0) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, *tmp_off, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">irght</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">ilft</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">ihfbit</a>, &amp;off)!=<a class="code" href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      *tmp_off = 0;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> sgn;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}<span class="comment">/*int X_CisAjt*/</span></div><div class="ttc" id="struct_large_list_html_a855e8bc4876c7e6da5249d8ae2b46b9c"><div class="ttname"><a href="struct_large_list.html#a855e8bc4876c7e6da5249d8ae2b46b9c">LargeList::ihfbit</a></div><div class="ttdeci">long unsigned int ihfbit</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00267">struct.h:267</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdoc">Variables for Matrix-Vector product. </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00334">struct.h:334</a></div></div>
<div class="ttc" id="global_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="global_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00025">global.h:25</a></div></div>
<div class="ttc" id="struct_large_list_html_a8e610d200c449d87882eccdc479b8cab"><div class="ttname"><a href="struct_large_list.html#a8e610d200c449d87882eccdc479b8cab">LargeList::ilft</a></div><div class="ttdeci">long unsigned int ilft</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00266">struct.h:266</a></div></div>
<div class="ttc" id="global_8h_html_a59e163bd798ad16a8c9d47e545e2e42f"><div class="ttname"><a href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a></div><div class="ttdeci">long unsigned int * list_2_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00050">global.h:50</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a36607f9856f8c9a3c43b2a4b87213c25"><div class="ttname"><a href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25">GetOffComp</a></div><div class="ttdeci">int GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdoc">function of getting off-diagonal component </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00195">bitcalc.c:195</a></div></div>
<div class="ttc" id="mltply_hubbard_core_8c_html_a0af550e9f9e1443323aba1b18cc35be0"><div class="ttname"><a href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0">X_GC_CisAjt</a></div><div class="ttdeci">int X_GC_CisAjt(long unsigned int list_1_j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int is2_spin, long unsigned int sum_spin, long unsigned int diff_spin, long unsigned int *tmp_off)</div><div class="ttdoc">Compute index of wavefunction of final state. </div><div class="ttdef"><b>Definition:</b> <a href="mltply_hubbard_core_8c_source.html#l00432">mltplyHubbardCore.c:432</a></div></div>
<div class="ttc" id="global_8h_html_aac1d1cc6d1099e228cb1f505ef0c86c6"><div class="ttname"><a href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a></div><div class="ttdeci">long unsigned int * list_2_2</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00051">global.h:51</a></div></div>
<div class="ttc" id="struct_large_list_html_ae434b7a485083dd5e96f24a24bc3e9b8"><div class="ttname"><a href="struct_large_list.html#ae434b7a485083dd5e96f24a24bc3e9b8">LargeList::irght</a></div><div class="ttdeci">long unsigned int irght</div><div class="ttdoc">Used for Ogata-Lin ??? </div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00265">struct.h:265</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-42" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_cgraph" id="mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a36607f9856f8c9a3c43b2a4b87213c25" title="function of getting off&#45;diagonal component " alt="" coords="131,5,227,32"/>
<area shape="rect" id="node4" href="mltply_hubbard_core_8c.html#a0af550e9f9e1443323aba1b18cc35be0" title="Compute index of wavefunction of final state. " alt="" coords="128,56,229,83"/>
<area shape="rect" id="node3" href="bitcalc_8c.html#ab40eb71d64770d5a59334e8c0aed3d50" title="function of splitting a original bit to right and left spaces " alt="" coords="277,5,341,32"/>
<area shape="rect" id="node5" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="279,56,340,83"/>
</map>
</div>
</p>

<p><div id="dynsection-43" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_icgraph" id="mltply_hubbard_core_8c_a576edff50809bed2a8ac5016b54027a4_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="156,212,291,253"/>
<area shape="rect" id="node26" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="396,219,479,246"/>
<area shape="rect" id="node28" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="154,277,293,319"/>
<area shape="rect" id="node29" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="156,343,291,384"/>
<area shape="rect" id="node30" href="_pair_ex_hubbard_8c.html#ad6ea48aa669d72fd8cc85162bae8b834" title="GetPairExcitedStateHubbard" alt="" coords="128,97,319,123"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="378,287,497,314"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="372,341,503,383"/>
<area shape="rect" id="node4" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="562,330,669,357"/>
<area shape="rect" id="node5" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="779,351,836,378"/>
<area shape="rect" id="node6" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1195,102,1349,129"/>
<area shape="rect" id="node9" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="979,270,1099,297"/>
<area shape="rect" id="node11" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="975,473,1103,499"/>
<area shape="rect" id="node16" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="993,574,1086,601"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="967,422,1111,449"/>
<area shape="rect" id="node18" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="965,371,1114,398"/>
<area shape="rect" id="node19" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="940,153,1139,195"/>
<area shape="rect" id="node22" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1216,599,1328,626"/>
<area shape="rect" id="node23" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="985,321,1093,347"/>
<area shape="rect" id="node7" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1413,127,1518,154"/>
<area shape="rect" id="node8" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="1573,422,1624,449"/>
<area shape="rect" id="node10" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1215,422,1329,449"/>
<area shape="rect" id="node12" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1226,523,1318,550"/>
<area shape="rect" id="node13" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1247,473,1297,499"/>
<area shape="rect" id="node14" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1409,371,1522,398"/>
<area shape="rect" id="node15" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1405,523,1525,550"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1187,203,1357,230"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1198,153,1346,179"/>
<area shape="rect" id="node25" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="967,523,1111,550"/>
<area shape="rect" id="node27" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="723,123,892,150"/>
<area shape="rect" id="node31" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="367,42,508,69"/>
<area shape="rect" id="node32" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="556,27,675,54"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0af550e9f9e1443323aba1b18cc35be0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X_GC_CisAjt </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>list_1_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is2_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>sum_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>diff_spin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>tmp_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute index of wavefunction of final state. </p>
<dl class="section return"><dt>Returns</dt><dd>Fermion sign </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">list_1_j</td><td><a class="el" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a> ? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is1_spin</td><td>Mask for occupation of (is) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is2_spin</td><td>Mask for occupation of (jt) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sum_spin</td><td>Mask for hopping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diff_spin</td><td>Mask for Fermion sign </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmp_off</td><td>Index of wavefunction of final state </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mltply_hubbard_core_8c_source.html#l00432">432</a> of file <a class="el" href="mltply_hubbard_core_8c_source.html">mltplyHubbardCore.c</a>.</p>

<p>References <a class="el" href="bitcalc_8c_source.html#l00339">SgnBit()</a>.</p>

<p>Referenced by <a class="el" href="mltply_hubbard_core_8c_source.html#l00792">child_CisAjtCkuAlv_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00866">GC_child_CisAisCjtAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00902">GC_child_CisAjtCkuAku_element()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00938">GC_child_CisAjtCkuAlv_element()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00192">GetSgnInterAll()</a>, <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00893">X_child_CisAjtCkuAlv_Hubbard_MPI()</a>, <a class="el" href="mltply_hubbard_core_8c_source.html#l00400">X_CisAjt()</a>, and <a class="el" href="mltply_m_p_i_hubbard_core_8c_source.html#l00535">X_GC_child_CisAjtCkuAlv_Hubbard_MPI()</a>.</p>
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit_tmp_1, ibit_tmp_2;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit, off;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordtype">int</span> sgn = 1;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  ibit_tmp_1 = (list_1_j &amp; is1_spin);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  ibit_tmp_2 = (list_1_j &amp; is2_spin);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">if</span> (ibit_tmp_1 == 0 &amp;&amp; ibit_tmp_2 != 0) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    bit = list_1_j &amp; diff_spin;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a>(bit, &amp;sgn); <span class="comment">// Fermion sign</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    off = list_1_j ^ sum_spin;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    *tmp_off = off;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> sgn; <span class="comment">// pm 1</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    *tmp_off = 0;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div><div class="ttc" id="bitcalc_8c_html_a7217ccf6f49458f399f3266ba4bafffb"><div class="ttname"><a href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb">SgnBit</a></div><div class="ttdeci">void SgnBit(const long unsigned int org_bit, int *sgn)</div><div class="ttdoc">function of getting fermion sign (64 bit) </div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00339">bitcalc.c:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-44" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_cgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_cgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_cgraph" id="mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_cgraph">
<area shape="rect" id="node2" href="bitcalc_8c.html#a7217ccf6f49458f399f3266ba4bafffb" title="function of getting fermion sign (64 bit) " alt="" coords="155,5,216,32"/>
</map>
</div>
</p>

<p><div id="dynsection-45" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><img src="mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_icgraph.png" border="0" usemap="#mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_icgraph" alt=""/></div>
<map name="mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_icgraph" id="mltply_hubbard_core_8c_a0af550e9f9e1443323aba1b18cc35be0_icgraph">
<area shape="rect" id="node2" href="mltply_hubbard_core_8c.html#a2e64839292192a5851d4be60a4f3561a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="568,239,703,281"/>
<area shape="rect" id="node28" href="mltply_hubbard_core_8c.html#a5a389f0d9543e02b5d2e19df0198bafc" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="554,305,717,346"/>
<area shape="rect" id="node32" href="mltply_hubbard_core_8c.html#ab7d585bf30bbcee8449b8c54d0bb128e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="552,370,719,411"/>
<area shape="rect" id="node33" href="mltply_hubbard_core_8c.html#a6d06655a28258eea84191579396219e1" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="554,435,717,477"/>
<area shape="rect" id="node34" href="mltply_m_p_i_hubbard_core_8c.html#a81ceaf1edd9e416156a2430f36ca6de3" title="Compute the index of final wavefunction associated to , and Fermion sign. " alt="" coords="155,771,261,797"/>
<area shape="rect" id="node37" href="mltply_m_p_i_hubbard_core_8c.html#add9824527f147708e47dc84b8322600e" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="779,883,957,925"/>
<area shape="rect" id="node38" href="mltply_m_p_i_hubbard_core_8c.html#ac3f88b541387e7b9b13758fa855b9327" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="793,755,943,797"/>
<area shape="rect" id="node41" href="mltply_hubbard_core_8c.html#a576edff50809bed2a8ac5016b54027a4" title="Compute index of wavefunction of final state. " alt="" coords="363,159,438,185"/>
<area shape="rect" id="node3" href="mltply_hubbard_8c.html#aef9d79bf221699cecaa1b65b374e5b92" title="Compute inter&#45;all term (canonical) " alt="" coords="809,188,927,215"/>
<area shape="rect" id="node24" href="expec__cisajscktaltdc_8c.html#a57e6093abb7b98c433e953764b892d15" title="expec_cisajscktalt\l_Hubbard" alt="" coords="1005,443,1136,485"/>
<area shape="rect" id="node26" href="make_ham_8c.html#a460d5b90ee970a19d8b66c2b30c8cb0b" title="Parent function of making Hamiltonian. " alt="" coords="827,247,909,273"/>
<area shape="rect" id="node4" href="mltply_hubbard_8c.html#ae34b47523aa0e2619a18e316f3d1e930" title="perform Hamiltonian vector product for (extended) Hubbard type model. &#160;" alt="" coords="1017,599,1124,625"/>
<area shape="rect" id="node5" href="mltply_8c.html#a61eb17d17b7d03aab22aa05b4074a407" title="mltply" alt="" coords="1240,599,1297,625"/>
<area shape="rect" id="node6" href="_calc_spectrum_by_bi_c_g_8c.html#a738c56fe9d7441e045776052b866ddd3" title="A main function to calculate spectrum by BiCG method In this function, the &#160;library is used..." alt="" coords="1657,433,1810,460"/>
<area shape="rect" id="node9" href="_c_g___eigen_vector_8c.html#a27dc47878d6c847ba4f6732e66204bf9" title="inversed power method with CG " alt="" coords="1441,737,1561,764"/>
<area shape="rect" id="node11" href="expec__energy__flct_8c.html#a3597e163a6cc1ae642ea4f0d1ecb9ee5" title="expec_energy_flct" alt="" coords="1437,585,1565,612"/>
<area shape="rect" id="node16" href="_first_multiply_8c.html#ac604557436119bb129e012c1dd4437a8" title="FirstMultiply" alt="" coords="1454,636,1547,663"/>
<area shape="rect" id="node17" href="_lanczos___eigen_value_8c.html#adffde20ad3202934fdc77cfa37472529" title="Lanczos_EigenValue" alt="" coords="1429,788,1573,815"/>
<area shape="rect" id="node18" href="_lanczos___eigen_vector_8c.html#a4575347f442614960b1d0555ab1d1ffe" title="Function for calculating eigenvectors by Lanczos method. " alt="" coords="1426,839,1575,865"/>
<area shape="rect" id="node19" href="_lanczos___eigen_value_8c.html#a06b0f00d313fd60d4156393dcb0e50b8" title="Calculate tridiagonal matrix components by Lanczos method. " alt="" coords="1401,317,1600,358"/>
<area shape="rect" id="node22" href="_calc_by_l_o_b_p_c_g_8c.html#abf636cac2045e948fae38a03ed72e14d" title="Core routine for the LOBPCG method This method is introduced inS. Yamada, et al., Transactions of JSC..." alt="" coords="1677,535,1789,561"/>
<area shape="rect" id="node23" href="_power_lanczos_8c.html#a72ac70ac22cd0e642dbf01a49683da87" title="PowerLanczos" alt="" coords="1447,484,1555,511"/>
<area shape="rect" id="node7" href="_calc_spectrum_8c.html#aca49d715bfd77330cff5f431d8b7c717" title="A main function to calculate spectrum. " alt="" coords="1874,307,1979,333"/>
<area shape="rect" id="node8" href="_h_phi_main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program for HPhi. " alt="" coords="2035,585,2085,612"/>
<area shape="rect" id="node10" href="_calc_by_lanczos_8c.html#a4efefe8077d976196c07adb0803ce2ff" title="A main function to calculate eigenvalues and eigenvectors by Lanczos method. " alt="" coords="1676,712,1791,739"/>
<area shape="rect" id="node12" href="_calc_by_t_p_q_8c.html#ae03e6c3be031f570a98eaf087be6efd7" title="CalcByTPQ" alt="" coords="1687,636,1779,663"/>
<area shape="rect" id="node13" href="phys_8c.html#a968744495c661c11bf1de29e130f549a" title="A main function to calculate physical quantities by full diagonalization method. " alt="" coords="1708,585,1759,612"/>
<area shape="rect" id="node14" href="_calc_by_full_diag_8c.html#a67653cce7bc65bc9108006c4c8bfa57b" title="CalcByFullDiag" alt="" coords="1870,535,1983,561"/>
<area shape="rect" id="node15" href="_calc_by_l_o_b_p_c_g_8c.html#a318525323fea91c9c78f906b41d20e3b" title="Driver routine for LOB(P)CG method. " alt="" coords="1867,585,1987,612"/>
<area shape="rect" id="node20" href="_calc_spectrum_by_lanczos_8c.html#ad93bf615dd8c2571525cec5a40861d32" title="A main function to calculate spectrum by Lanczos. " alt="" coords="1648,332,1819,359"/>
<area shape="rect" id="node21" href="_calc_spectrum_by_t_p_q_8c.html#a20b6d1f758a208a87ba808c31c529183" title="A main function to calculate spectrum by TPQ. " alt="" coords="1659,281,1807,308"/>
<area shape="rect" id="node25" href="expec__cisajscktaltdc_8c.html#ab1e0307962ebf631818025cd262c4bd9" title="Parent function to calculate two&#45;body green&#39;s functions. " alt="" coords="1429,687,1573,713"/>
<area shape="rect" id="node27" href="_calc_spectrum_by_full_diag_8c.html#a21c861e5fa09c2e946fcdaf43c7650f7" title="Compute the Green function with the Lehmann representation and FD . " alt="" coords="1184,237,1353,264"/>
<area shape="rect" id="node29" href="expec__cisajscktaltdc_8c.html#a5780ffd65b489119e7d7eb9617e2d3a0" title="expec_cisajscktalt\l_HubbardGC" alt="" coords="1005,831,1136,873"/>
<area shape="rect" id="node30" href="mltply_hubbard_8c.html#a70e66e6ab9f74ec21130ed2363e24a51" title="Compute inter&#45;all term (canonical) " alt="" coords="795,399,941,425"/>
<area shape="rect" id="node31" href="mltply_hubbard_8c.html#a3a8ead6d49a5b1621694d91c05ee3dc2" title="perform Hamiltonian vector product for (extended) Hubbard type model (Grandcanonical). &#160;" alt="" coords="1007,780,1134,807"/>
<area shape="rect" id="node35" href="mltply_m_p_i_hubbard_core_8c.html#a2d5b96ff0d102ab1501330d94d23d866" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="309,907,492,949"/>
<area shape="rect" id="node39" href="mltply_m_p_i_hubbard_core_8c.html#a67618b30efd1e0dddf58b89407e13736" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="323,603,478,645"/>
<area shape="rect" id="node36" href="mltply_m_p_i_hubbard_core_8c.html#a11e540019dd7ff6b6b611767d483fa60" title="Compute &#160;term of grandcanonical Hubbard system. " alt="" coords="546,1025,725,1066"/>
<area shape="rect" id="node40" href="mltply_m_p_i_hubbard_core_8c.html#a59452329e5c334718f67ab4d3d8b8431" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="560,603,711,645"/>
<area shape="rect" id="node42" href="mltply_hubbard_core_8c.html#a985bdb0d96a952fc6c447e12ea2b906a" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="568,57,703,98"/>
<area shape="rect" id="node43" href="mltply_hubbard_core_8c.html#a8575bdd2f35cf049753b0617d2693edb" title="Compute &#160;term of canonical Hubbard system. " alt="" coords="566,122,705,163"/>
<area shape="rect" id="node44" href="_pair_ex_hubbard_8c.html#ad6ea48aa669d72fd8cc85162bae8b834" title="GetPairExcitedStateHubbard" alt="" coords="540,5,731,32"/>
<area shape="rect" id="node45" href="_pair_ex_8c.html#a1bd77a0e185cc54a5e6574efb561b2a0" title="GetPairExcitedState" alt="" coords="797,15,939,41"/>
<area shape="rect" id="node46" href="_calc_spectrum_8c.html#a887ec2a16db129a80adf6e58092aeada" title="GetExcitedState" alt="" coords="1209,89,1328,116"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="mltply_hubbard_core_8c.html">mltplyHubbardCore.c</a></li>
    <li class="footer">Generated on Thu Oct 26 2017 15:48:15 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
