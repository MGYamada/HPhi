<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>HΦ: include/expec_cisajscktaltdc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HΦ
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('expec__cisajscktaltdc_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">expec_cisajscktaltdc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_common_8h_source.html">Common.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for expec_cisajscktaltdc.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="expec__cisajscktaltdc_8h__incl.png" border="0" usemap="#include_2expec__cisajscktaltdc_8h" alt=""/></div>
<map name="include_2expec__cisajscktaltdc_8h" id="include_2expec__cisajscktaltdc_8h">
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="expec__cisajscktaltdc_8h__dep__incl.png" border="0" usemap="#include_2expec__cisajscktaltdc_8hdep" alt=""/></div>
<map name="include_2expec__cisajscktaltdc_8hdep" id="include_2expec__cisajscktaltdc_8hdep">
</map>
</div>
</div>
<p><a href="expec__cisajscktaltdc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e3412d59338159b5803489c611ceb4c"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expec__cisajscktaltdc_8h.html#a6e3412d59338159b5803489c611ceb4c">child_Cor_1</a> (long unsigned int j, long unsigned int is_A, long unsigned int is1, long unsigned int is2, long unsigned int is3, long unsigned int b_sigma_A, long unsigned int irght, long unsigned int ilft, long unsigned int ihfbit, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *<a class="el" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>)</td></tr>
<tr class="separator:a6e3412d59338159b5803489c611ceb4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a489d1a05dd1d483c63886cd4f8686de2"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expec__cisajscktaltdc_8h.html#a489d1a05dd1d483c63886cd4f8686de2">child_Cor_2</a> (long unsigned int j, long unsigned int is_B, long unsigned int is1, long unsigned int is3, long unsigned int is4, long unsigned int b_sigma_B, long unsigned int irght, long unsigned int ilft, long unsigned int ihfbit, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *<a class="el" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>)</td></tr>
<tr class="separator:a489d1a05dd1d483c63886cd4f8686de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af49db6a67edc4a26bced22b6a3b4c5e1"><td class="memItemLeft" align="right" valign="top">double complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expec__cisajscktaltdc_8h.html#af49db6a67edc4a26bced22b6a3b4c5e1">child_Cor_3</a> (long unsigned int j, long unsigned int is_A, long unsigned int is_B, long unsigned int is1, long unsigned int is2, long unsigned int is3, long unsigned int is4, long unsigned int b_sigma_A, long unsigned int b_sigma_B, long unsigned int irght, long unsigned int ilft, long unsigned int ihfbit, struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *<a class="el" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>)</td></tr>
<tr class="separator:af49db6a67edc4a26bced22b6a3b4c5e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e0307962ebf631818025cd262c4bd9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expec__cisajscktaltdc_8h.html#ab1e0307962ebf631818025cd262c4bd9">expec_cisajscktaltdc</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *<a class="el" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>)</td></tr>
<tr class="separator:ab1e0307962ebf631818025cd262c4bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5844529f50e34cd7a8642cfb700f8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expec__cisajscktaltdc_8h.html#add5844529f50e34cd7a8642cfb700f8b">expec_cisajscktaltdc_alldiag</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *<a class="el" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>)</td></tr>
<tr class="separator:add5844529f50e34cd7a8642cfb700f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e224de99736e8ca65d163cf8fda3605"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expec__cisajscktaltdc_8h.html#a3e224de99736e8ca65d163cf8fda3605">expec_cisajscktaltdc_alldiag_spin</a> (struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *<a class="el" href="struct_8h.html#a2e5276e30c3a9c9155e407ab3e645567">X</a>, double complex *<a class="el" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>)</td></tr>
<tr class="separator:a3e224de99736e8ca65d163cf8fda3605"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6e3412d59338159b5803489c611ceb4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_Cor_1 </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>b_sigma_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>irght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>ilft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>ihfbit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a489d1a05dd1d483c63886cd4f8686de2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_Cor_2 </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>b_sigma_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>irght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>ilft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>ihfbit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af49db6a67edc4a26bced22b6a3b4c5e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double complex child_Cor_3 </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>is4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>b_sigma_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>b_sigma_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>irght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>ilft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>ihfbit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab1e0307962ebf631818025cd262c4bd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int expec_cisajscktaltdc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramname">vec</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00032">32</a> of file <a class="el" href="expec__cisajscktaltdc_8c_source.html">expec_cisajscktaltdc.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  FILE *fp;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">char</span> sdt[<a class="code" href="global_8h.html#aa68aa1cfd58c60e5cb4877965fa41576">D_FileNameMax</a>];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght,ilft,ihfbit;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,isite2,isite3,isite4;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_isite1,org_isite2,org_isite3,org_isite4,org_sigma1,org_sigma2;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> org_sigma3,org_sigma4;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isA_up, isB_up;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Asum,Bsum,Adiff,Bdiff;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off=0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp_off_2=0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span> tmp_sgn;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">double</span> complex tmp_V;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">double</span> complex dam_pr;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">int</span> i_max;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">//For TPQ</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> step=0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> rand_i=0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">//For Kond</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> complex dmv;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">mode</a>=<a class="code" href="mltply_8h.html#a7ef0ac15397782150359429b7456c5fa">M_CORR</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  tmp_V    = 1.0+0.0*I;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="bitcalc_8c.html#a78387adc1f4e171d3796235adfcbd87e">GetSplitBitByModel</a>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">Nsite</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">iCalcModel</a>, &amp;irght, &amp;ilft, &amp;ihfbit)!=0){</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  dam_pr=0.0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//Make File Name for output</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">switch</span> (X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#acb5c1ecb58e03a4cb90050b1b3e2357e">Lanczos</a>:</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==0){</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      sprintf(sdt, <a class="code" href="global_8c.html#a30aa928612a1c54d049114f96c2d25e7">cFileName2BGreen_Lanczos</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;Start: Calculate two bodies Green functions by Lanczos method.\n&quot;</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==1){</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      sprintf(sdt, <a class="code" href="global_8c.html#a2a071aec3f989fa3b894107138199ddb">cFileName2BGreen_CG</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;Start: Calculate two bodies Green functions by CG method.\n&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a8fd728eaf34853a90790f9eddd9022ef">TPQCalc</a>:</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    step=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#abe80758171b3ffeca7b5fa790e5ede22">istep</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    rand_i=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#af1a607bc77f32d6efe6a799ee78a9456">irand</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="log_8h.html#a6e1528922a48320b30d56b93f1cc8370">TimeKeeperWithRandAndStep</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8h.html#acf90179a5d51508dd9973c8389f4aed2">cTPQExpecTwoBodyGStart</a>, <span class="stringliteral">&quot;a&quot;</span>, rand_i, step);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    sprintf(sdt, <a class="code" href="global_8c.html#a88f940c2e673ea0ac2352249e76f5201">cFileName2BGreen_TPQ</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>, rand_i, step);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a7f6b1308cdb6cc196f106ff63c26849b">FullDiag</a>:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    sprintf(sdt, <a class="code" href="global_8c.html#af97aa29cc5e6f180b89596e6c91a3ffc">cFileName2BGreen_FullDiag</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">CDataFileHead</a>, X-&gt;<a class="code" href="struct_bind_struct.html#a4779085fc0aeb372e1b3f3b0a20dee5d">Phys</a>.<a class="code" href="struct_phys_list.html#a5616dcf1777ecef24f4883835541a375">eigen_num</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="_file_i_o_8c.html#a7d23a0790b28a52d128e0b93bc832cfb">childfopenMPI</a>(sdt, <span class="stringliteral">&quot;w&quot;</span>, &amp;fp)==0){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">switch</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">iCalcModel</a>){</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a5e2c64674c783f9e961ac5f05f653e2a">HubbardGC</a>:</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a910451f7ffb4effad9386378ffd175d0">NCisAjtCkuAlvDC</a>;i++){</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="mltply_8h.html#ad8750d6b426c68d0e931849d094b11ce">child_general_int_GetInfo</a></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    (</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;     i, </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     X,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     org_isite1,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     org_isite2,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     org_isite3,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     org_isite4,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     org_sigma1,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     org_sigma2,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;     org_sigma3,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     org_sigma4,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     tmp_V</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      i_max  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      Asum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      Adiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      Bsum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      Bdiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        dam_pr = 0.0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      dam_pr += <a class="code" href="mltply_8h.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        dam_pr = 0.0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      dam_pr += <a class="code" href="mltply_8h.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    dam_pr = 0.0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      dam_pr +=<a class="code" href="mltply_8h.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    } </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    dam_pr = 0.0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      dam_pr +=<a class="code" href="mltply_8h.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a>(j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off_2);   </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      } </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a84a2a0896f6c0300a068925d7b299515">KondoGC</a>:</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a1518a9996ad08009b6ea9a6de5198b65">Hubbard</a>:</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#a531ba444bc15b6711c05fd95874f205d">Kondo</a>:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a910451f7ffb4effad9386378ffd175d0">NCisAjtCkuAlvDC</a>;i++){</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      tmp_V    = 1.0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;           </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="mltply_8h.html#ad8750d6b426c68d0e931849d094b11ce">child_general_int_GetInfo</a>(</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                i, </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                X,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                org_isite1,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                org_isite2,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                org_isite3,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                org_isite4,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                org_sigma1,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                org_sigma2,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                org_sigma3,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                org_sigma4,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                tmp_V</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                );</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      i_max  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">i_max</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      isite1 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">is1_spin</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      isite2 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">is2_spin</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      Asum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">isA_spin</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      Adiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">A_spin</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      isite3 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">is3_spin</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      isite4 = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">is4_spin</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      Bsum   = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">isB_spin</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      Bdiff  = X-&gt;<a class="code" href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">Large</a>.<a class="code" href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">B_spin</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      tmp_V  = 1.0;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      dam_pr = 0.0+I*0.0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      dam_pr += <a class="code" href="mltply_8h.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a>(j, isite1, isite3, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 == isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      dam_pr += <a class="code" href="mltply_8h.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a>(j, isite1, isite3, isite4, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 == isite4){</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      dam_pr +=<a class="code" href="mltply_8h.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a>(j, isite1, isite2, isite3, Asum, Adiff, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    } </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isite1 != isite2 &amp;&amp; isite3 != isite4){</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isite1,isite2,isite4,isite3,Asum,Bsum,Adiff,Bdiff,tmp_off,tmp_off_2) shared(vec,tmp_V)</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      dam_pr +=<a class="code" href="mltply_8h.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a>(j, isite1, isite2, isite3, isite4, Asum, Adiff, Bsum, Bdiff, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off_2);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    } </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf\n&quot;</span>,org_isite1-1,org_sigma1, org_isite2-1,org_sigma2, org_isite3-1, org_sigma3, org_isite4-1,org_sigma4, creal(dam_pr), cimag(dam_pr));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }    </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#ad2bf5a74a6b8ccd9b93ff923d904d3e6">Spin</a>:</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a910451f7ffb4effad9386378ffd175d0">NCisAjtCkuAlvDC</a>;i++){</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span>(org_isite1==org_isite2 &amp;&amp; org_isite3==org_isite4){</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite2-1];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite4-1];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2, tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        dam_pr +=<a class="code" href="mltply_8h.html#a9f7fc788e6ba0b42f84e2c5a4d187f4a">child_CisAisCisAis_spin_element</a>(j, isA_up, isB_up, org_sigma2, org_sigma4, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1==org_sigma4 &amp;&amp; org_sigma2==org_sigma3){ <span class="comment">// exchange</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            tmp_sgn    =  <a class="code" href="mltply_8h.html#a40a1adaf57adca8173be6dbcf260aabf">X_child_exchange_spin_element</a>(j,X,isA_up,isB_up,org_sigma2,org_sigma4,&amp;tmp_off);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            dmv        = <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*tmp_sgn;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            dam_pr    += conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[tmp_off])*dmv;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }<span class="keywordflow">else</span>{  <span class="comment">// other process is not allowed</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <span class="comment">// error message will be added</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,0.0,0.0);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_isite1==org_isite4 &amp;&amp; org_isite2==org_isite3){</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite1-1];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite2-1];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4){ <span class="comment">// exchange</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      dam_pr = 0.0;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        tmp_sgn    = <a class="code" href="mltply_8h.html#a40a1adaf57adca8173be6dbcf260aabf">X_child_exchange_spin_element</a>(j,X,isA_up,isB_up,org_sigma4,org_sigma2,&amp;tmp_off);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        dmv        = <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*tmp_sgn;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        dam_pr    += conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[tmp_off])*dmv;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      dam_pr = -1.0*dam_pr;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }<span class="keywordflow">else</span>{ <span class="comment">// this process is not allowed</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          <span class="comment">//error message will be added </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,0.0,0.0);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">//error message will be added </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,0.0,0.0);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="_def_common_8h.html#aa7314d1157770374b63f2a07076e1cdb">SpinGC</a>:</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a910451f7ffb4effad9386378ffd175d0">NCisAjtCkuAlvDC</a>;i++){</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      org_isite1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][0]+1;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      org_sigma1   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][1];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      org_isite2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][2]+1;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      org_sigma2   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][3];</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      org_isite3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][4]+1;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      org_sigma3   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][5];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      org_isite4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][6]+1;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      org_sigma4   = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">CisAjtCkuAlvDC</a>[i][7];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">if</span>(org_isite1==org_isite2 &amp;&amp; org_isite3==org_isite4){</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite2-1];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite4-1];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span>(org_sigma1==org_sigma2 &amp;&amp; org_sigma3==org_sigma4 ){ <span class="comment">//diagonal</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        dam_pr +=<a class="code" href="mltply_8h.html#aa25730bebedaef0567be1d1d3a2aa9f7">GC_child_CisAisCisAis_spin_element</a>(j, isA_up, isB_up, org_sigma2, org_sigma4, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){ </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        dam_pr += <a class="code" href="mltply_8h.html#af675fc77ae3b652589d52ff3fa667b77">GC_child_CisAisCitAiu_spin_element</a>(j, org_sigma2, org_sigma4, isA_up, isB_up, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          } </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 == org_sigma4){ </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         dam_pr += <a class="code" href="mltply_8h.html#a220085102d48735b8111fe704e5d5993">GC_child_CisAitCiuAiu_spin_element</a>(j, org_sigma2, org_sigma4, isA_up, isB_up, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          } </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma2 &amp;&amp; org_sigma3 != org_sigma4){ </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2,tmp_V) shared(vec)</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        dam_pr += <a class="code" href="mltply_8h.html#a1b6c6239f632e04606cf340f024d2ed3">GC_child_CisAitCiuAiv_spin_element</a>(j, org_sigma2, org_sigma4, isA_up, isB_up, tmp_V, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>, X, &amp;tmp_off);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">else</span>{<span class="comment">// hopping process is not allowed</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">//error message will be added </span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,0.0,0.0);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">if</span>(org_isite1==org_isite4 &amp;&amp; org_isite2==org_isite3){ <span class="comment">// </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">// 2 &lt;-&gt; 4</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        isA_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite4-1];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        isB_up = X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[org_isite2-1];</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span>(org_sigma1==org_sigma4 &amp;&amp; org_sigma3==org_sigma2 ){ <span class="comment">//diagonal</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2) shared(vec)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            tmp_sgn      = <a class="code" href="mltply_8h.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>(j,X,isB_up,org_sigma2);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            tmp_sgn     *= <a class="code" href="mltply_8h.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>(j,X,isA_up,org_sigma4);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            dmv          = <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*tmp_sgn;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            dam_pr      += conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])*dmv;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          dam_pr = -1.0*dam_pr;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 == org_sigma4 &amp;&amp; org_sigma3 != org_sigma2){ </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2) shared(vec)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            tmp_sgn   =  <a class="code" href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a>(j,X,isB_up,org_sigma2,&amp;tmp_off);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span>(tmp_sgn != 0){</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;              tmp_sgn   *= <a class="code" href="mltply_8h.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>(j,X,isA_up,org_sigma4);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;              dmv        = <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*tmp_sgn;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;              dam_pr    += conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[tmp_off]+1)*dmv;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          } </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          dam_pr = -1.0*dam_pr;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma4 &amp;&amp; org_sigma3 == org_sigma2){ </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2) shared(vec)</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            tmp_sgn      = <a class="code" href="mltply_8h.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a>(j,X,isB_up,org_sigma2);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">if</span>(tmp_sgn != 0){</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;              tmp_sgn   *= <a class="code" href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a>(j,X,isA_up,org_sigma4,&amp;tmp_off); </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;              dmv        = <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*tmp_sgn;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;              dam_pr    += conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[tmp_off]+1)*dmv;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          } </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          dam_pr = -1.0*dam_pr;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(org_sigma1 != org_sigma4 &amp;&amp; org_sigma3 != org_sigma2){ </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          dam_pr = 0.0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#pragma omp parallel for default(none) reduction(+:dam_pr) private(j, tmp_sgn, dmv) firstprivate(i_max,X,isA_up,isB_up,org_sigma2,org_sigma4,tmp_off,tmp_off_2) shared(vec)</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            tmp_sgn      =  <a class="code" href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a>(j,X,isB_up,org_sigma2,&amp;tmp_off);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordflow">if</span>(tmp_sgn != 0){</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;              tmp_sgn   *= <a class="code" href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a>(tmp_off+1,X,isA_up,org_sigma4,&amp;tmp_off_2); </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;              dmv        = <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*tmp_sgn;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;              dam_pr    += conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[tmp_off_2]+1)*dmv;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          dam_pr = -1.0*dam_pr;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,creal(dam_pr),cimag(dam_pr));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      }<span class="keywordflow">else</span>{<span class="comment">// hopping process is not allowed</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">//error message will be added </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(fp,<span class="stringliteral">&quot; %4ld %4ld %4ld %4ld %4ld %4ld %4ld %4ld %.10lf %.10lf \n&quot;</span>,org_isite1-1,org_sigma1,org_isite2-1,org_sigma2,org_isite3-1,org_sigma3,org_isite4-1,org_sigma4,0.0,0.0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  fclose(fp);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>==<a class="code" href="_def_common_8h.html#acb5c1ecb58e03a4cb90050b1b3e2357e">Lanczos</a>){</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==0){</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="log_8h.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8h.html#ad0f20fbe58825d5d2ffe1414937e6386">cLanczosExpecTwoBodyGFinish</a>,<span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_log_message_8h.html#ad55b0f4978dc9f09cbc491ab0d76c78f">cLogLanczosExpecTwoBodyGFinish</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">St</a>==1){</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <a class="code" href="log_8h.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8h.html#a7519659e9f2c455440ff713b688cc682">cCGExpecTwoBodyGFinish</a>,<span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <a class="code" href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a>(<a class="code" href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_log_message_8h.html#af9e20cd063f9fc302818c9bd15eff059">cLogCGExpecTwoBodyGFinish</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">iCalcType</a>==<a class="code" href="_def_common_8h.html#a8fd728eaf34853a90790f9eddd9022ef">TPQCalc</a>){</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="log_8h.html#a6e1528922a48320b30d56b93f1cc8370">TimeKeeperWithRandAndStep</a>(X, <a class="code" href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a>, <a class="code" href="_log_message_8h.html#a9fbb46cf5afeb53c4d1879ed2cb2123a">cTPQExpecTwoBodyGFinish</a>, <span class="stringliteral">&quot;a&quot;</span>, rand_i, step);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">//[s] this part will be added</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">/* For FullDiag, it is convinient to calculate the total spin for each vector.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     Such functions will be added </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">     if(X-&gt;Def.iCalcType==FullDiag){</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">     if(X-&gt;Def.iCalcModel==Spin){</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">     expec_cisajscktaltdc_alldiag_spin(X,vec);</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">     }else if(X-&gt;Def.iCalcModel==Hubbard || X-&gt;Def.iCalcModel==Kondo){</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">     expec_cisajscktaltdc_alldiag(X,vec);</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">     }else{// </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">     X-&gt;Phys.s2=0.0;   </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">     }</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">     }</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">//[e]</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="ttc" id="mltply_8h_html_a985bdb0d96a952fc6c447e12ea2b906a"><div class="ttname"><a href="mltply_8h.html#a985bdb0d96a952fc6c447e12ea2b906a">child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02091">mltply.c:2091</a></div></div>
<div class="ttc" id="struct_define_list_html_af1a607bc77f32d6efe6a799ee78a9456"><div class="ttname"><a href="struct_define_list.html#af1a607bc77f32d6efe6a799ee78a9456">DefineList::irand</a></div><div class="ttdeci">int irand</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00047">struct.h:47</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00210">struct.h:210</a></div></div>
<div class="ttc" id="mltply_8h_html_ad8750d6b426c68d0e931849d094b11ce"><div class="ttname"><a href="mltply_8h.html#ad8750d6b426c68d0e931849d094b11ce">child_general_int_GetInfo</a></div><div class="ttdeci">int child_general_int_GetInfo(const int iInterAll, struct BindStruct *X, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int sigma1, long unsigned int sigma2, long unsigned int sigma3, long unsigned int sigma4, double complex tmp_V)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l00913">mltply.c:913</a></div></div>
<div class="ttc" id="struct_large_list_html_a7d84518da32ee1be30b4031b77e4b282"><div class="ttname"><a href="struct_large_list.html#a7d84518da32ee1be30b4031b77e4b282">LargeList::B_spin</a></div><div class="ttdeci">long unsigned int B_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00173">struct.h:173</a></div></div>
<div class="ttc" id="_def_common_8h_html_acb5c1ecb58e03a4cb90050b1b3e2357e"><div class="ttname"><a href="_def_common_8h.html#acb5c1ecb58e03a4cb90050b1b3e2357e">Lanczos</a></div><div class="ttdeci">#define Lanczos</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00024">DefCommon.h:24</a></div></div>
<div class="ttc" id="struct_define_list_html_a1ff331495c1f203f90e497c95b835619"><div class="ttname"><a href="struct_define_list.html#a1ff331495c1f203f90e497c95b835619">DefineList::St</a></div><div class="ttdeci">int St</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00048">struct.h:48</a></div></div>
<div class="ttc" id="mltply_8h_html_a8575bdd2f35cf049753b0617d2693edb"><div class="ttname"><a href="mltply_8h.html#a8575bdd2f35cf049753b0617d2693edb">child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02143">mltply.c:2143</a></div></div>
<div class="ttc" id="_log_message_8h_html_a9fbb46cf5afeb53c4d1879ed2cb2123a"><div class="ttname"><a href="_log_message_8h.html#a9fbb46cf5afeb53c4d1879ed2cb2123a">cTPQExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cTPQExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8h_source.html#l00078">LogMessage.h:78</a></div></div>
<div class="ttc" id="mltply_8h_html_a40a1adaf57adca8173be6dbcf260aabf"><div class="ttname"><a href="mltply_8h.html#a40a1adaf57adca8173be6dbcf260aabf">X_child_exchange_spin_element</a></div><div class="ttdeci">int X_child_exchange_spin_element(const long unsigned int j, struct BindStruct *X, const long unsigned int isA_up, const long unsigned int isB_up, const long unsigned int sigmaA, const long unsigned int sigmaB, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01623">mltply.c:1623</a></div></div>
<div class="ttc" id="struct_check_list_html_a5d8a1e6a9e9064ae7dab52310d2cce11"><div class="ttname"><a href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">CheckList::idim_max</a></div><div class="ttdeci">unsigned long int idim_max</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00141">struct.h:141</a></div></div>
<div class="ttc" id="struct_large_list_html_a7e059f6e6cebf78ce4cb390c03aaee60"><div class="ttname"><a href="struct_large_list.html#a7e059f6e6cebf78ce4cb390c03aaee60">LargeList::is4_spin</a></div><div class="ttdeci">long unsigned int is4_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00166">struct.h:166</a></div></div>
<div class="ttc" id="mltply_8h_html_a11e78b661246513350ad6ee2e3985d9f"><div class="ttname"><a href="mltply_8h.html#a11e78b661246513350ad6ee2e3985d9f">child_CisAisCisAis_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02047">mltply.c:2047</a></div></div>
<div class="ttc" id="struct_define_list_html_a8a54486217df163bb7d30f0134ef0474"><div class="ttname"><a href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">DefineList::Nsite</a></div><div class="ttdeci">int Nsite</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00038">struct.h:38</a></div></div>
<div class="ttc" id="struct_large_list_html_a726d63842067e1bbfd2a06d6b37f4476"><div class="ttname"><a href="struct_large_list.html#a726d63842067e1bbfd2a06d6b37f4476">LargeList::isB_spin</a></div><div class="ttdeci">long unsigned int isB_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00178">struct.h:178</a></div></div>
<div class="ttc" id="_log_message_8h_html_ad55b0f4978dc9f09cbc491ab0d76c78f"><div class="ttname"><a href="_log_message_8h.html#ad55b0f4978dc9f09cbc491ab0d76c78f">cLogLanczosExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cLogLanczosExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8h_source.html#l00073">LogMessage.h:73</a></div></div>
<div class="ttc" id="mltply_8h_html_aa25730bebedaef0567be1d1d3a2aa9f7"><div class="ttname"><a href="mltply_8h.html#aa25730bebedaef0567be1d1d3a2aa9f7">GC_child_CisAisCisAis_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_spin_element(long unsigned int j, long unsigned int isA_up, long unsigned int isB_up, long unsigned int org_sigma2, long unsigned int org_sigma4, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02354">mltply.c:2354</a></div></div>
<div class="ttc" id="global_8c_html_a88f940c2e673ea0ac2352249e76f5201"><div class="ttname"><a href="global_8c.html#a88f940c2e673ea0ac2352249e76f5201">cFileName2BGreen_TPQ</a></div><div class="ttdeci">const char * cFileName2BGreen_TPQ</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00056">global.c:56</a></div></div>
<div class="ttc" id="mltply_8h_html_a5d9e5a462ca77248cbae177465fa02c3"><div class="ttname"><a href="mltply_8h.html#a5d9e5a462ca77248cbae177465fa02c3">X_SpinGC_CisAis</a></div><div class="ttdeci">int X_SpinGC_CisAis(long unsigned int j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int sigma1)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01482">mltply.c:1482</a></div></div>
<div class="ttc" id="_def_common_8h_html_a1518a9996ad08009b6ea9a6de5198b65"><div class="ttname"><a href="_def_common_8h.html#a1518a9996ad08009b6ea9a6de5198b65">Hubbard</a></div><div class="ttdeci">#define Hubbard</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00030">DefCommon.h:30</a></div></div>
<div class="ttc" id="global_8h_html_aa68aa1cfd58c60e5cb4877965fa41576"><div class="ttname"><a href="global_8h.html#aa68aa1cfd58c60e5cb4877965fa41576">D_FileNameMax</a></div><div class="ttdeci">#define D_FileNameMax</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00022">global.h:22</a></div></div>
<div class="ttc" id="global_8h_html_ad7960e15bbb3ec77e0480d11807de888"><div class="ttname"><a href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a></div><div class="ttdeci">double complex ** vec</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00030">global.h:30</a></div></div>
<div class="ttc" id="_def_common_8h_html_a531ba444bc15b6711c05fd95874f205d"><div class="ttname"><a href="_def_common_8h.html#a531ba444bc15b6711c05fd95874f205d">Kondo</a></div><div class="ttdeci">#define Kondo</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00032">DefCommon.h:32</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a06f59e082cd77bca79cd01db0ec7dbec"><div class="ttname"><a href="struct_bind_struct.html#a06f59e082cd77bca79cd01db0ec7dbec">BindStruct::Large</a></div><div class="ttdeci">struct LargeList Large</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00212">struct.h:212</a></div></div>
<div class="ttc" id="struct_large_list_html_aa3b29bd026038bb0742a26b44aaf7af2"><div class="ttname"><a href="struct_large_list.html#aa3b29bd026038bb0742a26b44aaf7af2">LargeList::is1_spin</a></div><div class="ttdeci">long unsigned int is1_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00163">struct.h:163</a></div></div>
<div class="ttc" id="struct_define_list_html_ac22e3ff4e833d0018210a68bee2ed816"><div class="ttname"><a href="struct_define_list.html#ac22e3ff4e833d0018210a68bee2ed816">DefineList::CisAjtCkuAlvDC</a></div><div class="ttdeci">int ** CisAjtCkuAlvDC</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00130">struct.h:130</a></div></div>
<div class="ttc" id="_file_i_o_8c_html_a7d23a0790b28a52d128e0b93bc832cfb"><div class="ttname"><a href="_file_i_o_8c.html#a7d23a0790b28a52d128e0b93bc832cfb">childfopenMPI</a></div><div class="ttdeci">int childfopenMPI(const char *_cPathChild, const char *_cmode, FILE **_fp)</div><div class="ttdef"><b>Definition:</b> <a href="_file_i_o_8c_source.html#l00031">FileIO.c:31</a></div></div>
<div class="ttc" id="_def_common_8h_html_ad2bf5a74a6b8ccd9b93ff923d904d3e6"><div class="ttname"><a href="_def_common_8h.html#ad2bf5a74a6b8ccd9b93ff923d904d3e6">Spin</a></div><div class="ttdeci">#define Spin</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00031">DefCommon.h:31</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a4779085fc0aeb372e1b3f3b0a20dee5d"><div class="ttname"><a href="struct_bind_struct.html#a4779085fc0aeb372e1b3f3b0a20dee5d">BindStruct::Phys</a></div><div class="ttdeci">struct PhysList Phys</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00213">struct.h:213</a></div></div>
<div class="ttc" id="struct_large_list_html_a6364781183a05e11f9bf9174af3e1734"><div class="ttname"><a href="struct_large_list.html#a6364781183a05e11f9bf9174af3e1734">LargeList::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00161">struct.h:161</a></div></div>
<div class="ttc" id="mltply_8h_html_a220085102d48735b8111fe704e5d5993"><div class="ttname"><a href="mltply_8h.html#a220085102d48735b8111fe704e5d5993">GC_child_CisAitCiuAiu_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAitCiuAiu_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02451">mltply.c:2451</a></div></div>
<div class="ttc" id="_log_message_8h_html_ad0f20fbe58825d5d2ffe1414937e6386"><div class="ttname"><a href="_log_message_8h.html#ad0f20fbe58825d5d2ffe1414937e6386">cLanczosExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cLanczosExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8h_source.html#l00075">LogMessage.h:75</a></div></div>
<div class="ttc" id="struct_large_list_html_a92cf162de20e74ee5acf2a65242cf435"><div class="ttname"><a href="struct_large_list.html#a92cf162de20e74ee5acf2a65242cf435">LargeList::is3_spin</a></div><div class="ttdeci">long unsigned int is3_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00165">struct.h:165</a></div></div>
<div class="ttc" id="xfreemem__large_8c_html_a5c1bb0da45eec945c4cc3233c7d8427e"><div class="ttname"><a href="xfreemem__large_8c.html#a5c1bb0da45eec945c4cc3233c7d8427e">fprintf</a></div><div class="ttdeci">fprintf(stdoutMPI,&quot;LARGE Free FINISH !\n&quot;)</div></div>
<div class="ttc" id="mltply_8h_html_af675fc77ae3b652589d52ff3fa667b77"><div class="ttname"><a href="mltply_8h.html#af675fc77ae3b652589d52ff3fa667b77">GC_child_CisAisCitAiu_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAisCitAiu_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02402">mltply.c:2402</a></div></div>
<div class="ttc" id="mltply_8h_html_a707ac2de8043df3be28fcf3c81c44362"><div class="ttname"><a href="mltply_8h.html#a707ac2de8043df3be28fcf3c81c44362">X_SpinGC_CisAit</a></div><div class="ttdeci">int X_SpinGC_CisAit(long unsigned int j, struct BindStruct *X, long unsigned int is1_spin, long unsigned int sigma2, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l01509">mltply.c:1509</a></div></div>
<div class="ttc" id="struct_large_list_html_a0595e327f9726774211d82f27477ae07"><div class="ttname"><a href="struct_large_list.html#a0595e327f9726774211d82f27477ae07">LargeList::A_spin</a></div><div class="ttdeci">long unsigned int A_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00172">struct.h:172</a></div></div>
<div class="ttc" id="mltply_8h_html_a2e64839292192a5851d4be60a4f3561a"><div class="ttname"><a href="mltply_8h.html#a2e64839292192a5851d4be60a4f3561a">child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02199">mltply.c:2199</a></div></div>
<div class="ttc" id="_def_common_8h_html_a8fd728eaf34853a90790f9eddd9022ef"><div class="ttname"><a href="_def_common_8h.html#a8fd728eaf34853a90790f9eddd9022ef">TPQCalc</a></div><div class="ttdeci">#define TPQCalc</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00025">DefCommon.h:25</a></div></div>
<div class="ttc" id="mltply_8h_html_a6d06655a28258eea84191579396219e1"><div class="ttname"><a href="mltply_8h.html#a6d06655a28258eea84191579396219e1">GC_child_CisAjtCkuAlv_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAlv_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int isite4, long unsigned int Asum, long unsigned int Adiff, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02703">mltply.c:2703</a></div></div>
<div class="ttc" id="mltply_8h_html_a7ef0ac15397782150359429b7456c5fa"><div class="ttname"><a href="mltply_8h.html#a7ef0ac15397782150359429b7456c5fa">M_CORR</a></div><div class="ttdeci">#define M_CORR</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8h_source.html#l00026">mltply.h:26</a></div></div>
<div class="ttc" id="bitcalc_8c_html_a78387adc1f4e171d3796235adfcbd87e"><div class="ttname"><a href="bitcalc_8c.html#a78387adc1f4e171d3796235adfcbd87e">GetSplitBitByModel</a></div><div class="ttdeci">int GetSplitBitByModel(const int Nsite, const int iCalcModel, long unsigned int *irght, long unsigned int *ilft, long unsigned int *ihfbit)</div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00061">bitcalc.c:61</a></div></div>
<div class="ttc" id="_def_common_8h_html_a5e2c64674c783f9e961ac5f05f653e2a"><div class="ttname"><a href="_def_common_8h.html#a5e2c64674c783f9e961ac5f05f653e2a">HubbardGC</a></div><div class="ttdeci">#define HubbardGC</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00033">DefCommon.h:33</a></div></div>
<div class="ttc" id="struct_large_list_html_a3e771c34c5f75982051fd99a4a577281"><div class="ttname"><a href="struct_large_list.html#a3e771c34c5f75982051fd99a4a577281">LargeList::i_max</a></div><div class="ttdeci">long int i_max</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00151">struct.h:151</a></div></div>
<div class="ttc" id="mltply_8h_html_a1b6c6239f632e04606cf340f024d2ed3"><div class="ttname"><a href="mltply_8h.html#a1b6c6239f632e04606cf340f024d2ed3">GC_child_CisAitCiuAiv_spin_element</a></div><div class="ttdeci">double complex GC_child_CisAitCiuAiv_spin_element(long unsigned int j, long unsigned int org_sigma2, long unsigned int org_sigma4, long unsigned int isA_up, long unsigned int isB_up, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off_2)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02500">mltply.c:2500</a></div></div>
<div class="ttc" id="mltply_8h_html_a5a389f0d9543e02b5d2e19df0198bafc"><div class="ttname"><a href="mltply_8h.html#a5a389f0d9543e02b5d2e19df0198bafc">GC_child_CisAisCjtAku_element</a></div><div class="ttdeci">double complex GC_child_CisAisCjtAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, long unsigned int isite4, long unsigned int Bsum, long unsigned int Bdiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02596">mltply.c:2596</a></div></div>
<div class="ttc" id="_def_common_8h_html_a7f6b1308cdb6cc196f106ff63c26849b"><div class="ttname"><a href="_def_common_8h.html#a7f6b1308cdb6cc196f106ff63c26849b">FullDiag</a></div><div class="ttdeci">#define FullDiag</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00026">DefCommon.h:26</a></div></div>
<div class="ttc" id="global_8c_html_a2a071aec3f989fa3b894107138199ddb"><div class="ttname"><a href="global_8c.html#a2a071aec3f989fa3b894107138199ddb">cFileName2BGreen_CG</a></div><div class="ttdeci">const char * cFileName2BGreen_CG</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00046">global.c:46</a></div></div>
<div class="ttc" id="_def_common_8h_html_a84a2a0896f6c0300a068925d7b299515"><div class="ttname"><a href="_def_common_8h.html#a84a2a0896f6c0300a068925d7b299515">KondoGC</a></div><div class="ttdeci">#define KondoGC</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00035">DefCommon.h:35</a></div></div>
<div class="ttc" id="struct_large_list_html_a39695415db0ac0ef9688a0ba0efdc440"><div class="ttname"><a href="struct_large_list.html#a39695415db0ac0ef9688a0ba0efdc440">LargeList::is2_spin</a></div><div class="ttdeci">long unsigned int is2_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00164">struct.h:164</a></div></div>
<div class="ttc" id="mltply_8h_html_ab7d585bf30bbcee8449b8c54d0bb128e"><div class="ttname"><a href="mltply_8h.html#ab7d585bf30bbcee8449b8c54d0bb128e">GC_child_CisAjtCkuAku_element</a></div><div class="ttdeci">double complex GC_child_CisAjtCkuAku_element(long unsigned int j, long unsigned int isite1, long unsigned int isite2, long unsigned int isite3, long unsigned int Asum, long unsigned int Adiff, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02648">mltply.c:2648</a></div></div>
<div class="ttc" id="_log_message_8h_html_a7519659e9f2c455440ff713b688cc682"><div class="ttname"><a href="_log_message_8h.html#a7519659e9f2c455440ff713b688cc682">cCGExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cCGExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8h_source.html#l00076">LogMessage.h:76</a></div></div>
<div class="ttc" id="global_8c_html_a30aa928612a1c54d049114f96c2d25e7"><div class="ttname"><a href="global_8c.html#a30aa928612a1c54d049114f96c2d25e7">cFileName2BGreen_Lanczos</a></div><div class="ttdeci">const char * cFileName2BGreen_Lanczos</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00045">global.c:45</a></div></div>
<div class="ttc" id="struct_define_list_html_abe80758171b3ffeca7b5fa790e5ede22"><div class="ttname"><a href="struct_define_list.html#abe80758171b3ffeca7b5fa790e5ede22">DefineList::istep</a></div><div class="ttdeci">int istep</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00046">struct.h:46</a></div></div>
<div class="ttc" id="log_8h_html_a5c659bb0ba9e5d8a508c6cb6b7431f23"><div class="ttname"><a href="log_8h.html#a5c659bb0ba9e5d8a508c6cb6b7431f23">TimeKeeper</a></div><div class="ttdeci">int TimeKeeper(struct BindStruct *X, const char *cFileName, const char *cTimeKeeper_Message, const char *cWriteType)</div><div class="ttdoc">Functions for writing a time log. </div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00032">log.c:32</a></div></div>
<div class="ttc" id="struct_define_list_html_a16f8adaa4fca771cb01a28b482224b70"><div class="ttname"><a href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">DefineList::Tpow</a></div><div class="ttdeci">long int * Tpow</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00054">struct.h:54</a></div></div>
<div class="ttc" id="global_8c_html_a4cc81b237528770cf1b012aee34ba424"><div class="ttname"><a href="global_8c.html#a4cc81b237528770cf1b012aee34ba424">cFileNameTimeKeep</a></div><div class="ttdeci">const char * cFileNameTimeKeep</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00023">global.c:23</a></div></div>
<div class="ttc" id="log_8h_html_a6e1528922a48320b30d56b93f1cc8370"><div class="ttname"><a href="log_8h.html#a6e1528922a48320b30d56b93f1cc8370">TimeKeeperWithRandAndStep</a></div><div class="ttdeci">int TimeKeeperWithRandAndStep(struct BindStruct *X, const char *cFileName, const char *cTimeKeeper_Message, const char *cWriteType, const int istep, const int irand)</div><div class="ttdoc">Functions for writing a time log. </div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00107">log.c:107</a></div></div>
<div class="ttc" id="mltply_8h_html_a6e5c6a3af522a385b4ee60f66efb2557"><div class="ttname"><a href="mltply_8h.html#a6e5c6a3af522a385b4ee60f66efb2557">GC_child_CisAisCisAis_element</a></div><div class="ttdeci">double complex GC_child_CisAisCisAis_element(long unsigned int j, long unsigned int isite1, long unsigned int isite3, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X, long unsigned int *tmp_off)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02550">mltply.c:2550</a></div></div>
<div class="ttc" id="struct_large_list_html_a8bd46afee09b313f7f938418c32a301f"><div class="ttname"><a href="struct_large_list.html#a8bd46afee09b313f7f938418c32a301f">LargeList::isA_spin</a></div><div class="ttdeci">long unsigned int isA_spin</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00177">struct.h:177</a></div></div>
<div class="ttc" id="mltply_8h_html_a9f7fc788e6ba0b42f84e2c5a4d187f4a"><div class="ttname"><a href="mltply_8h.html#a9f7fc788e6ba0b42f84e2c5a4d187f4a">child_CisAisCisAis_spin_element</a></div><div class="ttdeci">double complex child_CisAisCisAis_spin_element(long unsigned int j, long unsigned int isA_up, long unsigned int isB_up, long unsigned int org_sigma2, long unsigned int org_sigma4, double complex tmp_V, double complex *tmp_v0, double complex *tmp_v1, struct BindStruct *X)</div><div class="ttdef"><b>Definition:</b> <a href="mltply_8c_source.html#l02257">mltply.c:2257</a></div></div>
<div class="ttc" id="struct_define_list_html_acc55ef9e68605fbaba4697e0e4e90b95"><div class="ttname"><a href="struct_define_list.html#acc55ef9e68605fbaba4697e0e4e90b95">DefineList::iCalcModel</a></div><div class="ttdeci">int iCalcModel</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00136">struct.h:136</a></div></div>
<div class="ttc" id="global_8c_html_af97aa29cc5e6f180b89596e6c91a3ffc"><div class="ttname"><a href="global_8c.html#af97aa29cc5e6f180b89596e6c91a3ffc">cFileName2BGreen_FullDiag</a></div><div class="ttdeci">const char * cFileName2BGreen_FullDiag</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00062">global.c:62</a></div></div>
<div class="ttc" id="_log_message_8h_html_acf90179a5d51508dd9973c8389f4aed2"><div class="ttname"><a href="_log_message_8h.html#acf90179a5d51508dd9973c8389f4aed2">cTPQExpecTwoBodyGStart</a></div><div class="ttdeci">const char * cTPQExpecTwoBodyGStart</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8h_source.html#l00077">LogMessage.h:77</a></div></div>
<div class="ttc" id="_log_message_8h_html_af9e20cd063f9fc302818c9bd15eff059"><div class="ttname"><a href="_log_message_8h.html#af9e20cd063f9fc302818c9bd15eff059">cLogCGExpecTwoBodyGFinish</a></div><div class="ttdeci">const char * cLogCGExpecTwoBodyGFinish</div><div class="ttdef"><b>Definition:</b> <a href="_log_message_8h_source.html#l00074">LogMessage.h:74</a></div></div>
<div class="ttc" id="struct_phys_list_html_a5616dcf1777ecef24f4883835541a375"><div class="ttname"><a href="struct_phys_list.html#a5616dcf1777ecef24f4883835541a375">PhysList::eigen_num</a></div><div class="ttdeci">int eigen_num</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00192">struct.h:192</a></div></div>
<div class="ttc" id="_def_common_8h_html_aa7314d1157770374b63f2a07076e1cdb"><div class="ttname"><a href="_def_common_8h.html#aa7314d1157770374b63f2a07076e1cdb">SpinGC</a></div><div class="ttdeci">#define SpinGC</div><div class="ttdef"><b>Definition:</b> <a href="_def_common_8h_source.html#l00034">DefCommon.h:34</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a95fc4908040330c6556954b46972e35f"><div class="ttname"><a href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">BindStruct::Check</a></div><div class="ttdeci">struct CheckList Check</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00211">struct.h:211</a></div></div>
<div class="ttc" id="struct_define_list_html_aa769a551105160efd6f8dc36040c1289"><div class="ttname"><a href="struct_define_list.html#aa769a551105160efd6f8dc36040c1289">DefineList::CDataFileHead</a></div><div class="ttdeci">char * CDataFileHead</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00028">struct.h:28</a></div></div>
<div class="ttc" id="struct_define_list_html_a910451f7ffb4effad9386378ffd175d0"><div class="ttname"><a href="struct_define_list.html#a910451f7ffb4effad9386378ffd175d0">DefineList::NCisAjtCkuAlvDC</a></div><div class="ttdeci">int NCisAjtCkuAlvDC</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00131">struct.h:131</a></div></div>
<div class="ttc" id="wrapper_m_p_i_8h_html_abacbc82cf67663cd6f3708f1274ac207"><div class="ttname"><a href="wrapper_m_p_i_8h.html#abacbc82cf67663cd6f3708f1274ac207">stdoutMPI</a></div><div class="ttdeci">FILE * stdoutMPI</div><div class="ttdef"><b>Definition:</b> <a href="wrapper_m_p_i_8h_source.html#l00022">wrapperMPI.h:22</a></div></div>
<div class="ttc" id="struct_define_list_html_a2cdda57afe9e27418aab516c9c00526c"><div class="ttname"><a href="struct_define_list.html#a2cdda57afe9e27418aab516c9c00526c">DefineList::iCalcType</a></div><div class="ttdeci">int iCalcType</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00133">struct.h:133</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_cgraph.png" border="0" usemap="#expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_cgraph" alt=""/></div>
<map name="expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_cgraph" id="expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_cgraph">
</map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_icgraph.png" border="0" usemap="#expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_icgraph" alt=""/></div>
<map name="expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_icgraph" id="expec__cisajscktaltdc_8h_ab1e0307962ebf631818025cd262c4bd9_icgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="add5844529f50e34cd7a8642cfb700f8b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void expec_cisajscktaltdc_alldiag </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td></td></tr>
    <tr><td class="paramname">vec</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Takahiro Misawa (The University of Tokyo) </dd>
<dd>
Kazuyoshi Yoshimi (The University of Tokyo) </dd></dl>

<p>Definition at line <a class="el" href="expec__cisajscktaltdc_8c_source.html#l00451">451</a> of file <a class="el" href="expec__cisajscktaltdc_8c_source.html">expec_cisajscktaltdc.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                                           { <span class="comment">// only for Spin and Hubbard</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irght,ilft,ihfbit;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isite1,isite2;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is1_up,is2_up,is1_down,is2_down;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iexchg, off;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordtype">int</span> num1_up,num2_up;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordtype">int</span> num1_down,num2_down; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ibit1_up,ibit2_up,ibit1_down,ibit2_down; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">double</span> complex spn_z,chrg_z;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">double</span> complex spn,chrg;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">double</span> complex t_spn_z;  </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">int</span> N2,i_max;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  N2=2*X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">Nsite</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  i_max=X-&gt;<a class="code" href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">Check</a>.<a class="code" href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">idim_max</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  irght=pow(2,((N2+1)/2))-1;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  ilft=pow(2,N2)-1;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  ilft=ilft ^ irght; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  ihfbit=pow(2,((N2+1)/2));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  chrg=0.0;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  spn=0.0;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  t_spn_z=0.0;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">for</span>(isite1=1;isite1&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">Nsite</a>;isite1++){</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">for</span>(isite2=1;isite2&lt;=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">Nsite</a>;isite2++){</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      is1_up=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[2*isite1-2];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      is1_down=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[2*isite1-1];</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      is2_up=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[2*isite2-2];</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      is2_down=X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">Tpow</a>[2*isite2-1];</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#pragma omp parallel for reduction(+: t_spn_z,spn, chrg) firstprivate(i_max, is1_up, is2_up, is1_down, is2_down, irght, ilft, ihfbit) private(ibit1_up, num1_up, ibit2_up, num2_up, ibit1_down, num1_down, ibit2_down, num2_down, spn_z, chrg_z, iexchg, off)</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">for</span>(j=1;j&lt;=i_max;j++){                    </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    ibit1_up= <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j]&amp;is1_up;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    num1_up=ibit1_up/is1_up;            </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    ibit2_up= <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j]&amp;is2_up;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    num2_up=ibit2_up/is2_up;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    ibit1_down= <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j]&amp;is1_down;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    num1_down=ibit1_down/is1_down;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    ibit2_down= <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j]&amp;is2_down;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    num2_down=ibit2_down/is2_down;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    spn_z=(num1_up-num1_down)*(num2_up-num2_down);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    chrg_z=(num1_up+num1_down)*(num2_up+num2_down);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    t_spn_z+= conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])* <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*(num1_up-num1_down);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    spn+= conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])* <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*spn_z;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    chrg+= conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])* <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*chrg_z;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span>(isite1==isite2){</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      spn+=2* conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])* <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j]*(num1_up+num1_down-2*num1_up*num1_down);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">if</span>(ibit1_up!=0 &amp;&amp; ibit1_down==0 &amp;&amp; ibit2_up==0 &amp;&amp;ibit2_down!=0 ){</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        iexchg= <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j]-(is1_up+is2_down);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        iexchg+=(is2_up+is1_down);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="bitcalc_8c.html#ad51df85af8483eabad4118703003fc46">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg,  irght, ilft, ihfbit, &amp;off);                    </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        spn+=2* conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])* <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[off];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(ibit1_up==0 &amp;&amp; ibit1_down!=0 &amp;&amp; ibit2_up!=0 &amp;&amp; ibit2_down==0){</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        iexchg= <a class="code" href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a>[j]-(is1_down+is2_up);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        iexchg+=(is2_down+is1_up);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="bitcalc_8c.html#ad51df85af8483eabad4118703003fc46">GetOffComp</a>(<a class="code" href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a>, <a class="code" href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a>, iexchg,  irght, ilft, ihfbit, &amp;off);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        spn+=2* conj(<a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[j])* <a class="code" href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a>[off];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  spn = spn/X-&gt;<a class="code" href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">Def</a>.<a class="code" href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">Nsite</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  X-&gt;<a class="code" href="struct_bind_struct.html#a4779085fc0aeb372e1b3f3b0a20dee5d">Phys</a>.<a class="code" href="struct_phys_list.html#a42edbfd81a3b895ebdd81e70757a0a7d">s2</a>=spn;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="ttc" id="struct_bind_struct_html_a365c4c2952a7e0157c4902449c116b24"><div class="ttname"><a href="struct_bind_struct.html#a365c4c2952a7e0157c4902449c116b24">BindStruct::Def</a></div><div class="ttdeci">struct DefineList Def</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00210">struct.h:210</a></div></div>
<div class="ttc" id="struct_check_list_html_a5d8a1e6a9e9064ae7dab52310d2cce11"><div class="ttname"><a href="struct_check_list.html#a5d8a1e6a9e9064ae7dab52310d2cce11">CheckList::idim_max</a></div><div class="ttdeci">unsigned long int idim_max</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00141">struct.h:141</a></div></div>
<div class="ttc" id="struct_define_list_html_a8a54486217df163bb7d30f0134ef0474"><div class="ttname"><a href="struct_define_list.html#a8a54486217df163bb7d30f0134ef0474">DefineList::Nsite</a></div><div class="ttdeci">int Nsite</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00038">struct.h:38</a></div></div>
<div class="ttc" id="global_8h_html_ad7960e15bbb3ec77e0480d11807de888"><div class="ttname"><a href="global_8h.html#ad7960e15bbb3ec77e0480d11807de888">vec</a></div><div class="ttdeci">double complex ** vec</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00030">global.h:30</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a4779085fc0aeb372e1b3f3b0a20dee5d"><div class="ttname"><a href="struct_bind_struct.html#a4779085fc0aeb372e1b3f3b0a20dee5d">BindStruct::Phys</a></div><div class="ttdeci">struct PhysList Phys</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00213">struct.h:213</a></div></div>
<div class="ttc" id="bitcalc_8c_html_ad51df85af8483eabad4118703003fc46"><div class="ttname"><a href="bitcalc_8c.html#ad51df85af8483eabad4118703003fc46">GetOffComp</a></div><div class="ttdeci">void GetOffComp(long unsigned int *_list_2_1, long unsigned int *_list_2_2, const long unsigned int _ibit, const long unsigned int _irght, const long unsigned int _ilft, const long unsigned int _ihfbit, long unsigned int *_ioffComp)</div><div class="ttdef"><b>Definition:</b> <a href="bitcalc_8c_source.html#l00131">bitcalc.c:131</a></div></div>
<div class="ttc" id="global_8h_html_a59e163bd798ad16a8c9d47e545e2e42f"><div class="ttname"><a href="global_8h.html#a59e163bd798ad16a8c9d47e545e2e42f">list_2_1</a></div><div class="ttdeci">long unsigned int * list_2_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00034">global.h:34</a></div></div>
<div class="ttc" id="struct_phys_list_html_a42edbfd81a3b895ebdd81e70757a0a7d"><div class="ttname"><a href="struct_phys_list.html#a42edbfd81a3b895ebdd81e70757a0a7d">PhysList::s2</a></div><div class="ttdeci">double s2</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00195">struct.h:195</a></div></div>
<div class="ttc" id="global_8h_html_ac189678ecde40ac11f263e1b98ac5969"><div class="ttname"><a href="global_8h.html#ac189678ecde40ac11f263e1b98ac5969">list_1</a></div><div class="ttdeci">long unsigned int * list_1</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00033">global.h:33</a></div></div>
<div class="ttc" id="struct_define_list_html_a16f8adaa4fca771cb01a28b482224b70"><div class="ttname"><a href="struct_define_list.html#a16f8adaa4fca771cb01a28b482224b70">DefineList::Tpow</a></div><div class="ttdeci">long int * Tpow</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00054">struct.h:54</a></div></div>
<div class="ttc" id="global_8h_html_aac1d1cc6d1099e228cb1f505ef0c86c6"><div class="ttname"><a href="global_8h.html#aac1d1cc6d1099e228cb1f505ef0c86c6">list_2_2</a></div><div class="ttdeci">long unsigned int * list_2_2</div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00035">global.h:35</a></div></div>
<div class="ttc" id="struct_bind_struct_html_a95fc4908040330c6556954b46972e35f"><div class="ttname"><a href="struct_bind_struct.html#a95fc4908040330c6556954b46972e35f">BindStruct::Check</a></div><div class="ttdeci">struct CheckList Check</div><div class="ttdef"><b>Definition:</b> <a href="struct_8h_source.html#l00211">struct.h:211</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="expec__cisajscktaltdc_8h_add5844529f50e34cd7a8642cfb700f8b_cgraph.png" border="0" usemap="#expec__cisajscktaltdc_8h_add5844529f50e34cd7a8642cfb700f8b_cgraph" alt=""/></div>
<map name="expec__cisajscktaltdc_8h_add5844529f50e34cd7a8642cfb700f8b_cgraph" id="expec__cisajscktaltdc_8h_add5844529f50e34cd7a8642cfb700f8b_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e224de99736e8ca65d163cf8fda3605"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void expec_cisajscktaltdc_alldiag_spin </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_bind_struct.html">BindStruct</a> *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double complex *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="expec__cisajscktaltdc_8h.html">expec_cisajscktaltdc.h</a></li>
    <li class="footer">Generated on Fri Oct 30 2015 15:02:44 for HΦ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
